#!/usr/bin/env python
"""
Ø§Ø³Ú©Ø±ÛŒÙ¾Øª Ú©Ø§Ù…Ù„ Ø¨Ø±Ø§ÛŒ import Ú©Ø±Ø¯Ù† Ø´Ù‡Ø±Ù‡Ø§ Ùˆ Ø§Ø³ØªØ§Ù†â€ŒÙ‡Ø§ÛŒ Ø§ÛŒØ±Ø§Ù†
Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ø§Ø² Ù‡Ø± Ø¯Ùˆ app: user Ùˆ real_estate

ğŸ”„ Ù…Ù†Ø·Ù‚ Ú©Ø§Ø±:
  - Ø§Ø² get_or_create Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒÚ©Ù†Ø¯ ØªØ§ duplicate Ø§ÛŒØ¬Ø§Ø¯ Ù†Ø´ÙˆØ¯
  - Ø§Ú¯Ø± Ù…ÙˆØ¬ÙˆØ¯ Ø¨ÙˆØ¯ØŒ update Ù…ÛŒâ€ŒÚ©Ù†Ø¯ (Ù†Ø§Ù…ØŒ ÙˆØ¶Ø¹ÛŒØª)
  - Ø§Ú¯Ø± Ù…ÙˆØ¬ÙˆØ¯ Ù†Ø¨ÙˆØ¯ØŒ create Ù…ÛŒâ€ŒÚ©Ù†Ø¯
  - Ù‡ÛŒÚ† Ø¯Ø§Ø¯Ù‡â€ŒØ§ÛŒ Ù¾Ø§Ú© Ù†Ù…ÛŒâ€ŒØ´ÙˆØ¯ - ÙÙ‚Ø· Ø§Ø¶Ø§ÙÙ‡ Ùˆ Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù…ÛŒâ€ŒØ´ÙˆØ¯

âš ï¸  Ù…Ù‡Ù…: Ø¨Ù‡ ØµÙˆØ±Øª Ù¾ÛŒØ´â€ŒÙØ±Ø¶ ÙÙ‚Ø· real_estate import Ù…ÛŒâ€ŒØ´ÙˆØ¯ ØªØ§ Ø§Ø² duplicate Ø¯Ø± User Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø´ÙˆØ¯

Ø§Ø¬Ø±Ø§: 
  - ÙÙ‚Ø· Real Estate (Ù¾ÛŒØ´â€ŒÙØ±Ø¶): python scripts/import_iranian_locations.py
  - ÙÙ‚Ø· User: python scripts/import_iranian_locations.py --app user
  - Ù‡Ø± Ø¯Ùˆ: python scripts/import_iranian_locations.py --app both
"""

import os
import sys
import argparse
import re

# ØªÙ†Ø¸ÛŒÙ… encoding Ø¨Ø±Ø§ÛŒ Windows
if sys.platform == 'win32':
    import io
    sys.stdout = io.TextIOWrapper(sys.stdout.buffer, encoding='utf-8')
    sys.stderr = io.TextIOWrapper(sys.stderr.buffer, encoding='utf-8')

# Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ù…Ø³ÛŒØ± Ù¾Ø±ÙˆÚ˜Ù‡ Ø¨Ù‡ sys.path
sys.path.append(os.path.dirname(os.path.dirname(os.path.abspath(__file__))))

# ØªÙ†Ø¸ÛŒÙ… Django settings
os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'config.django.base')

try:
    import django
    from django.db import transaction
    django.setup()
    from src.core.models import Province as UserProvince, City as UserCity
    from src.real_estate.models.location import CityRegion
    from scripts.location_slug_shared import canonical_location_slug, ensure_unique_slug
except ImportError as e:
    print(f"âŒ Ø®Ø·Ø§ Ø¯Ø± import Django: {e}")
    print("Ù…Ø·Ù…Ø¦Ù† Ø´ÙˆÛŒØ¯ Ú©Ù‡ Django Ù†ØµØ¨ Ø´Ø¯Ù‡ Ùˆ Ù…Ø³ÛŒØ± Ø¯Ø±Ø³Øª Ø§Ø³Øª")
    sys.exit(1)

# Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ú©Ø§Ù…Ù„ Ø§Ø³ØªØ§Ù†â€ŒÙ‡Ø§ Ùˆ Ø´Ù‡Ø±Ù‡Ø§ÛŒ Ø§ÛŒØ±Ø§Ù† (31 Ø§Ø³ØªØ§Ù†)
# Ù…Ù†Ø·Ù‚Ù‡ Ùˆ Ù…Ø­Ù„Ù‡ Ø¨Ù‡ ØµÙˆØ±Øª Ø¯Ø§ÛŒÙ†Ø§Ù…ÛŒÚ© Ø§Ø² Ø·Ø±ÛŒÙ‚ Ù†Ù‚Ø´Ù‡ Ø¯Ø± Ù¾Ù†Ù„ Ø§Ø¯Ù…ÛŒÙ† Ø§ÛŒØ¬Ø§Ø¯ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯
PROVINCES_DATA = [
    {"name": "Ø¢Ø°Ø±Ø¨Ø§ÛŒØ¬Ø§Ù† Ø´Ø±Ù‚ÛŒ", "code": "01", "cities": [
        "ØªØ¨Ø±ÛŒØ²", "Ù…Ø±Ø§ØºÙ‡", "Ù…ÛŒØ§Ù†Ù‡", "Ø´Ø¨Ø³ØªØ±", "Ù…Ø±Ù†Ø¯", "Ø¨Ù†Ø§Ø¨", "Ø§Ø³Ú©Ùˆ", "Ø´Ø§Ù‡ÛŒÙ†â€ŒØ¯Ú˜", 
        "Ù‡Ø´ØªØ±ÙˆØ¯", "Ø¨Ø³ØªØ§Ù†â€ŒØ¢Ø¨Ø§Ø¯", "Ø³Ø±Ø§Ø¨", "Ù‡Ø±ÛŒØ³", "Ø¹Ø¬Ø¨â€ŒØ´ÛŒØ±", "Ú©Ù„ÛŒØ¨Ø±", "Ø¬Ù„ÙØ§", "Ø§Ù‡Ø±"
    ]},
    {"name": "Ø¢Ø°Ø±Ø¨Ø§ÛŒØ¬Ø§Ù† ØºØ±Ø¨ÛŒ", "code": "02", "cities": [
        "Ø§Ø±ÙˆÙ…ÛŒÙ‡", "Ø®ÙˆÛŒ", "Ù…Ù‡Ø§Ø¨Ø§Ø¯", "Ø¨ÙˆÚ©Ø§Ù†", "Ù…ÛŒØ§Ù†Ø¯ÙˆØ¢Ø¨", "Ø³Ù„Ù…Ø§Ø³", "Ù¾ÛŒØ±Ø§Ù†Ø´Ù‡Ø±", 
        "Ù†Ù‚Ø¯Ù‡", "Ø´Ø§Ù‡ÛŒÙ†â€ŒØ¯Ú˜", "ØªÚ©Ø§Ø¨", "Ù…Ø§Ú©Ùˆ", "Ø³Ø±Ø¯Ø´Øª", "Ø§Ø´Ù†ÙˆÛŒÙ‡", "Ú†Ø§Ù„Ø¯Ø±Ø§Ù†", "Ø¨Ø§Ù†Ù‡"
    ]},
    {"name": "Ø§Ø±Ø¯Ø¨ÛŒÙ„", "code": "03", "cities": [
        "Ø§Ø±Ø¯Ø¨ÛŒÙ„", "Ù¾Ø§Ø±Ø³â€ŒØ¢Ø¨Ø§Ø¯", "Ø®Ù„Ø®Ø§Ù„", "Ù…Ø´Ú¯ÛŒÙ†â€ŒØ´Ù‡Ø±", "Ú©ÙˆØ«Ø±", "Ú¯Ø±Ù…ÛŒ", "Ù†Ù…ÛŒÙ†", 
        "Ù†ÛŒØ±", "Ø³Ø±Ø¹ÛŒÙ†", "Ø§ØµÙ„Ø§Ù†Ø¯ÙˆØ²", "Ù‡ÛŒØ±", "ÙØ®Ø±Ø¢Ø¨Ø§Ø¯"
    ]},
    {"name": "Ø§ØµÙÙ‡Ø§Ù†", "code": "04", "cities": [
        "Ø§ØµÙÙ‡Ø§Ù†", "Ú©Ø§Ø´Ø§Ù†", "Ø®Ù…ÛŒÙ†ÛŒâ€ŒØ´Ù‡Ø±", "Ù†Ø¬Ùâ€ŒØ¢Ø¨Ø§Ø¯", "Ø´Ø§Ù‡ÛŒÙ†â€ŒØ´Ù‡Ø±", "ÙÙˆÙ„Ø§Ø¯Ø´Ù‡Ø±", 
        "Ù…Ø¨Ø§Ø±Ú©Ù‡", "ÙÙ„Ø§ÙˆØ±Ø¬Ø§Ù†", "Ù†Ø·Ù†Ø²", "Ø§Ø±Ø¯Ø³ØªØ§Ù†", "Ù†Ø§ÛŒÛŒÙ†", "Ú¯Ù„Ù¾Ø§ÛŒÚ¯Ø§Ù†", "Ø®ÙˆØ§Ù†Ø³Ø§Ø±", 
        "Ø³Ù…ÛŒØ±Ù…", "Ø¯Ù‡Ø§Ù‚Ø§Ù†", "Ø´Ø§Ù‡ÛŒÙ†â€ŒØ´Ù‡Ø± Ùˆ Ù…ÛŒÙ…Ù‡", "ØªÛŒØ±Ø§Ù† Ùˆ Ú©Ø±ÙˆÙ†", "Ø¨Ø±Ø®ÙˆØ§Ø± Ùˆ Ù…ÛŒÙ…Ù‡"
    ]},
    {"name": "Ø§Ù„Ø¨Ø±Ø²", "code": "05", "cities": [
        "Ú©Ø±Ø¬", "ÙØ±Ø¯ÛŒØ³", "Ù†Ø¸Ø±Ø¢Ø¨Ø§Ø¯", "Ù‡Ø´ØªÚ¯Ø±Ø¯", "Ø³Ø§ÙˆØ¬Ø¨Ù„Ø§Øº", "Ø·Ø§Ù„Ù‚Ø§Ù†", "Ø§Ø´ØªÙ‡Ø§Ø±Ø¯", 
        "Ù…Ø§Ù‡Ø¯Ø´Øª", "Ú¯Ù„Ø³ØªØ§Ù†", "Ù…Ø­Ù…Ø¯Ø´Ù‡Ø±", "Ù…Ø´Ú©ÛŒÙ†â€ŒØ¯Ø´Øª", "ÙØ±Ø¯ÛŒØ³", "Ù…Ø§Ù‡Ø¯Ø´Øª"
    ]},
    {"name": "Ø§ÛŒÙ„Ø§Ù…", "code": "06", "cities": [
        "Ø§ÛŒÙ„Ø§Ù…", "Ø¯Ù‡Ù„Ø±Ø§Ù†", "Ø¢Ø¨Ø¯Ø§Ù†Ø§Ù†", "Ø¯Ø±Ù‡â€ŒØ´Ù‡Ø±", "Ø§ÛŒÙˆØ§Ù†", "Ù…Ù‡Ø±Ø§Ù†", "Ø´ÛŒØ±ÙˆØ§Ù† Ú†Ø±Ø¯Ø§ÙˆÙ„", 
        "Ù…Ù„Ú©Ø´Ø§Ù‡ÛŒ", "Ø¨Ø¯Ø±Ù‡", "Ø¢Ø³Ù…Ø§Ù†â€ŒØ¢Ø¨Ø§Ø¯", "Ø¯Ù‡Ù„Ø±Ø§Ù†"
    ]},
    {"name": "Ø¨ÙˆØ´Ù‡Ø±", "code": "07", "cities": [
        "Ø¨ÙˆØ´Ù‡Ø±", "Ø¨Ø±Ø§Ø²Ø¬Ø§Ù†", "Ú¯Ù†Ø§ÙˆÙ‡", "Ø®ÙˆØ±Ù…ÙˆØ¬", "Ø¬Ù…", "Ø¯ÛŒØ±", "Ú©Ù†Ú¯Ø§Ù†", "Ø¹Ø³Ù„ÙˆÛŒÙ‡", 
        "Ø¯Ø´ØªÛŒ", "ØªÙ†Ú¯Ø³ØªØ§Ù†", "Ø¬Ù…", "Ø¯ÛŒØ±", "Ú©Ù†Ú¯Ø§Ù†"
    ]},
    {"name": "ØªÙ‡Ø±Ø§Ù†", "code": "08", "cities": [
        "ØªÙ‡Ø±Ø§Ù†", "ÙˆØ±Ø§Ù…ÛŒÙ†", "Ø±Ø¨Ø§Ø·â€ŒÚ©Ø±ÛŒÙ…", "Ø´Ù‡Ø±ÛŒØ§Ø±", "Ø§Ø³Ù„Ø§Ù…â€ŒØ´Ù‡Ø±", "Ù¾Ø§Ú©Ø¯Ø´Øª", "Ù‚Ø¯Ø³", 
        "Ù…Ù„Ø§Ø±Ø¯", "Ø¨Ù‡Ø§Ø±Ø³ØªØ§Ù†", "Ù¾ÛŒØ´ÙˆØ§", "Ù‚Ø±Ú†Ú©", "Ø±ÛŒ", "Ø´Ù…ÛŒØ±Ø§Ù†Ø§Øª", "Ø¯Ù…Ø§ÙˆÙ†Ø¯", 
        "ÙÛŒØ±ÙˆØ²Ú©ÙˆÙ‡", "ÙˆØ±Ø§Ù…ÛŒÙ†", "Ù¾Ø§Ú©Ø¯Ø´Øª", "Ù‚Ø±Ú†Ú©", "Ø¨Ù‡Ø§Ø±Ø³ØªØ§Ù†", "Ù…Ù„Ø§Ø±Ø¯", "Ù‚Ø¯Ø³"
    ]},
    {"name": "Ú†Ù‡Ø§Ø±Ù…Ø­Ø§Ù„ Ùˆ Ø¨Ø®ØªÛŒØ§Ø±ÛŒ", "code": "09", "cities": [
        "Ø´Ù‡Ø±Ú©Ø±Ø¯", "Ø¨Ø±ÙˆØ¬Ù†", "ÙØ§Ø±Ø³Ø§Ù†", "Ù„Ø±Ø¯Ú¯Ø§Ù†", "Ø§Ø±Ø¯Ù„", "Ø³Ø§Ù…Ø§Ù†", "Ú¯Ù†Ø¯Ù…Ø§Ù†", "ÙØ§Ø±Ø³Ø§Ù†", 
        "Ù„Ø±Ø¯Ú¯Ø§Ù†", "Ø§Ø±Ø¯Ù„", "Ø³Ø§Ù…Ø§Ù†", "Ú¯Ù†Ø¯Ù…Ø§Ù†", "ÙØ§Ø±Ø³Ø§Ù†"
    ]},
    {"name": "Ø®Ø±Ø§Ø³Ø§Ù† Ø¬Ù†ÙˆØ¨ÛŒ", "code": "10", "cities": [
        "Ø¨ÛŒØ±Ø¬Ù†Ø¯", "Ù‚Ø§Ø¦Ù†", "ÙØ±Ø¯ÙˆØ³", "Ø·Ø¨Ø³", "Ù†Ù‡Ø¨Ù†Ø¯Ø§Ù†", "Ø¯Ø±Ù…ÛŒØ§Ù†", "Ø³Ø±Ø§ÛŒØ§Ù†", "Ø³Ø±Ø¨ÛŒØ´Ù‡", 
        "Ø®ÙˆØ³Ù", "Ø²ÛŒØ±Ú©ÙˆÙ‡", "Ø·Ø¨Ø³", "ÙØ±Ø¯ÙˆØ³", "Ù‚Ø§Ø¦Ù†"
    ]},
    {"name": "Ø®Ø±Ø§Ø³Ø§Ù† Ø±Ø¶ÙˆÛŒ", "code": "11", "cities": [
        "Ù…Ø´Ù‡Ø¯", "Ù†ÛŒØ´Ø§Ø¨ÙˆØ±", "Ø³Ø¨Ø²ÙˆØ§Ø±", "Ú©Ø§Ø´Ù…Ø±", "ØªØ±Ø¨Øª Ø­ÛŒØ¯Ø±ÛŒÙ‡", "Ù‚ÙˆÚ†Ø§Ù†", "ØªØ§ÛŒØ¨Ø§Ø¯", 
        "Ø®ÙˆØ§Ù", "ØªØ±Ø¨Øª Ø¬Ø§Ù…", "Ú†Ù†Ø§Ø±Ø§Ù†", "Ø¯Ø±Ú¯Ø²", "ÙØ±ÛŒÙ…Ø§Ù†", "Ú¯Ù†Ø§Ø¨Ø§Ø¯", "Ø®Ù„ÛŒÙ„â€ŒØ¢Ø¨Ø§Ø¯", 
        "Ø¨Ø±Ø¯Ø³Ú©Ù†", "Ø¬ØºØªØ§ÛŒ", "Ø¯Ø§ÙˆØ±Ø²Ù†", "ÙÛŒØ±ÙˆØ²Ù‡", "Ú©Ù„Ø§Øª", "Ù…Ø´Ù‡Ø¯", "Ù†ÛŒØ´Ø§Ø¨ÙˆØ±", "Ø³Ø¨Ø²ÙˆØ§Ø±"
    ]},
    {"name": "Ø®Ø±Ø§Ø³Ø§Ù† Ø´Ù…Ø§Ù„ÛŒ", "code": "12", "cities": [
        "Ø¨Ø¬Ù†ÙˆØ±Ø¯", "Ø¢Ø´Ø®Ø§Ù†Ù‡", "Ø§Ø³ÙØ±Ø§ÛŒÙ†", "Ø´ÛŒØ±ÙˆØ§Ù†", "ÙØ§Ø±ÙˆØ¬", "Ú¯Ø±Ù…Ù‡", "Ø¬Ø§Ø¬Ø±Ù…", "Ø±Ø§Ø²", 
        "Ø´ÛŒØ±ÙˆØ§Ù†", "ÙØ§Ø±ÙˆØ¬", "Ú¯Ø±Ù…Ù‡", "Ø¬Ø§Ø¬Ø±Ù…", "Ø±Ø§Ø²", "Ø¨Ø¬Ù†ÙˆØ±Ø¯", "Ø¢Ø´Ø®Ø§Ù†Ù‡", "Ø§Ø³ÙØ±Ø§ÛŒÙ†"
    ]},
    {"name": "Ø®ÙˆØ²Ø³ØªØ§Ù†", "code": "13", "cities": [
        "Ø§Ù‡ÙˆØ§Ø²", "Ø¢Ø¨Ø§Ø¯Ø§Ù†", "Ø®Ø±Ù…Ø´Ù‡Ø±", "Ø¯Ø²ÙÙˆÙ„", "Ø¨Ù‡Ø¨Ù‡Ø§Ù†", "Ø§Ù†Ø¯ÛŒÙ…Ø´Ú©", "Ù…Ø§Ù‡Ø´Ù‡Ø±", 
        "Ø´Ø§Ø¯Ú¯Ø§Ù†", "Ø±Ø§Ù…Ù‡Ø±Ù…Ø²", "Ø´ÙˆØ´", "Ø´ÙˆØ´ØªØ±", "Ú¯ØªÙˆÙ†Ø¯", "Ù„Ø§Ù„ÛŒ", "Ù‡Ù†Ø¯ÛŒØ¬Ø§Ù†", "Ø¨Ù†Ø¯Ø± Ù…Ø§Ù‡Ø´Ù‡Ø±", 
        "Ø¢Ø¨Ø§Ø¯Ø§Ù†", "Ø®Ø±Ù…Ø´Ù‡Ø±", "Ø¯Ø²ÙÙˆÙ„", "Ø¨Ù‡Ø¨Ù‡Ø§Ù†", "Ø§Ù†Ø¯ÛŒÙ…Ø´Ú©"
    ]},
    {"name": "Ø²Ù†Ø¬Ø§Ù†", "code": "14", "cities": [
        "Ø²Ù†Ø¬Ø§Ù†", "Ø§Ø¨Ù‡Ø±", "Ø®Ø±Ù…Ø¯Ø±Ù‡", "Ø·Ø§Ø±Ù…", "Ù…Ø§Ù‡Ù†Ø´Ø§Ù†", "Ù‚ÛŒØ¯Ø§Ø±", "Ø®Ø¯Ø§Ø¨Ù†Ø¯Ù‡", "Ø§ÛŒØ¬Ø±ÙˆØ¯", 
        "Ù…Ø§Ù‡Ù†Ø´Ø§Ù†", "Ø·Ø§Ø±Ù…", "Ø®Ø±Ù…Ø¯Ø±Ù‡", "Ø§Ø¨Ù‡Ø±", "Ø²Ù†Ø¬Ø§Ù†"
    ]},
    {"name": "Ø³Ù…Ù†Ø§Ù†", "code": "15", "cities": [
        "Ø³Ù…Ù†Ø§Ù†", "Ø´Ø§Ù‡Ø±ÙˆØ¯", "Ø¯Ø§Ù…ØºØ§Ù†", "Ú¯Ø±Ù…Ø³Ø§Ø±", "Ø¢Ø±Ø§Ø¯Ø§Ù†", "Ø¨Ø³Ø·Ø§Ù…", "Ø´Ø§Ù‡Ø±ÙˆØ¯", "Ø¯Ø§Ù…ØºØ§Ù†", 
        "Ú¯Ø±Ù…Ø³Ø§Ø±", "Ø¢Ø±Ø§Ø¯Ø§Ù†", "Ø¨Ø³Ø·Ø§Ù…", "Ø³Ù…Ù†Ø§Ù†"
    ]},
    {"name": "Ø³ÛŒØ³ØªØ§Ù† Ùˆ Ø¨Ù„ÙˆÚ†Ø³ØªØ§Ù†", "code": "16", "cities": [
        "Ø²Ø§Ù‡Ø¯Ø§Ù†", "Ú†Ø§Ø¨Ù‡Ø§Ø±", "Ø²Ø§Ø¨Ù„", "Ø§ÛŒØ±Ø§Ù†Ø´Ù‡Ø±", "Ø³Ø±Ø§ÙˆØ§Ù†", "Ø®Ø§Ø´", "Ø±Ø§Ø³Ú©", "Ø³Ø±Ø¨Ø§Ø²", 
        "Ú©Ù†Ø§Ø±Ú©", "Ù†ÛŒÚ©â€ŒØ´Ù‡Ø±", "Ù‚ØµØ±Ù‚Ù†Ø¯", "Ø²Ø§Ù‡Ø¯Ø§Ù†", "Ú†Ø§Ø¨Ù‡Ø§Ø±", "Ø²Ø§Ø¨Ù„", "Ø§ÛŒØ±Ø§Ù†Ø´Ù‡Ø±", "Ø³Ø±Ø§ÙˆØ§Ù†"
    ]},
    {"name": "ÙØ§Ø±Ø³", "code": "17", "cities": [
        "Ø´ÛŒØ±Ø§Ø²", "Ú©Ø§Ø²Ø±ÙˆÙ†", "Ù…Ø±ÙˆØ¯Ø´Øª", "Ø¬Ù‡Ø±Ù…", "Ù„Ø§Ø±Ø³ØªØ§Ù†", "ÙØ³Ø§", "Ø¯Ø§Ø±Ø§Ø¨", "Ø§Ø³ØªÙ‡Ø¨Ø§Ù†", 
        "Ù†ÛŒâ€ŒØ±ÛŒØ²", "Ø§Ù‚Ù„ÛŒØ¯", "Ø¢Ø¨Ø§Ø¯Ù‡", "Ø³Ù¾ÛŒØ¯Ø§Ù†", "Ù…Ù…Ø³Ù†ÛŒ", "Ú¯Ø±Ø§Ø´", "Ù„Ø§Ù…Ø±Ø¯", "ÙØ±Ø§Ø´Ø¨Ù†Ø¯", 
        "Ú©ÙˆØ§Ø±", "Ø®Ø±Ø§Ù…Ù‡", "Ø²Ø±Ù‚Ø§Ù†", "Ú©Ø§Ø²Ø±ÙˆÙ†", "Ù…Ø±ÙˆØ¯Ø´Øª", "Ø¬Ù‡Ø±Ù…", "Ù„Ø§Ø±Ø³ØªØ§Ù†", "ÙØ³Ø§"
    ]},
    {"name": "Ù‚Ø²ÙˆÛŒÙ†", "code": "18", "cities": [
        "Ù‚Ø²ÙˆÛŒÙ†", "ØªØ§Ú©Ø³ØªØ§Ù†", "Ø¢Ø¨ÛŒÚ©", "Ø§Ù„ÙˆÙ†Ø¯", "Ø¨ÙˆÛŒÛŒÙ†â€ŒØ²Ù‡Ø±Ø§", "Ù…Ø­Ù…ÙˆØ¯Ø¢Ø¨Ø§Ø¯", "Ø¢Ø¨ÛŒÚ©", 
        "Ø§Ù„ÙˆÙ†Ø¯", "Ø¨ÙˆÛŒÛŒÙ†â€ŒØ²Ù‡Ø±Ø§", "Ù…Ø­Ù…ÙˆØ¯Ø¢Ø¨Ø§Ø¯", "ØªØ§Ú©Ø³ØªØ§Ù†", "Ù‚Ø²ÙˆÛŒÙ†"
    ]},
    {"name": "Ù‚Ù…", "code": "19", "cities": [
        "Ù‚Ù…", "Ø¬Ø¹ÙØ±ÛŒÙ‡", "Ø³Ù„ÙÚ†Ú¯Ø§Ù†", "Ú©Ù‡Ú©", "Ø³Ù„ÙÚ†Ú¯Ø§Ù†", "Ú©Ù‡Ú©", "Ø¬Ø¹ÙØ±ÛŒÙ‡", "Ù‚Ù…"
    ]},
    {"name": "Ú©Ø±Ø¯Ø³ØªØ§Ù†", "code": "20", "cities": [
        "Ø³Ù†Ù†Ø¯Ø¬", "Ø¨Ø§Ù†Ù‡", "Ø³Ù‚Ø²", "Ù…Ø±ÛŒÙˆØ§Ù†", "Ø¯ÛŒÙˆØ§Ù†Ø¯Ø±Ù‡", "Ú©Ø§Ù…ÛŒØ§Ø±Ø§Ù†", "Ù‚Ø±ÙˆÙ‡", "Ø¯Ù‡Ú¯Ù„Ø§Ù†", 
        "Ø¨ÛŒØ¬Ø§Ø±", "Ú©Ø§Ù…ÛŒØ§Ø±Ø§Ù†", "Ù‚Ø±ÙˆÙ‡", "Ø¯Ù‡Ú¯Ù„Ø§Ù†", "Ø¨ÛŒØ¬Ø§Ø±", "Ø¨Ø§Ù†Ù‡", "Ø³Ù‚Ø²", "Ù…Ø±ÛŒÙˆØ§Ù†", "Ø¯ÛŒÙˆØ§Ù†Ø¯Ø±Ù‡"
    ]},
    {"name": "Ú©Ø±Ù…Ø§Ù†", "code": "21", "cities": [
        "Ú©Ø±Ù…Ø§Ù†", "Ø¬ÛŒØ±ÙØª", "Ø±ÙØ³Ù†Ø¬Ø§Ù†", "Ø²Ø±Ù†Ø¯", "Ø³ÛŒØ±Ø¬Ø§Ù†", "Ø¨Ù…", "Ø¨Ø±Ø¯Ø³ÛŒØ±", "Ø±Ø§ÙˆØ±", 
        "Ø¨Ø§ÙØª", "Ø´Ù‡Ø± Ø¨Ø§Ø¨Ú©", "Ø±Ø§ÛŒÙ†", "Ú©ÙˆÙ‡Ø¨Ù†Ø§Ù†", "Ù…Ù†ÙˆØ¬Ø§Ù†", "Ú©Ù‡Ù†ÙˆØ¬", "Ø¹Ù†Ø¨Ø±Ø¢Ø¨Ø§Ø¯", 
        "Ø¬ÛŒØ±ÙØª", "Ø±ÙØ³Ù†Ø¬Ø§Ù†", "Ø²Ø±Ù†Ø¯", "Ø³ÛŒØ±Ø¬Ø§Ù†", "Ø¨Ù…"
    ]},
    {"name": "Ú©Ø±Ù…Ø§Ù†Ø´Ø§Ù‡", "code": "22", "cities": [
        "Ú©Ø±Ù…Ø§Ù†Ø´Ø§Ù‡", "Ø§Ø³Ù„Ø§Ù…â€ŒØ¢Ø¨Ø§Ø¯ ØºØ±Ø¨", "Ú©Ù†Ú¯Ø§ÙˆØ±", "Ù‡Ø±Ø³ÛŒÙ†", "Ø³Ù†Ù‚Ø±", "Ù¾Ø§ÙˆÙ‡", "Ø¬ÙˆØ§Ù†Ø±ÙˆØ¯", 
        "Ø±ÙˆØ§Ù†Ø³Ø±", "Ø«Ù„Ø§Ø« Ø¨Ø§Ø¨Ø§Ø¬Ø§Ù†ÛŒ", "Ù‚ØµØ±Ø´ÛŒØ±ÛŒÙ†", "Ú¯ÛŒÙ„Ø§Ù†ØºØ±Ø¨", "Ù‡Ø±Ø³ÛŒÙ†", "Ø³Ù†Ù‚Ø±", "Ù¾Ø§ÙˆÙ‡", 
        "Ø¬ÙˆØ§Ù†Ø±ÙˆØ¯", "Ø±ÙˆØ§Ù†Ø³Ø±", "Ø«Ù„Ø§Ø« Ø¨Ø§Ø¨Ø§Ø¬Ø§Ù†ÛŒ", "Ù‚ØµØ±Ø´ÛŒØ±ÛŒÙ†", "Ú¯ÛŒÙ„Ø§Ù†ØºØ±Ø¨", "Ø§Ø³Ù„Ø§Ù…â€ŒØ¢Ø¨Ø§Ø¯ ØºØ±Ø¨", "Ú©Ù†Ú¯Ø§ÙˆØ±"
    ]},
    {"name": "Ú©Ù‡Ú¯ÛŒÙ„ÙˆÛŒÙ‡ Ùˆ Ø¨ÙˆÛŒØ±Ø§Ø­Ù…Ø¯", "code": "23", "cities": [
        "ÛŒØ§Ø³ÙˆØ¬", "Ú¯Ú†Ø³Ø§Ø±Ø§Ù†", "Ø¯ÙˆÚ¯Ù†Ø¨Ø¯Ø§Ù†", "Ø¯Ù†Ø§", "Ø¨Ø§Ø´Øª", "Ú†Ø±Ø§Ù…", "Ù„ÛŒÚ©Ú©", "Ø¯Ù‡Ø¯Ø´Øª", 
        "Ø¯ÙˆÚ¯Ù†Ø¨Ø¯Ø§Ù†", "Ø¯Ù†Ø§", "Ø¨Ø§Ø´Øª", "Ú†Ø±Ø§Ù…", "Ù„ÛŒÚ©Ú©", "Ø¯Ù‡Ø¯Ø´Øª", "Ú¯Ú†Ø³Ø§Ø±Ø§Ù†", "ÛŒØ§Ø³ÙˆØ¬"
    ]},
    {"name": "Ú¯Ù„Ø³ØªØ§Ù†", "code": "24", "cities": [
        "Ú¯Ø±Ú¯Ø§Ù†", "Ú¯Ù†Ø¨Ø¯ Ú©Ø§ÙˆÙˆØ³", "Ø¹Ù„ÛŒâ€ŒØ¢Ø¨Ø§Ø¯ Ú©ØªÙˆÙ„", "Ù…ÛŒÙ†ÙˆØ¯Ø´Øª", "Ø¢Ù‚â€ŒÙ‚Ù„Ø§", "Ú©Ø±Ø¯Ú©ÙˆÛŒ", 
        "Ø¨Ù†Ø¯Ø± ØªØ±Ú©Ù…Ù†", "Ø¨Ù†Ø¯Ø± Ú¯Ø²", "Ú©Ù„Ø§Ù„Ù‡", "Ø¢Ø²Ø§Ø¯Ø´Ù‡Ø±", "Ø±Ø§Ù…ÛŒØ§Ù†", "Ú¯Ù†Ø¨Ø¯ Ú©Ø§ÙˆÙˆØ³", 
        "Ø¹Ù„ÛŒâ€ŒØ¢Ø¨Ø§Ø¯ Ú©ØªÙˆÙ„", "Ù…ÛŒÙ†ÙˆØ¯Ø´Øª", "Ø¢Ù‚â€ŒÙ‚Ù„Ø§", "Ú©Ø±Ø¯Ú©ÙˆÛŒ"
    ]},
    {"name": "Ú¯ÛŒÙ„Ø§Ù†", "code": "25", "cities": [
        "Ø±Ø´Øª", "Ø§Ù†Ø²Ù„ÛŒ", "Ù„Ø§Ù‡ÛŒØ¬Ø§Ù†", "Ù„Ù†Ú¯Ø±ÙˆØ¯", "Ø±ÙˆØ¯Ø³Ø±", "ÙÙˆÙ…Ù†", "ØµÙˆÙ…Ø¹Ù‡â€ŒØ³Ø±Ø§", "Ø±ÙˆØ¯Ø¨Ø§Ø±", 
        "Ù…Ù†Ø¬ÛŒÙ„", "Ø§Ù…Ù„Ø´", "ØªØ§Ù„Ø´", "Ù…Ø§Ø³Ø§Ù„", "Ø´ÙØª", "Ø¢Ø³ØªØ§Ø±Ø§", "Ø±Ø¶ÙˆØ§Ù†Ø´Ù‡Ø±", "Ú©ÙˆÙ…Ù„Ù‡", 
        "Ù„Ø§Ù‡ÛŒØ¬Ø§Ù†", "Ù„Ù†Ú¯Ø±ÙˆØ¯", "Ø±ÙˆØ¯Ø³Ø±", "ÙÙˆÙ…Ù†", "ØµÙˆÙ…Ø¹Ù‡â€ŒØ³Ø±Ø§", "Ø±ÙˆØ¯Ø¨Ø§Ø±", "Ù…Ù†Ø¬ÛŒÙ„"
    ]},
    {"name": "Ù„Ø±Ø³ØªØ§Ù†", "code": "26", "cities": [
        "Ø®Ø±Ù…â€ŒØ¢Ø¨Ø§Ø¯", "Ø¨Ø±ÙˆØ¬Ø±Ø¯", "Ø¯ÙˆØ±ÙˆØ¯", "Ø§Ù„ÛŒÚ¯ÙˆØ¯Ø±Ø²", "Ú©ÙˆÙ‡Ø¯Ø´Øª", "Ù¾Ù„â€ŒØ¯Ø®ØªØ±", "Ø§Ø²Ù†Ø§", 
        "Ù†ÙˆØ±Ø¢Ø¨Ø§Ø¯", "Ù¾Ù„Ø¯Ø®ØªØ±", "Ø±ÙˆÙ…Ø´Ú©Ø§Ù†", "Ø³Ù„Ø³Ù„Ù‡", "Ø¯Ù„ÙØ§Ù†", "Ø¨Ø±ÙˆØ¬Ø±Ø¯", "Ø¯ÙˆØ±ÙˆØ¯", 
        "Ø§Ù„ÛŒÚ¯ÙˆØ¯Ø±Ø²", "Ú©ÙˆÙ‡Ø¯Ø´Øª", "Ù¾Ù„â€ŒØ¯Ø®ØªØ±", "Ø§Ø²Ù†Ø§", "Ù†ÙˆØ±Ø¢Ø¨Ø§Ø¯"
    ]},
    {"name": "Ù…Ø§Ø²Ù†Ø¯Ø±Ø§Ù†", "code": "27", "cities": [
        "Ø³Ø§Ø±ÛŒ", "Ø¨Ø§Ø¨Ù„", "Ø¢Ù…Ù„", "Ù‚Ø§Ø¦Ù…â€ŒØ´Ù‡Ø±", "Ø¨Ø§Ø¨Ù„Ø³Ø±", "Ø¨Ù‡Ø´Ù‡Ø±", "Ù†ÙˆØ´Ù‡Ø±", "Ú†Ø§Ù„ÙˆØ³", 
        "Ø±Ø§Ù…Ø³Ø±", "ØªÙ†Ú©Ø§Ø¨Ù†", "Ù†ÙˆØ±", "Ø¢Ù…Ù„", "Ù‚Ø§Ø¦Ù…â€ŒØ´Ù‡Ø±", "Ø¨Ø§Ø¨Ù„Ø³Ø±", "Ø¨Ù‡Ø´Ù‡Ø±", "Ù†ÙˆØ´Ù‡Ø±", 
        "Ú†Ø§Ù„ÙˆØ³", "Ø±Ø§Ù…Ø³Ø±", "ØªÙ†Ú©Ø§Ø¨Ù†", "Ù†ÙˆØ±", "Ø³Ø§Ø±ÛŒ", "Ø¨Ø§Ø¨Ù„"
    ]},
    {"name": "Ù…Ø±Ú©Ø²ÛŒ", "code": "28", "cities": [
        "Ø§Ø±Ø§Ú©", "Ø³Ø§ÙˆÙ‡", "Ø®Ù…ÛŒÙ†", "Ù…Ø­Ù„Ø§Øª", "Ø¯Ù„ÛŒØ¬Ø§Ù†", "Ø´Ø§Ø²Ù†Ø¯", "Ø¢Ø´ØªÛŒØ§Ù†", "ØªÙØ±Ø´", 
        "ÙØ±Ø§Ù‡Ø§Ù†", "Ú©Ù…ÛŒØ¬Ø§Ù†", "Ø®Ù†Ø¯Ø§Ø¨", "Ø³Ø§ÙˆÙ‡", "Ø®Ù…ÛŒÙ†", "Ù…Ø­Ù„Ø§Øª", "Ø¯Ù„ÛŒØ¬Ø§Ù†", "Ø´Ø§Ø²Ù†Ø¯", 
        "Ø¢Ø´ØªÛŒØ§Ù†", "ØªÙØ±Ø´", "ÙØ±Ø§Ù‡Ø§Ù†", "Ú©Ù…ÛŒØ¬Ø§Ù†", "Ø®Ù†Ø¯Ø§Ø¨", "Ø§Ø±Ø§Ú©"
    ]},
    {"name": "Ù‡Ø±Ù…Ø²Ú¯Ø§Ù†", "code": "29", "cities": [
        "Ø¨Ù†Ø¯Ø±Ø¹Ø¨Ø§Ø³", "Ù‚Ø´Ù…", "Ú©ÛŒØ´", "Ù…ÛŒÙ†Ø§Ø¨", "Ø¨Ù†Ø¯Ø± Ù„Ù†Ú¯Ù‡", "Ø¨Ù†Ø¯Ø± Ø¬Ø§Ø³Ú©", "Ø­Ø§Ø¬ÛŒâ€ŒØ¢Ø¨Ø§Ø¯", 
        "Ø±ÙˆØ¯Ø§Ù†", "Ù‚Ø´Ù…", "Ú©ÛŒØ´", "Ù…ÛŒÙ†Ø§Ø¨", "Ø¨Ù†Ø¯Ø± Ù„Ù†Ú¯Ù‡", "Ø¨Ù†Ø¯Ø± Ø¬Ø§Ø³Ú©", "Ø­Ø§Ø¬ÛŒâ€ŒØ¢Ø¨Ø§Ø¯", 
        "Ø±ÙˆØ¯Ø§Ù†", "Ø¨Ù†Ø¯Ø±Ø¹Ø¨Ø§Ø³"
    ]},
    {"name": "Ù‡Ù…Ø¯Ø§Ù†", "code": "30", "cities": [
        "Ù‡Ù…Ø¯Ø§Ù†", "Ù…Ù„Ø§ÛŒØ±", "Ù†Ù‡Ø§ÙˆÙ†Ø¯", "Ú©Ø¨ÙˆØ¯Ø±Ø¢Ù‡Ù†Ú¯", "ØªÙˆÛŒØ³Ø±Ú©Ø§Ù†", "Ø§Ø³Ø¯Ø¢Ø¨Ø§Ø¯", "Ø¨Ù‡Ø§Ø±", 
        "Ø±Ø²Ù†", "ÙØ§Ù…Ù†ÛŒÙ†", "Ù…Ù„Ø§ÛŒØ±", "Ù†Ù‡Ø§ÙˆÙ†Ø¯", "Ú©Ø¨ÙˆØ¯Ø±Ø¢Ù‡Ù†Ú¯", "ØªÙˆÛŒØ³Ø±Ú©Ø§Ù†", "Ø§Ø³Ø¯Ø¢Ø¨Ø§Ø¯", 
        "Ø¨Ù‡Ø§Ø±", "Ø±Ø²Ù†", "ÙØ§Ù…Ù†ÛŒÙ†", "Ù‡Ù…Ø¯Ø§Ù†"
    ]},
    {"name": "ÛŒØ²Ø¯", "code": "31", "cities": [
        "ÛŒØ²Ø¯", "Ù…ÛŒØ¨Ø¯", "Ø§Ø±Ø¯Ú©Ø§Ù†", "Ø¨Ø§ÙÙ‚", "Ø§Ø¨Ø±Ú©ÙˆÙ‡", "Ù…Ù‡Ø±ÛŒØ²", "ØªÙØª", "Ø§Ø¨Ø±Ú©ÙˆÙ‡", 
        "Ø¨Ø§ÙÙ‚", "Ø§Ø±Ø¯Ú©Ø§Ù†", "Ù…ÛŒØ¨Ø¯", "Ù…Ù‡Ø±ÛŒØ²", "ØªÙØª", "ÛŒØ²Ø¯"
    ]}
]


PERSIAN_CHAR_MAP = {
    'Ø¢': 'a', 'Ø§': 'a', 'Ø£': 'a', 'Ø¥': 'e', 'Ø¡': '', 'Ø¦': 'y', 'Ø¤': 'o',
    'Ø¨': 'b', 'Ù¾': 'p', 'Øª': 't', 'Ø«': 's', 'Ø¬': 'j', 'Ú†': 'ch', 'Ø­': 'h',
    'Ø®': 'kh', 'Ø¯': 'd', 'Ø°': 'z', 'Ø±': 'r', 'Ø²': 'z', 'Ú˜': 'zh', 'Ø³': 's',
    'Ø´': 'sh', 'Øµ': 's', 'Ø¶': 'z', 'Ø·': 't', 'Ø¸': 'z', 'Ø¹': 'a', 'Øº': 'gh',
    'Ù': 'f', 'Ù‚': 'gh', 'Ú©': 'k', 'Ùƒ': 'k', 'Ú¯': 'g', 'Ù„': 'l', 'Ù…': 'm',
    'Ù†': 'n', 'Ùˆ': 'v', 'Ù‡': 'h', 'Ø©': 'h', 'ÛŒ': 'y', 'ÙŠ': 'y',
    'Û°': '0', 'Û±': '1', 'Û²': '2', 'Û³': '3', 'Û´': '4',
    'Ûµ': '5', 'Û¶': '6', 'Û·': '7', 'Û¸': '8', 'Û¹': '9',
}

DIGIT_WORD_MAP = {
    '0': 'zero', '1': 'one', '2': 'two', '3': 'three', '4': 'four',
    '5': 'five', '6': 'six', '7': 'seven', '8': 'eight', '9': 'nine',
}

ALPHA_DIGIT_TOKEN_MAP = {
    '0': 'a', '1': 'b', '2': 'c', '3': 'd', '4': 'e',
    '5': 'f', '6': 'g', '7': 'h', '8': 'i', '9': 'j',
}


def _slugify_fa(text: str) -> str:
    text = (text or '').strip().lower()
    if not text:
        return ''

    out = []
    for ch in text:
        if ch in PERSIAN_CHAR_MAP:
            out.append(PERSIAN_CHAR_MAP[ch])
        elif 'a' <= ch <= 'z' or '0' <= ch <= '9':
            out.append(ch)
        elif ch in {' ', '-', '_', '/', '\\', 'ØŒ', ',', 'Ù€', 'â€Œ'}:
            out.append('-')

    slug = ''.join(out)
    slug = re.sub(r'[^a-z0-9-]+', '-', slug)
    slug = re.sub(r'-{2,}', '-', slug).strip('-')
    return slug


def _replace_digits_with_words(value: str) -> str:
    result = []
    for ch in str(value or ''):
        if ch.isdigit():
            result.append(f"-{DIGIT_WORD_MAP[ch]}-")
        else:
            result.append(ch)
    return ''.join(result)


def _slugify_alpha_only(text: str) -> str:
    base = _slugify_fa(_replace_digits_with_words(text))
    base = re.sub(r'[^a-z-]+', '-', base)
    base = re.sub(r'-{2,}', '-', base).strip('-')
    return base


def _code_alpha_token(code: str) -> str:
    digits = re.sub(r'[^0-9]', '', str(code or ''))
    if not digits:
        return 'x'
    return ''.join(ALPHA_DIGIT_TOKEN_MAP[d] for d in digits)


def _alpha_suffix(index: int) -> str:
    letters = 'abcdefghijklmnopqrstuvwxyz'
    n = max(1, index)
    out = []
    while n > 0:
        n -= 1
        out.append(letters[n % 26])
        n //= 26
    return ''.join(reversed(out))


def _ensure_unique_slug(queryset, base_slug: str, token: str) -> str:
    base = (base_slug or '').strip('-') or 'location'
    candidate = base
    if not queryset.filter(slug=candidate).exists():
        return candidate

    candidate = f"{base}-{token}"
    if not queryset.filter(slug=candidate).exists():
        return candidate

    idx = 1
    while True:
        candidate = f"{base}-{token}-{_alpha_suffix(idx)}"
        if not queryset.filter(slug=candidate).exists():
            return candidate
        idx += 1


def build_province_slug(name: str, code: str, province_id: int | None = None) -> str:
    base = canonical_location_slug(name, scope='province') or 'province'
    qs = UserProvince.objects.all()
    if province_id is not None:
        qs = qs.exclude(id=province_id)
    existing = qs.values_list('slug', flat=True)
    return ensure_unique_slug(existing, base)


def build_city_slug(name: str, code: str, province_id: int, city_id: int | None = None) -> str:
    province_name = UserProvince.objects.filter(id=province_id).values_list('name', flat=True).first() or ''
    base = canonical_location_slug(name, scope='city', province_name=province_name) or 'city'
    qs = UserCity.objects.filter(province_id=province_id)
    if city_id is not None:
        qs = qs.exclude(id=city_id)
    existing = qs.values_list('slug', flat=True)
    return ensure_unique_slug(existing, base)


def import_user_locations(update_mode=True):
    """Import locations for user app 
    
    Ù…Ù†Ø·Ù‚:
    - Ø§Ø² get_or_create Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒÚ©Ù†Ø¯ ØªØ§ duplicate Ø§ÛŒØ¬Ø§Ø¯ Ù†Ø´ÙˆØ¯
    - Ø§Ú¯Ø± Ù…ÙˆØ¬ÙˆØ¯ Ø¨ÙˆØ¯ØŒ update Ù…ÛŒâ€ŒÚ©Ù†Ø¯ (Ù†Ø§Ù…ØŒ ÙˆØ¶Ø¹ÛŒØª)
    - Ø§Ú¯Ø± Ù…ÙˆØ¬ÙˆØ¯ Ù†Ø¨ÙˆØ¯ØŒ create Ù…ÛŒâ€ŒÚ©Ù†Ø¯
    - Ù‡ÛŒÚ† Ø¯Ø§Ø¯Ù‡â€ŒØ§ÛŒ Ù¾Ø§Ú© Ù†Ù…ÛŒâ€ŒØ´ÙˆØ¯ (Ø­ØªÛŒ Ø¨Ø¯ÙˆÙ† update_mode)
    """
    print("\n" + "="*60)
    print("ğŸ“ Import Ø¨Ø±Ø§ÛŒ User Location")
    print("="*60)
    print("ğŸ”„ Ù…Ù†Ø·Ù‚: Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø§Ø² duplicate + update Ù…ÙˆØ§Ø±Ø¯ Ù…ÙˆØ¬ÙˆØ¯ + Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ù…ÙˆØ§Ø±Ø¯ Ø¬Ø¯ÛŒØ¯")
    
    try:
        with transaction.atomic():
            # Ø¯Ø±ÛŒØ§ÙØª Ú©Ø´ÙˆØ± Ø§ÛŒØ±Ø§Ù† (Ø¨Ø§ÛŒØ¯ Ø§Ø² Ù‚Ø¨Ù„ Ø³Ø§Ø®ØªÙ‡ Ø´Ø¯Ù‡ Ø¨Ø§Ø´Ù‡)
            from src.core.models import Country
            iran = Country.get_iran()  # Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ù…ØªØ¯ Ø¬Ø¯ÛŒØ¯
            print(f"ğŸŒ Ú©Ø´ÙˆØ±: {iran.name} (id={iran.id})")
            
            total_provinces = len(PROVINCES_DATA)
            total_cities = sum(len(prov["cities"]) for prov in PROVINCES_DATA)
            
            print(f"ğŸ“Š Ø¢Ù…Ø§Ø¯Ù‡ import {total_provinces} Ø§Ø³ØªØ§Ù† Ùˆ {total_cities} Ø´Ù‡Ø±...")
            
            province_count = 0
            city_count = 0
            
            for province_data in PROVINCES_DATA:
                # Ø§ÛŒØ¬Ø§Ø¯ ÛŒØ§ Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø§Ø³ØªØ§Ù† (Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø§Ø² duplicate)
                province, created = UserProvince.objects.get_or_create(
                    code=province_data["code"],
                    defaults={
                        "name": province_data["name"],
                        "slug": "",
                        "country": iran,
                        "is_active": True
                    }
                )
                province.slug = build_province_slug(
                    province_data["name"],
                    province_data["code"],
                    None if created else province.id,
                )
                
                # Ø§Ú¯Ø± Ù…ÙˆØ¬ÙˆØ¯ Ø¨ÙˆØ¯ØŒ update Ú©Ù† (Ø¨Ø±Ø§ÛŒ Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù†Ø§Ù… ÛŒØ§ ÙˆØ¶Ø¹ÛŒØª)
                if not created:
                    province.name = province_data["name"]
                    province.is_active = True
                province.save()
                
                province_count += 1
                status = "Ø§ÛŒØ¬Ø§Ø¯ Ø´Ø¯" if created else "Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø´Ø¯"
                print(f"âœ… Ø§Ø³ØªØ§Ù† '{province_data['name']}' Ø¨Ø§ Ú©Ø¯ {province_data['code']} {status}")
                
                # Ø§ÛŒØ¬Ø§Ø¯ ÛŒØ§ Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø´Ù‡Ø±Ù‡Ø§ÛŒ Ø§Ø³ØªØ§Ù†
                cities = province_data["cities"]
                cities_created = 0
                cities_updated = 0
                
                for index, city_name in enumerate(cities, 1):
                    city_code = f"{province_data['code']}{index:02d}"
                    city, created = UserCity.objects.get_or_create(
                        code=city_code,
                        province=province,
                        defaults={
                            "name": city_name,
                            "slug": "",
                            "is_active": True
                        }
                    )
                    city.slug = build_city_slug(
                        city_name,
                        city_code,
                        province.id,
                        None if created else city.id,
                    )
                    
                    # Ø§Ú¯Ø± Ù…ÙˆØ¬ÙˆØ¯ Ø¨ÙˆØ¯ØŒ update Ú©Ù†
                    if not created:
                        city.name = city_name
                        city.is_active = True
                        city.save()
                        cities_updated += 1
                    else:
                        city.save()
                        cities_created += 1
                    
                    city_count += 1
                
                print(f"   ğŸ“ {len(cities)} Ø´Ù‡Ø±: {cities_created} Ø§ÛŒØ¬Ø§Ø¯ Ø´Ø¯ØŒ {cities_updated} Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø´Ø¯")
            
            print(f"\nğŸ‰ import User Location Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯!")
            print(f"ğŸ“Š Ù†ØªØ§ÛŒØ¬ Ù†Ù‡Ø§ÛŒÛŒ:")
            print(f"   â€¢ {province_count} Ø§Ø³ØªØ§Ù†")
            print(f"   â€¢ {city_count} Ø´Ù‡Ø±")
            
            return True
            
    except Exception as e:
        print(f"\nâŒ Ø®Ø·Ø§ Ø¯Ø± import User Location: {str(e)}")
        import traceback
        traceback.print_exc()
        return False


def import_real_estate_locations(update_mode=True):
    """Import locations - Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² models Ù…Ø±Ú©Ø²ÛŒ Ø¯Ø± core
    
    Ù…Ù†Ø·Ù‚:
    - Ø§Ù„Ø§Ù† Ù‡Ù…Ù‡ Ø§Ø² core.models Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒÚ©Ù†Ù†Ø¯ (Country, Province, City)
    - real_estate ÙÙ‚Ø· CityRegion Ù…Ø®ØªØµ Ø®ÙˆØ¯Ø´ Ø¯Ø§Ø±Ù‡
    - Ø§ÛŒÙ† ØªØ§Ø¨Ø¹ Ù‡Ù…Ø§Ù† import_user_locations Ø±Ùˆ ØµØ¯Ø§ Ù…ÛŒØ²Ù†Ù‡
    """
    print("\n" + "="*60)
    print("ğŸ“ Location Models Ù…Ø±Ú©Ø²ÛŒ Ø´Ø¯Ù†Ø¯ - Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² core.models")
    print("="*60)
    # Ú†ÙˆÙ† models Ù…Ø±Ú©Ø²ÛŒ Ø´Ø¯Ù†Ø¯ØŒ ÙÙ‚Ø· ÛŒÚ©Ø¨Ø§Ø± import Ù…ÛŒÚ©Ù†ÛŒÙ…
    return import_user_locations(update_mode)

def main():
    """ØªØ§Ø¨Ø¹ Ø§ØµÙ„ÛŒ"""
    parser = argparse.ArgumentParser(
        description='Import Iranian provinces and cities',
        formatter_class=argparse.RawDescriptionHelpFormatter,
        epilog="""
Ù…Ø«Ø§Ù„â€ŒÙ‡Ø§:
  # ÙÙ‚Ø· Real Estate (Ù¾ÛŒØ´â€ŒÙØ±Ø¶ - Ø¨Ø±Ø§ÛŒ Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø§Ø² duplicate Ø¯Ø± User)
  python scripts/import_iranian_locations.py
  
  # ÙÙ‚Ø· Real Estate Ø¨Ø§ update
  python scripts/import_iranian_locations.py --update
  
  # ÙÙ‚Ø· User (Ø¨Ø§ update Ø¨Ø±Ø§ÛŒ Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø§Ø² duplicate)
  python scripts/import_iranian_locations.py --app user --update
  
  # Ù‡Ø± Ø¯Ùˆ (Ø¨Ø§ update Ø¨Ø±Ø§ÛŒ User)
  python scripts/import_iranian_locations.py --app both --update
        """
    )
    
    parser.add_argument(
        '--app',
        choices=['user', 'real_estate', 'both'],
        default='real_estate',
        help='Ø§Ù†ØªØ®Ø§Ø¨ app Ø¨Ø±Ø§ÛŒ import (default: real_estate - Ø¨Ø±Ø§ÛŒ Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø§Ø² duplicate Ø¯Ø± User)'
    )
    
    parser.add_argument(
        '--update',
        action='store_true',
        help='(Ø§Ø®ØªÛŒØ§Ø±ÛŒ) Ù‡Ù…ÛŒØ´Ù‡ Ø§Ø² get_or_create Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯ - Ø§ÛŒÙ† flag ÙÙ‚Ø· Ø¨Ø±Ø§ÛŒ Ø³Ø§Ø²Ú¯Ø§Ø±ÛŒ Ø§Ø³Øª'
    )
    
    args = parser.parse_args()
    
    print("ğŸš€ Ø´Ø±ÙˆØ¹ import Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø§Ø³ØªØ§Ù†â€ŒÙ‡Ø§ Ùˆ Ø´Ù‡Ø±Ù‡Ø§ÛŒ Ø§ÛŒØ±Ø§Ù†...")
    print(f"ğŸ“¦ App Ø§Ù†ØªØ®Ø§Ø¨ Ø´Ø¯Ù‡: {args.app}")
    print("ğŸ”„ Ù…Ù†Ø·Ù‚: Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø§Ø² duplicate + update Ù…ÙˆØ§Ø±Ø¯ Ù…ÙˆØ¬ÙˆØ¯ + Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ù…ÙˆØ§Ø±Ø¯ Ø¬Ø¯ÛŒØ¯")
    print("â„¹ï¸  Ù‡ÛŒÚ† Ø¯Ø§Ø¯Ù‡â€ŒØ§ÛŒ Ù¾Ø§Ú© Ù†Ù…ÛŒâ€ŒØ´ÙˆØ¯ - ÙÙ‚Ø· Ø§Ø¶Ø§ÙÙ‡ Ùˆ Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù…ÛŒâ€ŒØ´ÙˆØ¯")
    
    success = True
    
    if args.app in ['user', 'both']:
        # Ù‡Ù…ÛŒØ´Ù‡ Ø§Ø² get_or_create Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒÚ©Ù†ÛŒÙ… (Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø§Ø² duplicate)
        if not import_user_locations(update_mode=True):
            success = False
    
    if args.app in ['real_estate', 'both']:
        # Ù‡Ù…ÛŒØ´Ù‡ Ø§Ø² get_or_create Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒÚ©Ù†ÛŒÙ… (Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø§Ø² duplicate)
        if not import_real_estate_locations(update_mode=True):
            success = False
    
    if success:
        print("\n" + "="*60)
        print("ğŸ¯ Ù‡Ù…Ù‡ importâ€ŒÙ‡Ø§ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯!")
        print("="*60)
        
        # Ù†Ù…Ø§ÛŒØ´ Ø¢Ù…Ø§Ø± Ù†Ù‡Ø§ÛŒÛŒ
        if args.app in ['user', 'both']:
            db_provinces = UserProvince.objects.count()
            db_cities = UserCity.objects.count()
            print(f"\nğŸ“Š User Location:")
            print(f"   â€¢ Ø§Ø³ØªØ§Ù†â€ŒÙ‡Ø§: {db_provinces}")
            print(f"   â€¢ Ø´Ù‡Ø±Ù‡Ø§: {db_cities}")
        
        if args.app in ['real_estate', 'both']:
            db_provinces = UserProvince.objects.count()
            db_cities = UserCity.objects.count()
            print(f"\nğŸ“Š Real Estate Location (Ù…Ø±Ú©Ø²ÛŒ Ø´Ø¯Ù‡ Ø¯Ø± core):")
            print(f"   â€¢ Ø§Ø³ØªØ§Ù†â€ŒÙ‡Ø§: {db_provinces}")
            print(f"   â€¢ Ø´Ù‡Ø±Ù‡Ø§: {db_cities}")
            print(f"   â„¹ï¸  Ù…Ù†Ø·Ù‚Ù‡ Ùˆ Ù…Ø­Ù„Ù‡ Ø¨Ù‡ ØµÙˆØ±Øª Ø¯Ø§ÛŒÙ†Ø§Ù…ÛŒÚ© Ø§Ø² Ø·Ø±ÛŒÙ‚ Ù†Ù‚Ø´Ù‡ Ø¯Ø± Ù¾Ù†Ù„ Ø§Ø¯Ù…ÛŒÙ† Ø§ÛŒØ¬Ø§Ø¯ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯")
    else:
        print("\n" + "="*60)
        print("âŒ Ø¨Ø±Ø®ÛŒ importâ€ŒÙ‡Ø§ Ø¨Ø§ Ø®Ø·Ø§ Ù…ÙˆØ§Ø¬Ù‡ Ø´Ø¯Ù†Ø¯!")
        print("="*60)
    
    return success


if __name__ == "__main__":
    success = main()
    if success:
        print("\nğŸš€ Ø§Ø³Ú©Ø±ÛŒÙ¾Øª Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø§Ø¬Ø±Ø§ Ø´Ø¯!")
        exit(0)
    else:
        print("\nğŸ’¥ Ø§Ø³Ú©Ø±ÛŒÙ¾Øª Ø¨Ø§ Ø®Ø·Ø§ Ù…ÙˆØ§Ø¬Ù‡ Ø´Ø¯!")
        exit(1)
