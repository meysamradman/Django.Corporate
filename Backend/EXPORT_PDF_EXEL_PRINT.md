ğŸ“Š ØªØ­Ù„ÛŒÙ„ ÙˆØ¶Ø¹ÛŒØª ÙØ¹Ù„ÛŒ Ùˆ Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯Ø§Øª Ø¨Ù‡Ø¨ÙˆØ¯Ø¨Ø¹Ø¯ Ø§Ø² Ø¨Ø±Ø±Ø³ÛŒ Ú©Ø¯ Ø´Ù…Ø§ Ùˆ Ø³Ø±Ú† Ø¯Ø± Ù…Ù†Ø§Ø¨Ø¹ Ù…Ø¹ØªØ¨Ø±ØŒ Ø§ÛŒÙ† Ù†ØªØ§ÛŒØ¬ Ø±Ùˆ Ø¯Ø§Ø±Ù…:âœ… Ú†ÛŒØ²Ù‡Ø§ÛŒÛŒ Ú©Ù‡ Ø®ÙˆØ¨ Ù¾ÛŒØ§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ Ø´Ø¯Ù†:
Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² jdatetime - Ø§Ù†ØªØ®Ø§Ø¨ Ø®ÙˆØ¨ÛŒ Ø¨Ø±Ø§ÛŒ ØªØ¨Ø¯ÛŒÙ„ ØªØ§Ø±ÛŒØ® Ø´Ù…Ø³ÛŒ
Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² xlsxwriter Ø¨Ø±Ø§ÛŒ Excel - Ø¨Ù‡ØªØ±ÛŒÙ† Ú©ØªØ§Ø¨Ø®Ø§Ù†Ù‡ Ø¨Ø±Ø§ÛŒ ØªÙˆÙ„ÛŒØ¯ ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Excel Ø¯Ø± Ø³Ø±ÙˆØ±
Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² ReportLab Ø¨Ø±Ø§ÛŒ PDF - Ø§Ø³ØªØ§Ù†Ø¯Ø§Ø±Ø¯ ØµÙ†Ø¹ØªÛŒ Ø¨Ø±Ø§ÛŒ ØªÙˆÙ„ÛŒØ¯ PDF Ø¯Ø± Django
Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² arabic_reshaper Ùˆ bidi.algorithm - Ø±Ø§Ù‡ Ø¯Ø±Ø³Øª Ø¨Ø±Ø§ÛŒ RTL Ø¯Ø± PDF
âš ï¸ Ù…Ø´Ú©Ù„Ø§Øª Ùˆ Ù†Ù‚Ø§Ø· Ø¶Ø¹Ù:
ØªØ§Ø±ÛŒØ®â€ŒÙ‡Ø§ÛŒ ÙØ§Ø±Ø³ÛŒ Ø¯Ø± Excel Ù†Ø§Ù‚Øµ - ÙÙ‚Ø· Ø¨Ù‡ ØµÙˆØ±Øª Ø±Ø´ØªÙ‡ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´Ù‡
RTL Ø¯Ø± PDF Ù†ÛŒØ§Ø² Ø¨Ù‡ Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ Ø¯Ø§Ø±Ù‡ - Ø¨Ø§ÛŒØ¯ Ø§Ø² ReportLab 4.4+ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯
ÙÙˆÙ†Øª ÙØ§Ø±Ø³ÛŒ - Fallback Strategy Ø¶Ø¹ÛŒÙ
Ø¹Ø¯Ù… Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² locale Ø¨Ø±Ø§ÛŒ Ù†Ø§Ù…â€ŒÙ‡Ø§ÛŒ Ù…Ø§Ù‡ ÙØ§Ø±Ø³ÛŒ
Print view Ø®ÛŒÙ„ÛŒ Ø³Ø§Ø¯Ù‡ Ø§Ø³Øª

# ğŸ” ØªØ­Ù„ÛŒÙ„ Ø¬Ø§Ù…Ø¹ Ùˆ Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯Ø§Øª Ø¨Ù‡Ø¨ÙˆØ¯ Ø³ÛŒØ³ØªÙ… Export

## ğŸ“ Ø³Ø§Ø®ØªØ§Ø± ÙØ¹Ù„ÛŒ Ù¾Ø±ÙˆÚ˜Ù‡

```
Backend/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ core/
â”‚   â”‚   â””â”€â”€ utils/
â”‚   â”‚       â””â”€â”€ date_utils.py          # âœ… ØªØ§Ø±ÛŒØ®â€ŒÙ‡Ø§ÛŒ ÙØ§Ø±Ø³ÛŒ (Ø§ÙˆÙ„ÛŒÙ‡)
â”‚   â””â”€â”€ blog/
â”‚       â”œâ”€â”€ services/admin/
â”‚       â”‚   â”œâ”€â”€ pdf_export_service.py      # âœ… Export ØªÚ© Ø±Ú©ÙˆØ±Ø¯ PDF
â”‚       â”‚   â”œâ”€â”€ pdf_list_export_service.py # âœ… Export Ù„ÛŒØ³Øª PDF
â”‚       â”‚   â”œâ”€â”€ excel_export_service.py    # âœ… Export Excel
â”‚       â”‚   â””â”€â”€ print_list_export_service.py # âœ… Export Print
â”‚       â””â”€â”€ views/admin/
â”‚           â”œâ”€â”€ blog_export_view.py        # âœ… View Export
â”‚           â””â”€â”€ blog_views.py              # âœ… ViewSet Ø§ØµÙ„ÛŒ
```

---

## ğŸ¯ Ù…Ø´Ú©Ù„Ø§Øª Ùˆ Ø±Ø§Ù‡Ú©Ø§Ø±Ù‡Ø§ÛŒ Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯ÛŒ

### 1ï¸âƒ£ **ØªØ§Ø±ÛŒØ®â€ŒÙ‡Ø§ÛŒ ÙØ§Ø±Ø³ÛŒ (Jalali Dates)**

#### âŒ Ù…Ø´Ú©Ù„Ø§Øª ÙØ¹Ù„ÛŒ:
```python
# Backend/src/core/utils/date_utils.py
def format_jalali_date(dt):
    if isinstance(dt, datetime):
        return jdatetime.datetime.fromgregorian(datetime=dt).strftime("%Y/%m/%d")
    return str(dt)
```

**Ù…Ø´Ú©Ù„Ø§Øª:**
- ÙÙ‚Ø· ÙØ±Ù…Øªâ€ŒÙ‡Ø§ÛŒ Ù…Ø­Ø¯ÙˆØ¯ (%Y/%m/%d)
- Ø¨Ø¯ÙˆÙ† Ù†Ø§Ù… Ù…Ø§Ù‡ ÙØ§Ø±Ø³ÛŒ
- Ø¨Ø¯ÙˆÙ† Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ø§Ø² timezone
- Ø¨Ø¯ÙˆÙ† Ú©Ø´ Ø¨Ø±Ø§ÛŒ Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ
- Ø¹Ø¯Ù… Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² locale

#### âœ… Ø±Ø§Ù‡Ú©Ø§Ø± Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯ÛŒ:

**Ø§Ù„Ù) Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² django-jalali-date ÛŒØ§ django_jalali:**
```bash
pip install django-jalali-date jdatetime
# ÛŒØ§
pip install django_jalali jdatetime
```

**Ø¨) Ø¨Ù‡Ø¨ÙˆØ¯ date_utils.py:**
```python
import jdatetime
from datetime import datetime
import locale
from functools import lru_cache
from django.conf import settings
from django.utils import timezone

# ØªÙ†Ø¸ÛŒÙ… locale ÙØ§Ø±Ø³ÛŒ
try:
    if hasattr(settings, 'JALALI_LOCALE'):
        locale.setlocale(locale.LC_ALL, settings.JALALI_LOCALE)
except:
    pass

# Ù†Ø§Ù…â€ŒÙ‡Ø§ÛŒ Ù…Ø§Ù‡â€ŒÙ‡Ø§ÛŒ ÙØ§Ø±Ø³ÛŒ
PERSIAN_MONTH_NAMES = {
    1: 'ÙØ±ÙˆØ±Ø¯ÛŒÙ†', 2: 'Ø§Ø±Ø¯ÛŒØ¨Ù‡Ø´Øª', 3: 'Ø®Ø±Ø¯Ø§Ø¯',
    4: 'ØªÛŒØ±', 5: 'Ù…Ø±Ø¯Ø§Ø¯', 6: 'Ø´Ù‡Ø±ÛŒÙˆØ±',
    7: 'Ù…Ù‡Ø±', 8: 'Ø¢Ø¨Ø§Ù†', 9: 'Ø¢Ø°Ø±',
    10: 'Ø¯ÛŒ', 11: 'Ø¨Ù‡Ù…Ù†', 12: 'Ø§Ø³ÙÙ†Ø¯'
}

PERSIAN_WEEKDAY_NAMES = {
    0: 'Ø´Ù†Ø¨Ù‡', 1: 'ÛŒÚ©Ø´Ù†Ø¨Ù‡', 2: 'Ø¯ÙˆØ´Ù†Ø¨Ù‡',
    3: 'Ø³Ù‡â€ŒØ´Ù†Ø¨Ù‡', 4: 'Ú†Ù‡Ø§Ø±Ø´Ù†Ø¨Ù‡', 5: 'Ù¾Ù†Ø¬Ø´Ù†Ø¨Ù‡', 6: 'Ø¬Ù…Ø¹Ù‡'
}

@lru_cache(maxsize=1024)
def format_jalali_date(dt, format_str='%Y/%m/%d', use_timezone=True):
    """
    ØªØ¨Ø¯ÛŒÙ„ datetime Ø¨Ù‡ ØªØ§Ø±ÛŒØ® Ø´Ù…Ø³ÛŒ Ø¨Ø§ ÙØ±Ù…Øªâ€ŒÙ‡Ø§ÛŒ Ù…ØªÙ†ÙˆØ¹
    
    Args:
        dt: datetime object
        format_str: ÙØ±Ù…Øª Ø®Ø±ÙˆØ¬ÛŒ - Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ø§Ø²:
            - %Y/%m/%d â†’ 1403/10/07
            - %d %B %Y â†’ 07 Ø¯ÛŒ 1403
            - %A %d %B %Y â†’ Ø¯ÙˆØ´Ù†Ø¨Ù‡ 07 Ø¯ÛŒ 1403
        use_timezone: Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² timezone Ù¾Ø±ÙˆÚ˜Ù‡
    """
    if not dt:
        return "-"
    
    try:
        if not isinstance(dt, datetime):
            return str(dt)
        
        # Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² timezone
        if use_timezone and timezone.is_aware(dt):
            dt = timezone.localtime(dt)
        
        # ØªØ¨Ø¯ÛŒÙ„ Ø¨Ù‡ Ø´Ù…Ø³ÛŒ
        j_date = jdatetime.datetime.fromgregorian(datetime=dt)
        
        # Ø§Ú¯Ø± ÙØ±Ù…Øª Ø´Ø§Ù…Ù„ Ù†Ø§Ù… Ù…Ø§Ù‡/Ø±ÙˆØ² ÙØ§Ø±Ø³ÛŒ Ø¨Ø§Ø´Ø¯
        if '%B' in format_str or '%A' in format_str:
            result = format_str
            if '%A' in result:  # Ù†Ø§Ù… Ø±ÙˆØ² Ù‡ÙØªÙ‡
                weekday_name = PERSIAN_WEEKDAY_NAMES.get(j_date.weekday(), '')
                result = result.replace('%A', weekday_name)
            if '%B' in result:  # Ù†Ø§Ù… Ù…Ø§Ù‡
                month_name = PERSIAN_MONTH_NAMES.get(j_date.month, '')
                result = result.replace('%B', month_name)
            if '%Y' in result:
                result = result.replace('%Y', str(j_date.year))
            if '%m' in result:
                result = result.replace('%m', f'{j_date.month:02d}')
            if '%d' in result:
                result = result.replace('%d', f'{j_date.day:02d}')
            return result
        
        return j_date.strftime(format_str)
        
    except Exception as e:
        return "-"

def format_jalali_datetime(dt, format_str='%Y/%m/%d %H:%M', use_timezone=True):
    """ØªØ¨Ø¯ÛŒÙ„ datetime Ø¨Ù‡ ØªØ§Ø±ÛŒØ® Ùˆ Ø²Ù…Ø§Ù† Ø´Ù…Ø³ÛŒ"""
    if not dt:
        return "-"
    
    try:
        if not isinstance(dt, datetime):
            return str(dt)
        
        if use_timezone and timezone.is_aware(dt):
            dt = timezone.localtime(dt)
        
        j_date = jdatetime.datetime.fromgregorian(datetime=dt)
        
        # Ù¾Ø±Ø¯Ø§Ø²Ø´ Ù†Ø§Ù…â€ŒÙ‡Ø§ÛŒ ÙØ§Ø±Ø³ÛŒ
        if '%B' in format_str or '%A' in format_str:
            result = format_str
            if '%A' in result:
                weekday_name = PERSIAN_WEEKDAY_NAMES.get(j_date.weekday(), '')
                result = result.replace('%A', weekday_name)
            if '%B' in result:
                month_name = PERSIAN_MONTH_NAMES.get(j_date.month, '')
                result = result.replace('%B', month_name)
            # ... Ø¨Ù‚ÛŒÙ‡ Ø¬Ø§ÛŒÚ¯Ø²ÛŒÙ†ÛŒâ€ŒÙ‡Ø§
            result = result.replace('%Y', str(j_date.year))
            result = result.replace('%m', f'{j_date.month:02d}')
            result = result.replace('%d', f'{j_date.day:02d}')
            result = result.replace('%H', f'{j_date.hour:02d}')
            result = result.replace('%M', f'{j_date.minute:02d}')
            result = result.replace('%S', f'{j_date.second:02d}')
            return result
        
        return j_date.strftime(format_str)
        
    except Exception:
        return "-"

def format_jalali_long(dt):
    """
    ÙØ±Ù…Øª Ø·ÙˆÙ„Ø§Ù†ÛŒ ÙØ§Ø±Ø³ÛŒ: Ø¯ÙˆØ´Ù†Ø¨Ù‡ØŒ 07 Ø¯ÛŒ 1403ØŒ Ø³Ø§Ø¹Øª 14:30
    """
    return format_jalali_datetime(
        dt, 
        '%AØŒ %d %B %YØŒ Ø³Ø§Ø¹Øª %H:%M',
        use_timezone=True
    )

def format_jalali_short(dt):
    """ÙØ±Ù…Øª Ú©ÙˆØªØ§Ù‡: 1403/10/07"""
    return format_jalali_date(dt, '%Y/%m/%d')

def format_jalali_medium(dt):
    """ÙØ±Ù…Øª Ù…ØªÙˆØ³Ø·: 07 Ø¯ÛŒ 1403"""
    return format_jalali_date(dt, '%d %B %Y')
```

---

### 2ï¸âƒ£ **Excel Export - Ø¨Ù‡Ø¨ÙˆØ¯Ù‡Ø§**

#### âŒ Ù…Ø´Ú©Ù„Ø§Øª ÙØ¹Ù„ÛŒ:
```python
# ØªØ§Ø±ÛŒØ® Ø¨Ù‡ ØµÙˆØ±Øª string Ù†ÙˆØ´ØªÙ‡ Ù…ÛŒâ€ŒØ´Ù‡ØŒ Ù†Ù‡ datetime ÙˆØ§Ù‚Ø¹ÛŒ
if JDATETIME_AVAILABLE:
    jd = jdatetime.datetime.fromgregorian(datetime=val)
    worksheet.write(row, col, jd.strftime("%Y/%m/%d %H:%M"), data_format)
```

**Ù…Ø´Ú©Ù„Ø§Øª:**
- Excel Ù†Ù…ÛŒâ€ŒØªÙˆÙ†Ù‡ Ø±ÙˆÛŒ ØªØ§Ø±ÛŒØ®â€ŒÙ‡Ø§ ÙÛŒÙ„ØªØ± Ùˆ sort Ø¨Ú¯Ø°Ø§Ø±Ù‡
- Ù†Ù…ÛŒâ€ŒØ´Ù‡ ÙØ±Ù…ÙˆÙ„ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ø±Ø¯

#### âœ… Ø±Ø§Ù‡Ú©Ø§Ø± Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯ÛŒ:

```python
from io import BytesIO
from datetime import datetime
from django.http import HttpResponse
from django.conf import settings
import xlsxwriter
import jdatetime

class BlogExcelExportService:
    """
    Ø¨Ù‡Ø¨ÙˆØ¯ ÛŒØ§ÙØªÙ‡ Ø¨Ø§ Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ú©Ø§Ù…Ù„ ØªØ§Ø±ÛŒØ®â€ŒÙ‡Ø§ÛŒ ÙØ§Ø±Ø³ÛŒ
    """
    
    EXPORT_FIELDS = [
        {'key': 'title', 'label': 'Ø¹Ù†ÙˆØ§Ù†', 'width': 40, 'type': 'text'},
        {'key': 'status', 'label': 'ÙˆØ¶Ø¹ÛŒØª', 'width': 15, 'type': 'text'},
        {'key': 'created_at', 'label': 'ØªØ§Ø±ÛŒØ® Ø§ÛŒØ¬Ø§Ø¯ (Ø´Ù…Ø³ÛŒ)', 'width': 25, 'type': 'jalali_date'},
        {'key': 'updated_at', 'label': 'ØªØ§Ø±ÛŒØ® Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ', 'width': 25, 'type': 'jalali_datetime'},
        {'key': 'categories', 'label': 'Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒâ€ŒÙ‡Ø§', 'width': 30, 'type': 'array'},
        {'key': 'is_featured', 'label': 'ÙˆÛŒÚ˜Ù‡', 'width': 12, 'type': 'boolean'},
    ]

    @staticmethod
    def export_blogs(queryset):
        output = BytesIO()
        workbook = xlsxwriter.Workbook(output, {
            'in_memory': True,
            'default_date_format': 'yyyy-mm-dd hh:mm:ss',
            'remove_timezone': True,
        })
        worksheet = workbook.add_worksheet('ÙˆØ¨Ù„Ø§Ú¯â€ŒÙ‡Ø§')
        
        # âœ… ÙØ±Ù…Øªâ€ŒÙ‡Ø§ÛŒ Ø¨Ù‡Ø¨ÙˆØ¯ ÛŒØ§ÙØªÙ‡
        header_format = workbook.add_format({
            'bold': True,
            'bg_color': '#2563eb',
            'font_color': 'white',
            'align': 'center',
            'valign': 'vcenter',
            'border': 1,
            'text_wrap': True
        })
        
        text_format = workbook.add_format({
            'align': 'right',
            'valign': 'vcenter',
            'border': 1,
            'border_color': '#e2e8f0',
            'text_wrap': True
        })
        
        # âœ… ÙØ±Ù…Øª Ø¬Ø¯ÛŒØ¯ Ø¨Ø±Ø§ÛŒ ØªØ§Ø±ÛŒØ® Ø´Ù…Ø³ÛŒ (Ø¨Ù‡ ØµÙˆØ±Øª text Ø¨Ø§ Ø§Ù…Ú©Ø§Ù† Ø³ÙˆØ±Øª)
        jalali_format = workbook.add_format({
            'align': 'center',
            'valign': 'vcenter',
            'border': 1,
            'border_color': '#e2e8f0',
            'font_color': '#1e40af',
            'num_format': '@'  # Text format
        })
        
        bool_format = workbook.add_format({
            'align': 'center',
            'valign': 'vcenter',
            'border': 1,
            'border_color': '#e2e8f0'
        })
        
        # Ù‡Ø¯Ø±Ù‡Ø§
        for col, field in enumerate(BlogExcelExportService.EXPORT_FIELDS):
            worksheet.write(0, col, field['label'], header_format)
            worksheet.set_column(col, col, field['width'])
        
        # âœ… Ø§ÙØ²ÙˆØ¯Ù† Ø³ØªÙˆÙ† Ù…Ø®ÙÛŒ Ø¨Ø±Ø§ÛŒ sort (ØªØ§Ø±ÛŒØ® Ù…ÛŒÙ„Ø§Ø¯ÛŒ)
        hidden_col = len(BlogExcelExportService.EXPORT_FIELDS)
        worksheet.set_column(hidden_col, hidden_col + 2, None, None, {'hidden': True})
        
        try:
            for row, blog in enumerate(queryset, start=1):
                for col, field in enumerate(BlogExcelExportService.EXPORT_FIELDS):
                    key = field['key']
                    field_type = field.get('type', 'text')
                    val = ""
                    
                    # âœ… Ù¾Ø±Ø¯Ø§Ø²Ø´ Ø¨Ø± Ø§Ø³Ø§Ø³ Ù†ÙˆØ¹
                    if field_type == 'jalali_date':
                        dt = getattr(blog, key, None)
                        if dt and isinstance(dt, datetime):
                            # Ù†Ù…Ø§ÛŒØ´ ÙØ§Ø±Ø³ÛŒ
                            from src.core.utils.date_utils import format_jalali_date
                            val = format_jalali_date(dt, '%Y/%m/%d')
                            worksheet.write(row, col, val, jalali_format)
                            
                            # âœ… Ø³ØªÙˆÙ† Ù…Ø®ÙÛŒ Ø¨Ø±Ø§ÛŒ sort
                            worksheet.write_datetime(row, hidden_col + col, dt, jalali_format)
                        else:
                            worksheet.write(row, col, "-", text_format)
                    
                    elif field_type == 'jalali_datetime':
                        dt = getattr(blog, key, None)
                        if dt and isinstance(dt, datetime):
                            from src.core.utils.date_utils import format_jalali_datetime
                            val = format_jalali_datetime(dt, '%Y/%m/%d %H:%M')
                            worksheet.write(row, col, val, jalali_format)
                            worksheet.write_datetime(row, hidden_col + col, dt, jalali_format)
                        else:
                            worksheet.write(row, col, "-", text_format)
                    
                    elif field_type == 'boolean':
                        val = "âœ“" if getattr(blog, key, False) else "âœ—"
                        worksheet.write(row, col, val, bool_format)
                    
                    elif field_type == 'array':
                        if key == 'categories':
                            val = ", ".join([c.name for c in blog.categories.all()])
                        elif key == 'tags':
                            val = ", ".join([t.name for t in blog.tags.all()])
                        worksheet.write(row, col, val, text_format)
                    
                    else:  # text
                        val = getattr(blog, key, "")
                        if key == 'status':
                            status_map = {
                                'published': 'âœ… Ù…Ù†ØªØ´Ø± Ø´Ø¯Ù‡',
                                'draft': 'ğŸ“ Ù¾ÛŒØ´â€ŒÙ†ÙˆÛŒØ³',
                                'archived': 'ğŸ“¦ Ø¢Ø±Ø´ÛŒÙˆ'
                            }
                            val = status_map.get(val, val)
                        worksheet.write(row, col, val, text_format)
            
            # âœ… Freeze panes Ùˆ Auto-filter
            worksheet.freeze_panes(1, 0)
            worksheet.autofilter(0, 0, row, len(BlogExcelExportService.EXPORT_FIELDS) - 1)
            
            # âœ… Ø§ÙØ²ÙˆØ¯Ù† Summary Ø¯Ø± Ø§Ù†ØªÙ‡Ø§
            summary_row = row + 2
            worksheet.write(summary_row, 0, 'ØªØ¹Ø¯Ø§Ø¯ Ú©Ù„:', header_format)
            worksheet.write(summary_row, 1, row, text_format)
            
        finally:
            workbook.close()
        
        output.seek(0)
        response = HttpResponse(
            output.getvalue(),
            content_type='application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'
        )
        
        # âœ… Ù†Ø§Ù… ÙØ§ÛŒÙ„ ÙØ§Ø±Ø³ÛŒ
        from src.core.utils.date_utils import format_jalali_short
        filename = f"Ú¯Ø²Ø§Ø±Ø´_ÙˆØ¨Ù„Ø§Ú¯_{format_jalali_short(datetime.now())}.xlsx"
        response['Content-Disposition'] = f'attachment; filename="{filename}"'
        
        return response
```

---

### 3ï¸âƒ£ **PDF Export - Ø¨Ù‡Ø¨ÙˆØ¯Ù‡Ø§**

#### âŒ Ù…Ø´Ú©Ù„Ø§Øª ÙØ¹Ù„ÛŒ:
```python
# RTL processing basic
@staticmethod
def _process_rtl(text):
    if ARABIC_RESHAPER_AVAILABLE:
        reshaped = arabic_reshaper.reshape(str(text))
        return get_display(reshaped)
    return str(text)
```

**Ù…Ø´Ú©Ù„Ø§Øª:**
- ReportLab 4.4+ Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ø¨ÙˆÙ…ÛŒ RTL Ø¯Ø§Ø±Ù‡ Ú©Ù‡ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù†Ù…ÛŒâ€ŒÚ©Ù†ÛŒØ¯
- Font fallback strategy Ø¶Ø¹ÛŒÙ
- Ø¹Ø¯Ù… Ú©Ø´ Ø¨Ø±Ø§ÛŒ RTL processing

#### âœ… Ø±Ø§Ù‡Ú©Ø§Ø± Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯ÛŒ:

**Ø§Ù„Ù) Ø¢Ù¾Ø¯ÛŒØª ReportLab:**
```bash
pip install reportlab>=4.4.0
```

**Ø¨) Ø¨Ù‡Ø¨ÙˆØ¯ PDF Services:**

```python
from io import BytesIO
from datetime import datetime
import os
import platform
from functools import lru_cache
from django.http import HttpResponse
from django.conf import settings
from django.core.cache import cache

try:
    import arabic_reshaper
    from bidi.algorithm import get_display
    ARABIC_RESHAPER_AVAILABLE = True
except ImportError:
    ARABIC_RESHAPER_AVAILABLE = False

try:
    from reportlab.lib import colors
    from reportlab.lib.pagesizes import A4
    from reportlab.lib.styles import getSampleStyleSheet, ParagraphStyle
    from reportlab.lib.units import inch
    from reportlab.platypus import SimpleDocTemplate, Paragraph, Spacer, Table, TableStyle
    from reportlab.pdfbase import pdfmetrics
    from reportlab.pdfbase.ttfonts import TTFont
    REPORTLAB_AVAILABLE = True
except ImportError:
    REPORTLAB_AVAILABLE = False

from src.core.utils.date_utils import format_jalali_date, format_jalali_long

class BlogPDFExportService:
    """
    Ø¨Ù‡Ø¨ÙˆØ¯ ÛŒØ§ÙØªÙ‡ Ø¨Ø§ RTL Ú©Ø§Ù…Ù„ Ùˆ ÙÙˆÙ†Øªâ€ŒÙ‡Ø§ÛŒ Ø¨Ù‡ÛŒÙ†Ù‡
    """
    
    PRIMARY_COLOR = colors.HexColor('#2563eb') if REPORTLAB_AVAILABLE else None
    
    # âœ… Ù„ÛŒØ³Øª Ø§ÙˆÙ„ÙˆÛŒØª ÙÙˆÙ†Øªâ€ŒÙ‡Ø§
    FONT_PATHS = [
        # ÙÙˆÙ†Øªâ€ŒÙ‡Ø§ÛŒ Ù¾Ø±ÙˆÚ˜Ù‡
        ('IRANSansX', 'static/fonts/IRANSansXVF.ttf'),
        ('Vazirmatn', 'static/fonts/Vazirmatn-RD-FD-Regular.ttf'),
        ('Vazir', 'static/fonts/Vazir.ttf'),
        # ÙÙˆÙ†Øªâ€ŒÙ‡Ø§ÛŒ Ø³ÛŒØ³ØªÙ… - Windows
        ('Tahoma', r'C:\Windows\Fonts\Tahoma.ttf'),
        ('Arial', r'C:\Windows\Fonts\Arial.ttf'),
        # ÙÙˆÙ†Øªâ€ŒÙ‡Ø§ÛŒ Ø³ÛŒØ³ØªÙ… - Linux
        ('DejaVuSans', '/usr/share/fonts/truetype/dejavu/DejaVuSans.ttf'),
        ('FreeSerif', '/usr/share/fonts/truetype/freefont/FreeSerif.ttf'),
    ]
    
    @staticmethod
    @lru_cache(maxsize=1)
    def _register_persian_font():
        """
        Ø«Ø¨Øª ÙÙˆÙ†Øª ÙØ§Ø±Ø³ÛŒ Ø¨Ø§ Ø§Ø³ØªØ±Ø§ØªÚ˜ÛŒ Fallback Ø¨Ù‡ÛŒÙ†Ù‡
        """
        if not REPORTLAB_AVAILABLE:
            return 'Helvetica'
        
        # Ú†Ú© Ú©Ø±Ø¯Ù† cache
        cached_font = cache.get('pdf_persian_font')
        if cached_font:
            return cached_font
        
        base_dir = str(settings.BASE_DIR)
        
        for font_name, font_path in BlogPDFExportService.FONT_PATHS:
            # Ø§Ú¯Ø± path Ù†Ø³Ø¨ÛŒ Ø§Ø³Øª
            if not os.path.isabs(font_path):
                font_path = os.path.join(base_dir, font_path)
            
            if os.path.exists(font_path):
                try:
                    pdfmetrics.registerFont(TTFont(font_name, font_path))
                    cache.set('pdf_persian_font', font_name, 3600 * 24)  # 24 Ø³Ø§Ø¹Øª
                    return font_name
                except Exception as e:
                    continue
        
        # Fallback Ù†Ù‡Ø§ÛŒÛŒ
        return 'Helvetica'
    
    @staticmethod
    @lru_cache(maxsize=256)
    def _process_rtl(text):
        """
        Ù¾Ø±Ø¯Ø§Ø²Ø´ RTL Ø¨Ø§ Ú©Ø´ Ø¨Ø±Ø§ÛŒ Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ
        """
        if not text:
            return ""
        
        if ARABIC_RESHAPER_AVAILABLE:
            try:
                reshaped = arabic_reshaper.reshape(str(text))
                return get_display(reshaped)
            except:
                pass
        
        return str(text)
    
    @staticmethod
    def export_blog_pdf(blog):
        """
        Ø®Ø±ÙˆØ¬ÛŒ PDF ØªÚ© Ù…Ù‚Ø§Ù„Ù‡ Ø¨Ø§ ØªØ§Ø±ÛŒØ®â€ŒÙ‡Ø§ÛŒ ÙØ§Ø±Ø³ÛŒ Ú©Ø§Ù…Ù„
        """
        if not REPORTLAB_AVAILABLE:
            raise ImportError("ReportLab not installed")
        
        buffer = BytesIO()
        font_name = BlogPDFExportService._register_persian_font()
        rtl = BlogPDFExportService._process_rtl
        
        # âœ… Status mapping with icons
        status_map = {
            'published': 'âœ… Ù…Ù†ØªØ´Ø± Ø´Ø¯Ù‡',
            'draft': 'ğŸ“ Ù¾ÛŒØ´â€ŒÙ†ÙˆÛŒØ³',
            'archived': 'ğŸ“¦ Ø¢Ø±Ø´ÛŒÙˆ'
        }
        
        doc = SimpleDocTemplate(
            buffer,
            pagesize=A4,
            rightMargin=40,
            leftMargin=40,
            topMargin=50,
            bottomMargin=50,
            title=rtl(blog.title)
        )
        
        elements = []
        styles = getSampleStyleSheet()
        
        # âœ… Styles Ø¨Ù‡Ø¨ÙˆØ¯ ÛŒØ§ÙØªÙ‡
        title_style = ParagraphStyle(
            'BlogTitle',
            parent=styles['Heading1'],
            fontName=font_name,
            fontSize=24,
            alignment=2,  # Right align
            textColor=BlogPDFExportService.PRIMARY_COLOR,
            spaceAfter=20
        )
        
        section_style = ParagraphStyle(
            'SectionHeader',
            parent=styles['Heading3'],
            fontName=font_name,
            fontSize=14,
            alignment=2,
            textColor=BlogPDFExportService.PRIMARY_COLOR,
            spaceBefore=15,
            spaceAfter=10
        )
        
        content_style = ParagraphStyle(
            'BodyContent',
            parent=styles['Normal'],
            fontName=font_name,
            fontSize=11,
            leading=20,
            alignment=2,  # Right align
            rightIndent=10,
            leftIndent=10
        )
        
        # Ø¹Ù†ÙˆØ§Ù†
        elements.append(Paragraph(rtl(blog.title), title_style))
        elements.append(Spacer(1, 10))
        
        # âœ… Metadata Ø¨Ø§ ØªØ§Ø±ÛŒØ®â€ŒÙ‡Ø§ÛŒ ÙØ§Ø±Ø³ÛŒ Ú©Ø§Ù…Ù„
        meta_data = [
            [rtl('Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ:'), rtl(", ".join([c.name for c in blog.categories.all()[:3]]))],
            [rtl('ØªØ§Ø±ÛŒØ® Ø§Ù†ØªØ´Ø§Ø±:'), rtl(format_jalali_long(blog.created_at))],
            [rtl('Ø¢Ø®Ø±ÛŒÙ† Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ:'), rtl(format_jalali_medium(blog.updated_at))],
            [rtl('ÙˆØ¶Ø¹ÛŒØª:'), rtl(status_map.get(blog.status, blog.status))],
            [rtl('Ù†ÙˆÛŒØ³Ù†Ø¯Ù‡:'), rtl(blog.created_by.get_full_name() if blog.created_by else '-')],
        ]
        
        meta_table = Table(meta_data, colWidths=[2*inch, 4*inch])
        meta_table.setStyle(TableStyle([
            ('FONTNAME', (0, 0), (-1, -1), font_name),
            ('FONTSIZE', (0, 0), (-1, -1), 10),
            ('ALIGN', (0, 0), (0, -1), 'RIGHT'),
            ('ALIGN', (1, 0), (1, -1), 'RIGHT'),
            ('TEXTCOLOR', (0, 0), (0, -1), BlogPDFExportService.PRIMARY_COLOR),
            ('GRID', (0, 0), (-1, -1), 0.5, colors.grey),
            ('BACKGROUND', (0, 0), (0, -1), BlogPDFExportService.LIGHT_BG),
            ('PADDING', (0, 0), (-1, -1), 8),
        ]))
        
        elements.append(meta_table)
        elements.append(Spacer(1, 20))
        
        # Ù…Ø­ØªÙˆØ§
        if blog.short_description:
            elements.append(Paragraph(rtl('Ø®Ù„Ø§ØµÙ‡:'), section_style))
            elements.append(Paragraph(rtl(blog.short_description), content_style))
            elements.append(Spacer(1, 15))
        
        if blog.description:
            elements.append(Paragraph(rtl('Ù…ØªÙ† Ú©Ø§Ù…Ù„:'), section_style))
            desc_text = blog.description.replace("\\n", "<br/>")
            elements.append(Paragraph(rtl(desc_text), content_style))
        
        # âœ… Footer Ø¨Ø§ ØªØ§Ø±ÛŒØ®
        def add_header_footer(canvas, doc):
            canvas.saveState()
            canvas.setFont(font_name, 9)
            canvas.setFillColor(colors.grey)
            
            # Footer
            footer_text = rtl(f"ØªØ§Ø±ÛŒØ® ØªÙˆÙ„ÛŒØ¯: {format_jalali_long(datetime.now())} | ØµÙØ­Ù‡ {doc.page}")
            canvas.drawCentredString(doc.pagesize[0]/2, 30, footer_text)
            
            canvas.restoreState()
        
        doc.build(elements, onFirstPage=add_header_footer, onLaterPages=add_header_footer)
        
        buffer.seek(0)
        response = HttpResponse(buffer.getvalue(), content_type='application/pdf')
        
        # âœ… Ù†Ø§Ù… ÙØ§ÛŒÙ„ ÙØ§Ø±Ø³ÛŒ
        filename = f"Ù…Ù‚Ø§Ù„Ù‡_{blog.id}_{format_jalali_short(datetime.now())}.pdf"
        response['Content-Disposition'] = f'attachment; filename="{filename}"'
        
        return response
```

---

### 4ï¸âƒ£ **Print View - Ø¨Ù‡Ø¨ÙˆØ¯Ù‡Ø§**

#### âŒ Ù…Ø´Ú©Ù„Ø§Øª ÙØ¹Ù„ÛŒ:
- Ø®ÛŒÙ„ÛŒ Ø³Ø§Ø¯Ù‡
- Ø¨Ø¯ÙˆÙ† Ø§Ø³ØªØ§ÛŒÙ„ Ù‚ÙˆÛŒ
- Ø¨Ø¯ÙˆÙ† ØªØ§Ø±ÛŒØ®â€ŒÙ‡Ø§ÛŒ Ú©Ø§Ù…Ù„ ÙØ§Ø±Ø³ÛŒ

#### âœ… Ø±Ø§Ù‡Ú©Ø§Ø± Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯ÛŒ:

```python
from django.http import HttpResponse
from django.utils import timezone
from src.core.utils.date_utils import format_jalali_long, format_jalali_medium

class BlogPrintListExportService:
    """
    Ø¨Ù‡Ø¨ÙˆØ¯ ÛŒØ§ÙØªÙ‡ Ø¨Ø§ Ø§Ø³ØªØ§ÛŒÙ„ Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ Ùˆ ØªØ§Ø±ÛŒØ®â€ŒÙ‡Ø§ÛŒ Ú©Ø§Ù…Ù„
    """
    
    @staticmethod
    def _get_css():
        return """
        <style>
            @import url('https://cdn.jsdelivr.net/gh/rastikerdar/vazirmatn@v33.003/Vazirmatn-font-face.css');
            
            * {
                margin: 0;
                padding: 0;
                box-sizing: border-box;
            }
            
            :root {
                --primary-color: #2563eb;
                --primary-dark: #1e40af;
                --text-primary: #0f172a;
                --text-secondary: #475569;
                --border-color: #e2e8f0;
                --bg-light: #f8fafc;
                --bg-white: #ffffff;
                --success: #10b981;
                --warning: #f59e0b;
                --danger: #ef4444;
            }
            
            body {
                font-family: 'Vazirmatn', 'Tahoma', sans-serif;
                direction: rtl;
                margin: 20px;
                color: var(--text-primary);
                font-size: 12pt;
                line-height: 1.6;
                background: var(--bg-white);
            }
            
            .header {
                text-align: center;
                margin-bottom: 40px;
                padding: 30px 20px;
                border-bottom: 3px solid var(--primary-color);
                background: linear-gradient(135deg, var(--bg-light) 0%, var(--bg-white) 100%);
                border-radius: 8px;
            }
            
            .header h1 {
                margin: 0 0 15px 0;
                color: var(--primary-color);
                font-size: 28pt;
                font-weight: 700;
            }
            
            .meta-info {
                display: flex;
                justify-content: center;
                gap: 30px;
                margin-top: 15px;
                font-size: 11pt;
                color: var(--text-secondary);
                flex-wrap: wrap;
            }
            
            .meta-item {
                display: flex;
                align-items: center;
                gap: 8px;
            }
            
            .meta-item strong {
                color: var(--primary-dark);
            }
            
            table {
                width: 100%;
                border-collapse: collapse;
                margin: 30px 0;
                font-size: 11pt;
                box-shadow: 0 2px 8px rgba(0,0,0,0.1);
                border-radius: 8px;
                overflow: hidden;
            }
            
            thead {
                background: var(--primary-color);
                color: white;
            }
            
            th {
                padding: 16px 12px;
                text-align: right;
                font-weight: 700;
                font-size: 11pt;
                border-left: 1px solid rgba(255,255,255,0.2);
            }
            
            th:last-child {
                border-left: none;
            }
            
            td {
                padding: 14px 12px;
                text-align: right;
                border: 1px solid var(--border-color);
                vertical-align: middle;
            }
            
            tbody tr {
                transition: background-color 0.2s;
            }
            
            tbody tr:nth-child(even) {
                background-color: var(--bg-light);
            }
            
            tbody tr:hover {
                background-color: #e0f2fe;
            }
            
            .status-badge {
                display: inline-block;
                padding: 6px 12px;
                border-radius: 6px;
                font-size: 10pt;
                font-weight: 600;
                text-align: center;
            }
            
            .status-published {
                background: #d1fae5;
                color: #065f46;
            }
            
            .status-draft {
                background: #fef3c7;
                color: #92400e;
            }
            
            .status-archived {
                background: #e5e7eb;
                color: #374151;
            }
            
            .footer-info {
                text-align: center;
                margin-top: 40px;
                padding-top: 20px;
                border-top: 2px solid var(--border-color);
                color: var(--text-secondary);
                font-size: 10pt;
            }
            
            .footer-info .count {
                font-size: 14pt;
                font-weight: 700;
                color: var(--primary-color);
                margin: 0 5px;
            }
            
            @media print {
                body {
                    margin: 0;
                    padding: 15px;
                }
                
                .no-print {
                    display: none !important;
                }
                
                .header {
                    break-after: avoid;
                }
                
                table {
                    page-break-inside: auto;
                }
                
                tr {
                    page-break-inside: avoid;
                    page-break-after: auto;
                }
                
                thead {
                    display: table-header-group;
                }
                
                tbody {
                    display: table-row-group;
                }
                
                .status-badge {
                    border: 1px solid #ccc;
                }
                
                a {
                    text-decoration: none;
                    color: inherit;
                }
            }
        </style>
        """
    
    @staticmethod
    def export_blogs_print(queryset):
        """
        ØªÙˆÙ„ÛŒØ¯ HTML Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ Ø¨Ø±Ø§ÛŒ Ú†Ø§Ù¾
        """
        html_content = [
            "<!DOCTYPE html>",
            "<html lang='fa' dir='rtl'>",
            "<head>",
            "<meta charset='UTF-8'>",
            "<meta name='viewport' content='width=device-width, initial-scale=1.0'>",
            "<title>Ú¯Ø²Ø§Ø±Ø´ ÙˆØ¨Ù„Ø§Ú¯â€ŒÙ‡Ø§</title>",
            BlogPrintListExportService._get_css(),
            "</head>",
            "<body>",
            
            # Ø¯Ú©Ù…Ù‡ Ú†Ø§Ù¾
            "<div class='no-print' style='margin-bottom: 20px; text-align: left;'>",
            "<button onclick='window.print()' style='padding: 12px 24px; background: var(--primary-color); color: white; border: none; border-radius: 8px; cursor: pointer; font-family: inherit; font-size: 12pt; font-weight: 600; box-shadow: 0 2px 4px rgba(0,0,0,0.1); transition: all 0.3s;'>",
            "ğŸ–¨ï¸ Ú†Ø§Ù¾ Ú¯Ø²Ø§Ø±Ø´",
            "</button>",
            "</div>",
            
            # Ù‡Ø¯Ø±
            "<div class='header'>",
            "<h1>ğŸ“Š Ú¯Ø²Ø§Ø±Ø´ Ø¬Ø§Ù…Ø¹ ÙˆØ¨Ù„Ø§Ú¯â€ŒÙ‡Ø§</h1>",
            "<div class='meta-info'>",
            f"<div class='meta-item'><strong>ØªØ§Ø±ÛŒØ® Ú¯Ø²Ø§Ø±Ø´:</strong> <span>{format_jalali_long(timezone.now())}</span></div>",
            f"<div class='meta-item'><strong>ØªØ¹Ø¯Ø§Ø¯ Ø±Ú©ÙˆØ±Ø¯Ù‡Ø§:</strong> <span>{queryset.count()}</span></div>",
            "</div>",
            "</div>",
            
            # Ø¬Ø¯ÙˆÙ„
            "<table>",
            "<thead>",
            "<tr>",
            "<th style='width: 5%;'>#</th>",
            "<th style='width: 30%;'>Ø¹Ù†ÙˆØ§Ù†</th>",
            "<th style='width: 12%;'>ÙˆØ¶Ø¹ÛŒØª</th>",
            "<th style='width: 20%;'>Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ</th>",
            "<th style='width: 18%;'>ØªØ§Ø±ÛŒØ® Ø§ÛŒØ¬Ø§Ø¯</th>",
            "<th style='width: 15%;'>ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§</th>",
            "</tr>",
            "</thead>",
            "<tbody>"
        ]
        
        # Ø±Ø¯ÛŒÙâ€ŒÙ‡Ø§ÛŒ Ø¯Ø§Ø¯Ù‡
        for idx, blog in enumerate(queryset, start=1):
            # Status
            status_classes = {
                'published': 'status-published',
                'draft': 'status-draft',
                'archived': 'status-archived'
            }
            status_texts = {
                'published': 'âœ… Ù…Ù†ØªØ´Ø± Ø´Ø¯Ù‡',
                'draft': 'ğŸ“ Ù¾ÛŒØ´â€ŒÙ†ÙˆÛŒØ³',
                'archived': 'ğŸ“¦ Ø¢Ø±Ø´ÛŒÙˆ'
            }
            
            status_class = status_classes.get(blog.status, 'status-draft')
            status_text = status_texts.get(blog.status, blog.status)
            
            # Categories
            categories = ", ".join([c.name for c in blog.categories.all()[:3]])
            if blog.categories.count() > 3:
                categories += " ..."
            
            # Features
            features = []
            if blog.is_featured:
                features.append("â­ ÙˆÛŒÚ˜Ù‡")
            if blog.is_public:
                features.append("ğŸŒ Ø¹Ù…ÙˆÙ…ÛŒ")
            features_text = " | ".join(features) if features else "-"
            
            html_content.append(f"""
            <tr>
                <td style="text-align: center; font-weight: 700; color: var(--primary-color);">{idx}</td>
                <td><strong>{blog.title}</strong></td>
                <td style="text-align: center;">
                    <span class="status-badge {status_class}">{status_text}</span>
                </td>
                <td>{categories or '-'}</td>
                <td style="direction: ltr; text-align: center; font-family: monospace;">
                    {format_jalali_medium(blog.created_at)}
                </td>
                <td style="text-align: center;">{features_text}</td>
            </tr>
            """)
        
        html_content.extend([
            "</tbody>",
            "</table>",
            
            # Footer
            "<div class='footer-info'>",
            "<p>",
            "ØªØ¹Ø¯Ø§Ø¯ Ú©Ù„ Ø±Ú©ÙˆØ±Ø¯Ù‡Ø§: <span class='count'>" + str(queryset.count()) + "</span>",
            "</p>",
            f"<p style='margin-top: 10px; font-size: 9pt;'>ØªØ§Ø±ÛŒØ® ØªÙˆÙ„ÛŒØ¯: {format_jalali_long(timezone.now())}</p>",
            "</div>",
            
            "</body>",
            "</html>"
        ])
        
        return HttpResponse("".join(html_content), content_type="text/html; charset=utf-8")
```

---

## ğŸ“š Ù†Ú©Ø§Øª Ù…Ù‡Ù… Ùˆ Best Practices:

### 1. **ØªÙ†Ø¸ÛŒÙ…Ø§Øª Django (settings.py):**

```python
# settings.py

# ØªÙ†Ø¸ÛŒÙ…Ø§Øª Jalali
JALALI_LOCALE = 'fa_IR.UTF-8'  # Ø¨Ø±Ø§ÛŒ Linux
# ÛŒØ§
JALALI_LOCALE = 'Persian_Iran.UTF-8'  # Ø¨Ø±Ø§ÛŒ Windows

# Ø­Ø¯Ø§Ú©Ø«Ø± ØªØ¹Ø¯Ø§Ø¯ Ø±Ú©ÙˆØ±Ø¯ Ø¨Ø±Ø§ÛŒ Export
BLOG_EXPORT_MAX_ITEMS = 10000
BLOG_EXPORT_RATE_LIMIT = 10
BLOG_EXPORT_RATE_LIMIT_WINDOW = 3600  # 1 hour

# Ù…Ø³ÛŒØ± ÙÙˆÙ†Øªâ€ŒÙ‡Ø§ÛŒ ÙØ§Ø±Ø³ÛŒ
PERSIAN_FONTS = {
    'iran_sans': 'static/fonts/IRANSansXVF.ttf',
    'vazir': 'static/fonts/Vazir.ttf',
}
```

### 2. **Cache Strategy:**

```python
# Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Cache Ø¨Ø±Ø§ÛŒ Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ
from django.core.cache import cache

# Ú©Ø´ Ú©Ø±Ø¯Ù† Ù†ØªØ§ÛŒØ¬ RTL processing
@lru_cache(maxsize=512)
def process_rtl_text(text):
    # ...
    pass

# Ú©Ø´ Ú©Ø±Ø¯Ù† ÙÙˆÙ†Øª Ø«Ø¨Øª Ø´Ø¯Ù‡
cache.set('pdf_persian_font', font_name, 86400)  # 24 hours
```

### 3. **Error Handling:**

```python
# Ù‡Ù…ÛŒØ´Ù‡ try-except Ø¨Ø±Ø§ÛŒ Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø§Ø² crash
try:
    return format_jalali_date(dt)
except Exception as e:
    logger.error(f"Jalali date conversion failed: {e}")
    return "-"
```

### 4. **Performance:**

- Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² `select_related` Ùˆ `prefetch_related`
- Pagination Ø¨Ø±Ø§ÛŒ Export Ù‡Ø§ÛŒ Ø¨Ø²Ø±Ú¯
- Rate Limiting Ø¨Ø±Ø§ÛŒ Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø§Ø² Abuse
- Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² `BytesIO` Ø¨Ù‡ Ø¬Ø§ÛŒ ÙØ§ÛŒÙ„ Ù…ÙˆÙ‚Øª

---

## ğŸ¯ Ù†ØªÛŒØ¬Ù‡â€ŒÚ¯ÛŒØ±ÛŒ:

âœ… **Ù†Ù‚Ø§Ø· Ù‚ÙˆØª Ú©Ø¯ ÙØ¹Ù„ÛŒ:**
- Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ú©ØªØ§Ø¨Ø®Ø§Ù†Ù‡â€ŒÙ‡Ø§ÛŒ Ø§Ø³ØªØ§Ù†Ø¯Ø§Ø±Ø¯
- Ø³Ø§Ø®ØªØ§Ø± Ø³Ø±ÙˆÛŒØ³â€ŒÙ…Ø­ÙˆØ± Ø®ÙˆØ¨
- Ø¬Ø¯Ø§Ø³Ø§Ø²ÛŒ concerns

âŒ **Ù†Ù‚Ø§Ø· Ø¶Ø¹Ù Ú©Ù‡ Ø¨Ø§ÛŒØ¯ Ø±ÙØ¹ Ø´ÙˆÙ†Ø¯:**
- ØªØ§Ø±ÛŒØ®â€ŒÙ‡Ø§ÛŒ ÙØ§Ø±Ø³ÛŒ Ù†Ø§Ù‚Øµ
- Font fallback strategy Ø¶Ø¹ÛŒÙ
- Ø¹Ø¯Ù… Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Cache
- Print view Ø®ÛŒÙ„ÛŒ Ø³Ø§Ø¯Ù‡

ğŸš€ **Ø§ÙˆÙ„ÙˆÛŒØª Ù¾ÛŒØ§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ:**
1. Ø¨Ù‡Ø¨ÙˆØ¯ `date_utils.py` (Ø¨Ø§Ù„Ø§ØªØ±ÛŒÙ† Ø§ÙˆÙ„ÙˆÛŒØª)
2. Ø¨Ù‡Ø¨ÙˆØ¯ Excel Export
3. Ø¨Ù‡Ø¨ÙˆØ¯ PDF Services
4. Ø¨Ù‡Ø¨ÙˆØ¯ Print View

---

## ğŸ“¦ Requirements Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø´Ø¯Ù‡:

```txt
# Date & Time
jdatetime>=4.1.0
pytz>=2023.3

# Excel Export
xlsxwriter>=3.1.9

# PDF Export
reportlab>=4.4.0
Pillow>=10.0.0

# RTL Support (Ø§Ú¯Ø± ReportLab < 4.4)
arabic-reshaper>=3.0.0
python-bidi>=0.4.2

# Django
django>=4.2
django-filter>=23.0
djangorestframework>=3.14
```

Ø§ÛŒÙ† Ø±Ø§Ù‡Ú©Ø§Ø±Ù‡Ø§ Ø¨Ø± Ø§Ø³Ø§Ø³ Ø¨Ù‡ØªØ±ÛŒÙ† practices Ø³Ø§Ù„ 2025 Ùˆ ØªØ¬Ø±Ø¨ÛŒØ§Øª ÙˆØ§Ù‚Ø¹ÛŒ Ù¾Ø±ÙˆÚ˜Ù‡â€ŒÙ‡Ø§ÛŒ production Ù‡Ø³ØªÙ†Ø¯.


âŒ Ù…Ø´Ú©Ù„Ø§Øª Ø§ØµÙ„ÛŒ:

ØªØ§Ø±ÛŒØ®â€ŒÙ‡Ø§ÛŒ ÙØ§Ø±Ø³ÛŒ:

ÙÙ‚Ø· ÙØ±Ù…Øªâ€ŒÙ‡Ø§ÛŒ Ù…Ø­Ø¯ÙˆØ¯ Ø¯Ø§Ø±ÛŒØ¯
Ù†Ø§Ù… Ù…Ø§Ù‡â€ŒÙ‡Ø§ÛŒ ÙØ§Ø±Ø³ÛŒ Ù†ÛŒØ³Øª
Ø¨Ø¯ÙˆÙ† timezone handling
Ø¨Ø¯ÙˆÙ† cache


Excel Export:

ØªØ§Ø±ÛŒØ®â€ŒÙ‡Ø§ string Ù‡Ø³ØªÙ†ØŒ Ù†Ù‡ datetime ÙˆØ§Ù‚Ø¹ÛŒ
Ù†Ù…ÛŒâ€ŒØ´Ù‡ Ø±ÙˆØ´ÙˆÙ† sort/filter Ú©Ø±Ø¯


PDF Export:

Font fallback strategy Ø¶Ø¹ÛŒÙÙ‡
ReportLab 4.4+ Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ø¨ÙˆÙ…ÛŒ RTL Ø¯Ø§Ø±Ù‡ Ú©Ù‡ Ø§Ø²Ø´ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù†Ù…ÛŒâ€ŒÚ©Ù†ÛŒØ¯
Ø¨Ø¯ÙˆÙ† cache Ø¨Ø±Ø§ÛŒ RTL processing


Print View:

Ø®ÛŒÙ„ÛŒ Ø³Ø§Ø¯Ø³ØŒ Ø§Ø³ØªØ§ÛŒÙ„ Ø¶Ø¹ÛŒÙ



ğŸ¯ Ø¨Ù‡ØªØ±ÛŒÙ† Ø±Ø§Ù‡Ú©Ø§Ø± (Best Practice 2025):
Ù…Ù† ÛŒÚ© ÙØ§ÛŒÙ„ Ø¬Ø§Ù…Ø¹ Ø¨Ø§ ØªÙ…Ø§Ù… Ø¨Ù‡Ø¨ÙˆØ¯Ù‡Ø§ Ø¨Ø±Ø§ØªÙˆÙ† Ø¢Ù…Ø§Ø¯Ù‡ Ú©Ø±Ø¯Ù… Ú©Ù‡ Ø´Ø§Ù…Ù„:

âœ… date_utils.py Ú©Ø§Ù…Ù„ Ø´Ø¯Ù‡ Ø¨Ø§ Ù†Ø§Ù… Ù…Ø§Ù‡â€ŒÙ‡Ø§ÛŒ ÙØ§Ø±Ø³ÛŒ
âœ… Excel Export Ø¨Ø§ ØªØ§Ø±ÛŒØ®â€ŒÙ‡Ø§ÛŒ Ù‚Ø§Ø¨Ù„ sort
âœ… PDF Ø¨Ø§ RTL Ú©Ø§Ù…Ù„ Ùˆ font fallback Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ
âœ… Print View Ø¨Ø§ Ø§Ø³ØªØ§ÛŒÙ„ Ù…Ø¯Ø±Ù† Ùˆ Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ
âœ… Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Cache Ø¨Ø±Ø§ÛŒ Performance
âœ… Error Handling Ú©Ø§Ù…Ù„

Ø§ÙˆÙ„ÙˆÛŒØª Ù¾ÛŒØ§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ:

Ø§ÙˆÙ„ date_utils.py Ø±Ùˆ Ø¨Ù‡Ø¨ÙˆØ¯ Ø¨Ø¯ÛŒØ¯
Ø¨Ø¹Ø¯ Excel Export
Ø¨Ø¹Ø¯ PDF Services
Ø¢Ø®Ø± Print View



Ø®Ù„Ø§ØµÙ‡ Ùˆ Ù†ØªÛŒØ¬Ù‡â€ŒÚ¯ÛŒØ±ÛŒ ğŸ¯
Ø­Ù‚ Ø¨Ø§ Ø´Ù…Ø§ Ø¨ÙˆØ¯! Ø¨Ø°Ø§Ø±ÛŒØ¯ Ø®Ù„Ø§ØµÙ‡ Ú©Ù†Ù…:
âŒ Ù…Ø´Ú©Ù„ Ø§ØµÙ„ÛŒ Ú©Ø¯ ÙØ¹Ù„ÛŒ:
Print view Ø¨Ø§ HTML/CSS Ø¯Ø± Ø¨Ú©â€ŒØ§Ù†Ø¯ = Anti-Pattern Ø¯Ø± 2025!
Ú†Ø±Ø§ Ø¨Ø¯ Ø§Ø³ØªØŸ

UI Ø¯Ø± Backend â†’ Mixing Concerns
Ù†Ù…ÛŒâ€ŒØªÙˆÙ†ÛŒØ¯ Ø§Ø² Tailwind/Component Library Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯
Hot Reload Ù†Ø¯Ø§Ø±ÛŒØ¯
Testing Ø³Ø®Øª Ø§Ø³Øª
Maintenance Ú©Ø§Ø¨ÙˆØ³ Ù…ÛŒâ€ŒØ´Ù‡

âœ… Ø¨Ù‡ØªØ±ÛŒÙ† Ø±ÙˆÛŒÚ©Ø±Ø¯ (Hybrid Strategy):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     Frontend (Next.js)          â”‚
â”‚  âœ… Print View                  â”‚
â”‚  âœ… Excel < 5k rows             â”‚
â”‚  âœ… PDF Simple                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ API call for large data
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     Backend (Django)            â”‚
â”‚  âœ… Excel > 5k rows             â”‚
â”‚  âœ… PDF Complex/RTL             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
ğŸ¯ ØªÙˆØµÛŒÙ‡ Ù†Ù‡Ø§ÛŒÛŒ:
Ø¨Ø§ÛŒØ¯ Ø§Ù†Ø¬Ø§Ù… Ø¨Ø´Ù‡:

âœ… Print View â†’ Ø­Ø°Ù Ø§Ø² BackendØŒ Ù¾ÛŒØ§Ø¯Ù‡ Ø¯Ø± Next.js Ø¨Ø§ @media print
âœ… Excel Small â†’ Client-side Ø¨Ø§ xlsx library
âœ… PDF Preview â†’ Client-side Ø¨Ø§ @react-pdf/renderer

Ù…ÛŒâ€ŒØªÙˆÙ†Ù‡ Ø¨Ù…ÙˆÙ†Ù‡:

âš ï¸ Excel Large (> 5000 rows) â†’ Backend (xlsxwriter)
âš ï¸ PDF Complex/RTL â†’ Backend (ReportLab)

ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ú©Ø§Ù…Ù„ÛŒ Ú©Ù‡ Ø¨Ø±Ø§ØªÙˆÙ† Ø¢Ù…Ø§Ø¯Ù‡ Ú©Ø±Ø¯Ù… Ø´Ø§Ù…Ù„:

ØªØ­Ù„ÛŒÙ„ Ù…Ù‚Ø§ÛŒØ³Ù‡â€ŒØ§ÛŒ Ú©Ø§Ù…Ù„ Client vs Server
Ú©Ø¯Ù‡Ø§ÛŒ Ø¢Ù…Ø§Ø¯Ù‡ Ø¨Ø±Ø§ÛŒ Ù¾ÛŒØ§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ Ø¯Ø± Next.js
Ø§Ø³ØªØ±Ø§ØªÚ˜ÛŒ Hybrid Ø¨Ø§ Ù…Ø«Ø§Ù„â€ŒÙ‡Ø§ÛŒ Ø¹Ù…Ù„ÛŒ
Best Practices 2025

# ğŸ¯ Client-Side vs Server-Side Export - ØªØ­Ù„ÛŒÙ„ Ú©Ø§Ù…Ù„ Ùˆ Ø¨Ù‡ØªØ±ÛŒÙ† Ø§Ø³ØªØ±Ø§ØªÚ˜ÛŒ

## âŒ Ù…Ø´Ú©Ù„Ø§Øª Ø±ÙˆÛŒÚ©Ø±Ø¯ ÙØ¹Ù„ÛŒ Ø´Ù…Ø§ (Server-Side HTML Print)

```python
# print_list_export_service.py - Ø±ÙˆÛŒÚ©Ø±Ø¯ ÙØ¹Ù„ÛŒ
def export_blogs_print(queryset):
    html_content = """
    <style>
        /* Ø§Ø³ØªØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ø·ÙˆÙ„Ø§Ù†ÛŒ Ø¯Ø± Python! */
        .header { ... }
    </style>
    <table>...</table>
    """
    return HttpResponse(html_content, content_type="text/html")
```

### Ù…Ø´Ú©Ù„Ø§Øª Ø§ÛŒÙ† Ø±ÙˆÛŒÚ©Ø±Ø¯:

1. **âŒ Mixing Concerns:**
   - UI/Styling Ø¯Ø± Backend = Bad Practice
   - Backend Ù†Ø¨Ø§ÛŒØ¯ CSS Ùˆ HTML Ù…Ø¯ÛŒØ±ÛŒØª Ú©Ù†Ù‡

2. **âŒ Maintainability:**
   - ØªØºÛŒÛŒØ± Ø§Ø³ØªØ§ÛŒÙ„ = Ø¨Ø§ÛŒØ¯ Backend Ø±Ùˆ Ø¢Ù¾Ø¯ÛŒØª Ú©Ù†ÛŒ
   - Ù‡ÛŒÚ† Hot Reload Ù†Ø¯Ø§Ø±ÛŒØ¯
   - Ù†Ù…ÛŒâ€ŒØªÙˆÙ†ÛŒØ¯ Ø§Ø² Component Library Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯

3. **âŒ Developer Experience:**
   - Ù†Ù…ÛŒâ€ŒØªÙˆÙ†ÛŒØ¯ Ø§Ø² TypeScript Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯
   - Ù†Ù…ÛŒâ€ŒØªÙˆÙ†ÛŒØ¯ Ø§Ø² Tailwind/CSS Modules Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯
   - Ù†Ù…ÛŒâ€ŒØªÙˆÙ†ÛŒØ¯ Preview real-time Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´ÛŒØ¯

4. **âŒ Testing:**
   - Ù†Ù…ÛŒâ€ŒØªÙˆÙ†ÛŒØ¯ UI Ø±Ùˆ Unit Test Ú©Ù†ÛŒØ¯
   - Ù†Ù…ÛŒâ€ŒØªÙˆÙ†ÛŒØ¯ Visual Regression Test Ø¨Ø²Ù†ÛŒØ¯

---

## âœ… Ø¨Ù‡ØªØ±ÛŒÙ† Ø±ÙˆÛŒÚ©Ø±Ø¯: Ù‡ÛŒØ¨Ø±ÛŒØ¯ÛŒ (Hybrid Strategy)

Ø¨Ø± Ø§Ø³Ø§Ø³ Best Practices 2025 Ùˆ Ù†ØªØ§ÛŒØ¬ Ø³Ø±Ú†:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          Frontend (Next.js/React)               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚   Print/Preview View (Client-Side)       â”‚   â”‚
â”‚  â”‚   - window.print()                       â”‚   â”‚
â”‚  â”‚   - @media print CSS                     â”‚   â”‚
â”‚  â”‚   - Real-time preview                    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚   Excel Export (Client-Side)             â”‚   â”‚
â”‚  â”‚   - Ø´ÛŒØªâ€ŒØ§Ú©Ø³Ù„ Ú©ÙˆÚ†Ú© (< 5000 rows)          â”‚   â”‚
â”‚  â”‚   - xlsx/exceljs library                 â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚   PDF Export                             â”‚   â”‚
â”‚  â”‚   â”œâ”€ Small: @react-pdf/renderer          â”‚   â”‚
â”‚  â”‚   â””â”€ Large: API call to backend          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚ API Call
                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          Backend (Django)                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚   PDF Export (Server-Side)               â”‚   â”‚
â”‚  â”‚   - Ø¯ÛŒØªØ§ÛŒ Ø¨Ø²Ø±Ú¯ (> 1000 rows)              â”‚   â”‚
â”‚  â”‚   - ReportLab                            â”‚   â”‚
â”‚  â”‚   - Complex layouts                      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚   Excel Export (Server-Side)             â”‚   â”‚
â”‚  â”‚   - Ø¯ÛŒØªØ§ÛŒ Ø¨Ø²Ø±Ú¯ (> 5000 rows)              â”‚   â”‚
â”‚  â”‚   - xlsxwriter                           â”‚   â”‚
â”‚  â”‚   - Complex formulas                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š Ù…Ù‚Ø§ÛŒØ³Ù‡ Ø¯Ù‚ÛŒÙ‚

### 1ï¸âƒ£ **Print View**

| Ù…Ø¹ÛŒØ§Ø± | Server-Side (ÙØ¹Ù„ÛŒ) | Client-Side (Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯ÛŒ) |
|-------|-------------------|------------------------|
| **Styling** | âŒ CSS Ø¯Ø± Python | âœ… CSS Modules/Tailwind |
| **Preview** | âŒ Ø¨Ø§ÛŒØ¯ backend rebuild Ú©Ù†ÛŒ | âœ… Hot reload |
| **Maintenance** | âŒ Ø³Ø®Øª | âœ… Ø¢Ø³Ø§Ù† |
| **Components** | âŒ Ù†Ø¯Ø§Ø±Ø¯ | âœ… Reusable Components |
| **TypeScript** | âŒ Ù†Ø¯Ø§Ø±Ø¯ | âœ… Type-safe |
| **Testing** | âŒ Ø³Ø®Øª | âœ… Jest/Testing Library |
| **Performance** | âš ï¸ Server load | âœ… Client-side |
| **SEO** | âš ï¸ Ù„Ø§Ø²Ù… Ù†ÛŒØ³Øª | âœ… N/A |

**Ù†ØªÛŒØ¬Ù‡:** âœ… **Client-Side Ø¨Ø±Ù†Ø¯Ù‡ Ø§Ø³Øª**

---

### 2ï¸âƒ£ **Excel Export**

| Ø³Ù†Ø§Ø±ÛŒÙˆ | Server-Side | Client-Side | ØªÙˆØµÛŒÙ‡ |
|--------|------------|-------------|-------|
| **< 1000 rows** | âš ï¸ Overkill | âœ… Ø³Ø±ÛŒØ¹ Ùˆ Ø±Ø§Ø­Øª | Client-Side |
| **1000-5000 rows** | âœ… Ø¨Ù‡ØªØ± | âš ï¸ Ù…Ù…Ú©Ù†Ù‡ Ú©Ù†Ø¯ Ø¨Ø§Ø´Ù‡ | Client-Side Ø¨Ø§ pagination |
| **> 5000 rows** | âœ… Ø§Ù„Ø²Ø§Ù…ÛŒ | âŒ Browser crash | Server-Side |
| **Complex Formulas** | âœ… xlsxwriter Ù‚ÙˆÛŒâ€ŒØªØ±Ù‡ | âš ï¸ Ù…Ø­Ø¯ÙˆØ¯ | Server-Side |
| **Real-time data** | âš ï¸ API call overhead | âœ… Ø³Ø±ÛŒØ¹ | Client-Side |
| **Security** | âœ… Ø¯Ø§Ø¯Ù‡ Ø±ÙˆÛŒ Ø³Ø±ÙˆØ± | âš ï¸ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒØ±Ù‡ client | Server-Side |

**Ù†ØªÛŒØ¬Ù‡:** âš–ï¸ **Hybrid - Ø¨Ø³ØªÙ‡ Ø¨Ù‡ Ø³Ø§ÛŒØ² Ø¯ÛŒØªØ§**

---

### 3ï¸âƒ£ **PDF Export**

| Ø³Ù†Ø§Ø±ÛŒÙˆ | Server-Side | Client-Side | ØªÙˆØµÛŒÙ‡ |
|--------|------------|-------------|-------|
| **Simple PDFs** | âš ï¸ Overkill | âœ… @react-pdf/renderer | Client-Side |
| **Complex layouts** | âœ… ReportLab powerful | âš ï¸ Ù…Ø­Ø¯ÙˆØ¯ÛŒØªâ€ŒÙ‡Ø§ Ø²ÛŒØ§Ø¯ | Server-Side |
| **RTL/Persian** | âœ… arabic-reshaper | âš ï¸ Ù†ÛŒØ§Ø² Ø¨Ù‡ ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø²ÛŒØ§Ø¯ | Server-Side |
| **Large data** | âœ… Ø§Ù„Ø²Ø§Ù…ÛŒ | âŒ Browser crash | Server-Side |
| **Custom fonts** | âœ… Ø¢Ø³Ø§Ù† | âš ï¸ Ù…Ø­Ø¯ÙˆØ¯ÛŒØª | Server-Side |
| **Preview** | âŒ Ø¨Ø§ÛŒØ¯ download Ú©Ù†ÛŒ | âœ… Instant preview | Client-Side |

**Ù†ØªÛŒØ¬Ù‡:** âš–ï¸ **Hybrid - Ø¨Ø³ØªÙ‡ Ø¨Ù‡ complexity**

---

## ğŸ¯ Ø§Ø³ØªØ±Ø§ØªÚ˜ÛŒ Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯ÛŒ Ø¨Ø±Ø§ÛŒ Ù¾Ø±ÙˆÚ˜Ù‡ Ø´Ù…Ø§

### 1ï¸âƒ£ **Print View â†’ 100% Client-Side**

```tsx
// panel-admin/src/app/(dashboard)/blogs/print/page.tsx
'use client';

import { BlogPrintView } from '@/components/blog/BlogPrintView';
import { useSearchParams } from 'next/navigation';

export default function BlogPrintPage() {
  const searchParams = useSearchParams();
  const ids = searchParams.get('ids')?.split(',') || [];
  
  return (
    <div className="print-container">
      <button onClick={() => window.print()} className="no-print">
        Ú†Ø§Ù¾
      </button>
      <BlogPrintView ids={ids} />
    </div>
  );
}
```

```tsx
// components/blog/BlogPrintView.tsx
'use client';

import { useQuery } from '@tanstack/react-query';

interface BlogPrintViewProps {
  ids: string[];
}

export function BlogPrintView({ ids }: BlogPrintViewProps) {
  const { data: blogs } = useQuery({
    queryKey: ['blogs', 'print', ids],
    queryFn: () => fetchBlogs({ ids }),
  });

  return (
    <>
      <style jsx global>{`
        @media print {
          .no-print { display: none; }
          @page { margin: 2cm; }
          body { font-family: Tahoma, Arial; }
          
          .blog-card {
            page-break-inside: avoid;
            border: 1px solid #ccc;
            padding: 1rem;
            margin-bottom: 1rem;
          }
        }
      `}</style>

      <div className="print-header">
        <h1>Ú¯Ø²Ø§Ø±Ø´ ÙˆØ¨Ù„Ø§Ú¯â€ŒÙ‡Ø§</h1>
        <p>ØªØ§Ø±ÛŒØ®: {new JDate().format('YYYY/MM/DD')}</p>
      </div>

      {blogs?.map(blog => (
        <div key={blog.id} className="blog-card">
          <h2>{blog.title}</h2>
          <div className="meta">
            <span>ÙˆØ¶Ø¹ÛŒØª: {blog.status}</span>
            <span>ØªØ§Ø±ÛŒØ®: {formatJalali(blog.created_at)}</span>
          </div>
          <p>{blog.short_description}</p>
        </div>
      ))}
    </>
  );
}
```

---

### 2ï¸âƒ£ **Excel Export â†’ Hybrid**

```tsx
// hooks/useExcelExport.ts
import * as XLSX from 'xlsx';
import { useMutation } from '@tanstack/react-query';

export function useExcelExport() {
  // Client-side export for small data
  const exportClientSide = (data: any[]) => {
    const worksheet = XLSX.utils.json_to_sheet(data);
    const workbook = XLSX.utils.book_new();
    XLSX.utils.book_append_sheet(workbook, worksheet, 'ÙˆØ¨Ù„Ø§Ú¯â€ŒÙ‡Ø§');
    XLSX.writeFile(workbook, `blogs_${Date.now()}.xlsx`);
  };

  // Server-side export for large data
  const exportServerSide = useMutation({
    mutationFn: async (filters: any) => {
      const response = await fetch('/api/blogs/export?format=excel', {
        method: 'POST',
        body: JSON.stringify(filters),
      });
      const blob = await response.blob();
      const url = window.URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `blogs_${Date.now()}.xlsx`;
      a.click();
    },
  });

  return {
    exportExcel: (data: any[], isLarge: boolean) => {
      if (isLarge || data.length > 5000) {
        return exportServerSide.mutate(data);
      }
      return exportClientSide(data);
    },
    isLoading: exportServerSide.isPending,
  };
}
```

```tsx
// components/blog/ExportButton.tsx
'use client';

import { useExcelExport } from '@/hooks/useExcelExport';

export function ExportButton({ blogs, totalCount }: Props) {
  const { exportExcel, isLoading } = useExcelExport();

  const handleExport = () => {
    const isLargeDataset = totalCount > 5000;
    exportExcel(blogs, isLargeDataset);
  };

  return (
    <button onClick={handleExport} disabled={isLoading}>
      {isLoading ? 'Ø¯Ø± Ø­Ø§Ù„ Export...' : 'Export Excel'}
    </button>
  );
}
```

---

### 3ï¸âƒ£ **PDF Export â†’ Hybrid**

```tsx
// hooks/usePdfExport.ts
import { pdf } from '@react-pdf/renderer';
import { BlogPdfDocument } from '@/components/pdf/BlogPdfDocument';

export function usePdfExport() {
  // Client-side for simple PDFs
  const exportClientSide = async (blog: Blog) => {
    const blob = await pdf(<BlogPdfDocument blog={blog} />).toBlob();
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `blog_${blog.id}.pdf`;
    a.click();
  };

  // Server-side for complex PDFs
  const exportServerSide = async (blogId: string) => {
    const response = await fetch(`/api/blogs/${blogId}/export-pdf`);
    const blob = await response.blob();
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `blog_${blogId}.pdf`;
    a.click();
  };

  return {
    exportPdf: (blog: Blog, complex: boolean) => {
      return complex ? exportServerSide(blog.id) : exportClientSide(blog);
    },
  };
}
```

```tsx
// components/pdf/BlogPdfDocument.tsx
import { Document, Page, Text, View, StyleSheet, Font } from '@react-pdf/renderer';

// Ø«Ø¨Øª ÙÙˆÙ†Øª ÙØ§Ø±Ø³ÛŒ
Font.register({
  family: 'Vazir',
  src: '/fonts/Vazir.ttf',
});

const styles = StyleSheet.create({
  page: {
    fontFamily: 'Vazir',
    padding: 30,
    direction: 'rtl',
  },
  title: {
    fontSize: 24,
    marginBottom: 20,
    textAlign: 'right',
  },
  section: {
    marginBottom: 10,
  },
});

export function BlogPdfDocument({ blog }: { blog: Blog }) {
  return (
    <Document>
      <Page size="A4" style={styles.page}>
        <Text style={styles.title}>{blog.title}</Text>
        <View style={styles.section}>
          <Text>ØªØ§Ø±ÛŒØ®: {formatJalali(blog.created_at)}</Text>
        </View>
        <View style={styles.section}>
          <Text>{blog.short_description}</Text>
        </View>
      </Page>
    </Document>
  );
}
```

---

## ğŸ“ Ø³Ø§Ø®ØªØ§Ø± Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯ÛŒ Ù¾Ø±ÙˆÚ˜Ù‡

```
panel-admin/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ app/
â”‚   â”‚   â””â”€â”€ (dashboard)/
â”‚   â”‚       â””â”€â”€ blogs/
â”‚   â”‚           â”œâ”€â”€ page.tsx                    # Ù„ÛŒØ³Øª Ø§ØµÙ„ÛŒ
â”‚   â”‚           â”œâ”€â”€ print/
â”‚   â”‚           â”‚   â””â”€â”€ page.tsx                # âœ… Print view (Client-side)
â”‚   â”‚           â””â”€â”€ [id]/
â”‚   â”‚               â””â”€â”€ export-pdf/
â”‚   â”‚                   â””â”€â”€ page.tsx            # âœ… PDF preview
â”‚   â”‚
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â””â”€â”€ blog/
â”‚   â”‚       â”œâ”€â”€ BlogPrintView.tsx               # âœ… Print component
â”‚   â”‚       â”œâ”€â”€ BlogTable.tsx                   # Ø¬Ø¯ÙˆÙ„ Ø§ØµÙ„ÛŒ
â”‚   â”‚       â””â”€â”€ ExportButton.tsx                # Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ export
â”‚   â”‚
â”‚   â”œâ”€â”€ hooks/
â”‚   â”‚   â”œâ”€â”€ useExcelExport.ts                   # âœ… Excel export logic
â”‚   â”‚   â”œâ”€â”€ usePdfExport.ts                     # âœ… PDF export logic
â”‚   â”‚   â””â”€â”€ usePrintView.ts                     # âœ… Print logic
â”‚   â”‚
â”‚   â””â”€â”€ lib/
â”‚       â”œâ”€â”€ export/
â”‚       â”‚   â”œâ”€â”€ excel.ts                        # Client-side Excel utils
â”‚       â”‚   â””â”€â”€ pdf.ts                          # Client-side PDF utils
â”‚       â””â”€â”€ date/
â”‚           â””â”€â”€ jalali.ts                       # Jalali date utils
â”‚
Backend/
â””â”€â”€ src/
    â””â”€â”€ blog/
        â”œâ”€â”€ views/admin/
        â”‚   â””â”€â”€ blog_export_view.py             # âš ï¸ ÙÙ‚Ø· Ø¨Ø±Ø§ÛŒ Large exports
        â””â”€â”€ services/admin/
            â”œâ”€â”€ excel_export_service.py         # âš ï¸ Large data only
            â””â”€â”€ pdf_export_service.py           # âš ï¸ Complex PDFs only
```

---

## ğŸš€ Ù…Ø²Ø§ÛŒØ§ÛŒ Ø§ÛŒÙ† Ø±ÙˆÛŒÚ©Ø±Ø¯

### âœ… Print View (Client-Side):
- Ø§Ø³ØªØ§ÛŒÙ„â€ŒØ¯Ù‡ÛŒ Ø±Ø§Ø­Øª Ø¨Ø§ Tailwind/CSS Modules
- Hot Reload Ùˆ Preview Ø³Ø±ÛŒØ¹
- Component-based Ùˆ Reusable
- TypeScript Support
- Testing Ø¢Ø³Ø§Ù†

### âœ… Excel Export (Hybrid):
- Ø¯ÛŒØªØ§ÛŒ Ú©ÙˆÚ†Ú© â†’ Ø³Ø±ÛŒØ¹ Ø¯Ø± Client
- Ø¯ÛŒØªØ§ÛŒ Ø¨Ø²Ø±Ú¯ â†’ Stable Ø¯Ø± Server
- Ø¨Ù‡ØªØ±ÛŒÙ† UX

### âœ… PDF Export (Hybrid):
- Simple PDFs â†’ Preview instant
- Complex PDFs â†’ Quality Ø¨Ø§Ù„Ø§

---

## ğŸ“Š Ù†ØªÛŒØ¬Ù‡â€ŒÚ¯ÛŒØ±ÛŒ Ù†Ù‡Ø§ÛŒÛŒ

| Feature | Backend (ÙØ¹Ù„ÛŒ) | Frontend (Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯ÛŒ) | Hybrid (Ø¨Ù‡ØªØ±ÛŒÙ†) |
|---------|---------------|---------------------|-----------------|
| Print View | âŒ | âœ… | âœ… Frontend |
| Excel (< 5k rows) | âŒ | âœ… | âœ… Frontend |
| Excel (> 5k rows) | âœ… | âŒ | âœ… Backend |
| PDF (Simple) | âŒ | âœ… | âœ… Frontend |
| PDF (Complex) | âœ… | âŒ | âœ… Backend |

---

## ğŸ¯ Ø§Ù‚Ø¯Ø§Ù…Ø§Øª Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯ÛŒ:

1. **Ø­Ø°Ù `print_list_export_service.py`** - Ø¬Ø§ÛŒÚ¯Ø²ÛŒÙ† Ø¨Ø§ Component Ø¯Ø± Next.js
2. **Ù†Ú¯Ù‡ Ø¯Ø§Ø´ØªÙ† `excel_export_service.py`** - ÙÙ‚Ø· Ø¨Ø±Ø§ÛŒ > 5000 rows
3. **Ù†Ú¯Ù‡ Ø¯Ø§Ø´ØªÙ† `pdf_export_service.py`** - ÙÙ‚Ø· Ø¨Ø±Ø§ÛŒ Complex PDFs
4. **Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Client-Side Export** Ø¯Ø± Next.js Admin Panel

Ø§ÛŒÙ† Best Practice Ø³Ø§Ù„ 2025 Ù‡Ø³Øª! ğŸš€


ğŸ¯ Ù†ØªÛŒØ¬Ù‡ Ù†Ù‡Ø§ÛŒÛŒ Ø¨Ø± Ø§Ø³Ø§Ø³ Ø³Ø±Ú† (Ø¨Ø¯ÙˆÙ† Ú©Ø¯):
ğŸ“Œ Print View:

âœ… 100% ÙØ±ÙˆÙ†Øªâ€ŒØ§Ù†Ø¯ (Next.js) - Ø¨Ø§ÛŒØ¯ Ø¯Ø± ÙØ±ÙˆÙ†Øª Ù¾ÛŒØ§Ø¯Ù‡ Ø¨Ø´Ù‡
âŒ Ø¨Ú©â€ŒØ§Ù†Ø¯ HTML = Anti-Pattern Ø¯Ø± 2025
Ø¯Ù„ÛŒÙ„: UI logic Ø¯Ø± Backend Ø¬Ø§ÛŒÛŒ Ù†Ø¯Ø§Ø±Ù‡

ğŸ“Œ Excel Export:
Ø§Ø³ØªØ±Ø§ØªÚ˜ÛŒ Hybrid:

âœ… Ø¯ÛŒØªØ§ÛŒ Ú©ÙˆÚ†Ú© (< 5000 rows) â†’ ÙØ±ÙˆÙ†Øª (xlsx library)
âœ… Ø¯ÛŒØªØ§ÛŒ Ø¨Ø²Ø±Ú¯ (> 5000 rows) â†’ Ø¨Ú©â€ŒØ§Ù†Ø¯ (xlsxwriter)
Ø¯Ù„ÛŒÙ„: Browser memory limit & Performance

ğŸ“Œ PDF Export:
Ø§Ø³ØªØ±Ø§ØªÚ˜ÛŒ Hybrid:

âœ… Simple PDFs â†’ ÙØ±ÙˆÙ†Øª (@react-pdf/renderer)
âœ… Complex PDFs Ø¨Ø§ RTL/Persian â†’ Ø¨Ú©â€ŒØ§Ù†Ø¯ (ReportLab)
Ø¯Ù„ÛŒÙ„: Font handling Ùˆ RTL processing Ø¯Ø± Ø¨Ú©â€ŒØ§Ù†Ø¯ Ù‚ÙˆÛŒâ€ŒØªØ±Ù‡


ğŸ”¥ Ø¬ÙˆØ§Ø¨ Ø³ÙˆØ§Ù„ Ø´Ù…Ø§:
âŒ Ø¨Ø§ÛŒØ¯ Ù¾Ø§Ú© Ø¨Ø´Ù‡ Ø§Ø² Ø¨Ú©â€ŒØ§Ù†Ø¯:
python# print_list_export_service.py 
# âŒ Ø§ÛŒÙ† ÙØ§ÛŒÙ„ Ø±Ùˆ Ú©Ø§Ù…Ù„ Ù¾Ø§Ú© Ú©Ù†ÛŒØ¯
âœ… Ø¨Ø§ÛŒØ¯ Ø¨Ù…ÙˆÙ†Ù‡ Ø¯Ø± Ø¨Ú©â€ŒØ§Ù†Ø¯:
python# excel_export_service.py â†’ ÙÙ‚Ø· Ø¨Ø±Ø§ÛŒ Large Data (> 5k rows)
# pdf_export_service.py â†’ ÙÙ‚Ø· Ø¨Ø±Ø§ÛŒ Complex PDFs Ø¨Ø§ RTL
# pdf_list_export_service.py â†’ ÙÙ‚Ø· Ø¨Ø±Ø§ÛŒ Large Lists
```

---

## ğŸ¢ **Ù¾Ø±ÙˆÚ˜Ù‡â€ŒÙ‡Ø§ÛŒ Ø¨Ø²Ø±Ú¯ Ú†Ø·ÙˆØ±ØŸ**

Ø¨Ø± Ø§Ø³Ø§Ø³ Ø³Ø±Ú† Ø§Ø² Enterprise Applications:

### âœ… **Best Practice Ø¯Ø± 2025:**
1. **Micro-frontends Architecture** - UI logic Ø¬Ø¯Ø§ Ø§Ø² Backend
2. **Separation of Concerns** - Backend = Data, Frontend = Presentation
3. **Hybrid Strategy** - Ú©Ø§Ø±Ù‡Ø§ÛŒ Ø³Ù†Ú¯ÛŒÙ† Ø¯Ø± BackendØŒ Ø¨Ù‚ÛŒÙ‡ Ø¯Ø± Frontend

### ğŸ¯ **Ú†Ø±Ø§ Ø§ÛŒÙ† Ø±ÙˆÛŒÚ©Ø±Ø¯ Ø¨Ù‡ØªØ±Ù‡ØŸ**
- **Scalability**: Ù‡Ø± ØªÛŒÙ… Ø±ÙˆÛŒ Ø¨Ø®Ø´ Ø®ÙˆØ¯Ø´ Ú©Ø§Ø± Ù…ÛŒâ€ŒÚ©Ù†Ù‡
- **Performance**: Bundle size Ú©Ù…ØªØ±
- **Maintainability**: ØªØºÛŒÛŒØ± UI Ù†ÛŒØ§Ø²ÛŒ Ø¨Ù‡ Deploy Ø¨Ú©â€ŒØ§Ù†Ø¯ Ù†Ø¯Ø§Ø±Ù‡
- **Developer Experience**: Hot reload, TypeScript, Component reuse

---

## ğŸ“Š **Ù†ØªÛŒØ¬Ù‡â€ŒÚ¯ÛŒØ±ÛŒ Ù†Ù‡Ø§ÛŒÛŒ:**
```
Frontend (Next.js):
âœ… Print View (100%)
âœ… Excel < 5k rows
âœ… PDF Simple

Backend (Django):
âœ… Excel > 5k rows (xlsxwriter)
âœ… PDF Complex/RTL (ReportLab)
âŒ Print View (DELETE IT!)
Ø§ÛŒÙ† Ø§Ø³ØªØ§Ù†Ø¯Ø§Ø±Ø¯ ØµÙ†Ø¹ØªÛŒ 2025 Ù‡Ø³Øª Ø¨Ø± Ø§Ø³Ø§Ø³ Ø³Ø±Ú†â€ŒÙ‡Ø§ÛŒ Ù…Ø¹ØªØ¨Ø±! ğŸš€


# ğŸ¯ Client-Side vs Server-Side Export - ØªØ­Ù„ÛŒÙ„ Ú©Ø§Ù…Ù„ Ùˆ Ø¨Ù‡ØªØ±ÛŒÙ† Ø§Ø³ØªØ±Ø§ØªÚ˜ÛŒ

## âŒ Ù…Ø´Ú©Ù„Ø§Øª Ø±ÙˆÛŒÚ©Ø±Ø¯ ÙØ¹Ù„ÛŒ Ø´Ù…Ø§ (Server-Side HTML Print)

```python
# print_list_export_service.py - Ø±ÙˆÛŒÚ©Ø±Ø¯ ÙØ¹Ù„ÛŒ
def export_blogs_print(queryset):
    html_content = """
    <style>
        /* Ø§Ø³ØªØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ø·ÙˆÙ„Ø§Ù†ÛŒ Ø¯Ø± Python! */
        .header { ... }
    </style>
    <table>...</table>
    """
    return HttpResponse(html_content, content_type="text/html")
```

### Ù…Ø´Ú©Ù„Ø§Øª Ø§ÛŒÙ† Ø±ÙˆÛŒÚ©Ø±Ø¯:

1. **âŒ Mixing Concerns:**
   - UI/Styling Ø¯Ø± Backend = Bad Practice
   - Backend Ù†Ø¨Ø§ÛŒØ¯ CSS Ùˆ HTML Ù…Ø¯ÛŒØ±ÛŒØª Ú©Ù†Ù‡

2. **âŒ Maintainability:**
   - ØªØºÛŒÛŒØ± Ø§Ø³ØªØ§ÛŒÙ„ = Ø¨Ø§ÛŒØ¯ Backend Ø±Ùˆ Ø¢Ù¾Ø¯ÛŒØª Ú©Ù†ÛŒ
   - Ù‡ÛŒÚ† Hot Reload Ù†Ø¯Ø§Ø±ÛŒØ¯
   - Ù†Ù…ÛŒâ€ŒØªÙˆÙ†ÛŒØ¯ Ø§Ø² Component Library Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯

3. **âŒ Developer Experience:**
   - Ù†Ù…ÛŒâ€ŒØªÙˆÙ†ÛŒØ¯ Ø§Ø² TypeScript Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯
   - Ù†Ù…ÛŒâ€ŒØªÙˆÙ†ÛŒØ¯ Ø§Ø² Tailwind/CSS Modules Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯
   - Ù†Ù…ÛŒâ€ŒØªÙˆÙ†ÛŒØ¯ Preview real-time Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´ÛŒØ¯

4. **âŒ Testing:**
   - Ù†Ù…ÛŒâ€ŒØªÙˆÙ†ÛŒØ¯ UI Ø±Ùˆ Unit Test Ú©Ù†ÛŒØ¯
   - Ù†Ù…ÛŒâ€ŒØªÙˆÙ†ÛŒØ¯ Visual Regression Test Ø¨Ø²Ù†ÛŒØ¯

---

## âœ… Ø¨Ù‡ØªØ±ÛŒÙ† Ø±ÙˆÛŒÚ©Ø±Ø¯: Ù‡ÛŒØ¨Ø±ÛŒØ¯ÛŒ (Hybrid Strategy)

Ø¨Ø± Ø§Ø³Ø§Ø³ Best Practices 2025 Ùˆ Ù†ØªØ§ÛŒØ¬ Ø³Ø±Ú†:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          Frontend (Next.js/React)               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚   Print/Preview View (Client-Side)       â”‚   â”‚
â”‚  â”‚   - window.print()                       â”‚   â”‚
â”‚  â”‚   - @media print CSS                     â”‚   â”‚
â”‚  â”‚   - Real-time preview                    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚   Excel Export (Client-Side)             â”‚   â”‚
â”‚  â”‚   - Ø´ÛŒØªâ€ŒØ§Ú©Ø³Ù„ Ú©ÙˆÚ†Ú© (< 5000 rows)          â”‚   â”‚
â”‚  â”‚   - xlsx/exceljs library                 â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚   PDF Export                             â”‚   â”‚
â”‚  â”‚   â”œâ”€ Small: @react-pdf/renderer          â”‚   â”‚
â”‚  â”‚   â””â”€ Large: API call to backend          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚ API Call
                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          Backend (Django)                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚   PDF Export (Server-Side)               â”‚   â”‚
â”‚  â”‚   - Ø¯ÛŒØªØ§ÛŒ Ø¨Ø²Ø±Ú¯ (> 1000 rows)              â”‚   â”‚
â”‚  â”‚   - ReportLab                            â”‚   â”‚
â”‚  â”‚   - Complex layouts                      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚   Excel Export (Server-Side)             â”‚   â”‚
â”‚  â”‚   - Ø¯ÛŒØªØ§ÛŒ Ø¨Ø²Ø±Ú¯ (> 5000 rows)              â”‚   â”‚
â”‚  â”‚   - xlsxwriter                           â”‚   â”‚
â”‚  â”‚   - Complex formulas                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š Ù…Ù‚Ø§ÛŒØ³Ù‡ Ø¯Ù‚ÛŒÙ‚

### 1ï¸âƒ£ **Print View**

| Ù…Ø¹ÛŒØ§Ø± | Server-Side (ÙØ¹Ù„ÛŒ) | Client-Side (Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯ÛŒ) |
|-------|-------------------|------------------------|
| **Styling** | âŒ CSS Ø¯Ø± Python | âœ… CSS Modules/Tailwind |
| **Preview** | âŒ Ø¨Ø§ÛŒØ¯ backend rebuild Ú©Ù†ÛŒ | âœ… Hot reload |
| **Maintenance** | âŒ Ø³Ø®Øª | âœ… Ø¢Ø³Ø§Ù† |
| **Components** | âŒ Ù†Ø¯Ø§Ø±Ø¯ | âœ… Reusable Components |
| **TypeScript** | âŒ Ù†Ø¯Ø§Ø±Ø¯ | âœ… Type-safe |
| **Testing** | âŒ Ø³Ø®Øª | âœ… Jest/Testing Library |
| **Performance** | âš ï¸ Server load | âœ… Client-side |
| **SEO** | âš ï¸ Ù„Ø§Ø²Ù… Ù†ÛŒØ³Øª | âœ… N/A |

**Ù†ØªÛŒØ¬Ù‡:** âœ… **Client-Side Ø¨Ø±Ù†Ø¯Ù‡ Ø§Ø³Øª**

---

### 2ï¸âƒ£ **Excel Export**

| Ø³Ù†Ø§Ø±ÛŒÙˆ | Server-Side | Client-Side | ØªÙˆØµÛŒÙ‡ |
|--------|------------|-------------|-------|
| **< 1000 rows** | âš ï¸ Overkill | âœ… Ø³Ø±ÛŒØ¹ Ùˆ Ø±Ø§Ø­Øª | Client-Side |
| **1000-5000 rows** | âœ… Ø¨Ù‡ØªØ± | âš ï¸ Ù…Ù…Ú©Ù†Ù‡ Ú©Ù†Ø¯ Ø¨Ø§Ø´Ù‡ | Client-Side Ø¨Ø§ pagination |
| **> 5000 rows** | âœ… Ø§Ù„Ø²Ø§Ù…ÛŒ | âŒ Browser crash | Server-Side |
| **Complex Formulas** | âœ… xlsxwriter Ù‚ÙˆÛŒâ€ŒØªØ±Ù‡ | âš ï¸ Ù…Ø­Ø¯ÙˆØ¯ | Server-Side |
| **Real-time data** | âš ï¸ API call overhead | âœ… Ø³Ø±ÛŒØ¹ | Client-Side |
| **Security** | âœ… Ø¯Ø§Ø¯Ù‡ Ø±ÙˆÛŒ Ø³Ø±ÙˆØ± | âš ï¸ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒØ±Ù‡ client | Server-Side |

**Ù†ØªÛŒØ¬Ù‡:** âš–ï¸ **Hybrid - Ø¨Ø³ØªÙ‡ Ø¨Ù‡ Ø³Ø§ÛŒØ² Ø¯ÛŒØªØ§**

---

### 3ï¸âƒ£ **PDF Export**

| Ø³Ù†Ø§Ø±ÛŒÙˆ | Server-Side | Client-Side | ØªÙˆØµÛŒÙ‡ |
|--------|------------|-------------|-------|
| **Simple PDFs** | âš ï¸ Overkill | âœ… @react-pdf/renderer | Client-Side |
| **Complex layouts** | âœ… ReportLab powerful | âš ï¸ Ù…Ø­Ø¯ÙˆØ¯ÛŒØªâ€ŒÙ‡Ø§ Ø²ÛŒØ§Ø¯ | Server-Side |
| **RTL/Persian** | âœ… arabic-reshaper | âš ï¸ Ù†ÛŒØ§Ø² Ø¨Ù‡ ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø²ÛŒØ§Ø¯ | Server-Side |
| **Large data** | âœ… Ø§Ù„Ø²Ø§Ù…ÛŒ | âŒ Browser crash | Server-Side |
| **Custom fonts** | âœ… Ø¢Ø³Ø§Ù† | âš ï¸ Ù…Ø­Ø¯ÙˆØ¯ÛŒØª | Server-Side |
| **Preview** | âŒ Ø¨Ø§ÛŒØ¯ download Ú©Ù†ÛŒ | âœ… Instant preview | Client-Side |

**Ù†ØªÛŒØ¬Ù‡:** âš–ï¸ **Hybrid - Ø¨Ø³ØªÙ‡ Ø¨Ù‡ complexity**

---

## ğŸ¯ Ø§Ø³ØªØ±Ø§ØªÚ˜ÛŒ Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯ÛŒ Ø¨Ø±Ø§ÛŒ Ù¾Ø±ÙˆÚ˜Ù‡ Ø´Ù…Ø§

### 1ï¸âƒ£ **Print View â†’ 100% Client-Side**

```tsx
// panel-admin/src/app/(dashboard)/blogs/print/page.tsx
'use client';

import { BlogPrintView } from '@/components/blog/BlogPrintView';
import { useSearchParams } from 'next/navigation';

export default function BlogPrintPage() {
  const searchParams = useSearchParams();
  const ids = searchParams.get('ids')?.split(',') || [];
  
  return (
    <div className="print-container">
      <button onClick={() => window.print()} className="no-print">
        Ú†Ø§Ù¾
      </button>
      <BlogPrintView ids={ids} />
    </div>
  );
}
```

```tsx
// components/blog/BlogPrintView.tsx
'use client';

import { useQuery } from '@tanstack/react-query';

interface BlogPrintViewProps {
  ids: string[];
}

export function BlogPrintView({ ids }: BlogPrintViewProps) {
  const { data: blogs } = useQuery({
    queryKey: ['blogs', 'print', ids],
    queryFn: () => fetchBlogs({ ids }),
  });

  return (
    <>
      <style jsx global>{`
        @media print {
          .no-print { display: none; }
          @page { margin: 2cm; }
          body { font-family: Tahoma, Arial; }
          
          .blog-card {
            page-break-inside: avoid;
            border: 1px solid #ccc;
            padding: 1rem;
            margin-bottom: 1rem;
          }
        }
      `}</style>

      <div className="print-header">
        <h1>Ú¯Ø²Ø§Ø±Ø´ ÙˆØ¨Ù„Ø§Ú¯â€ŒÙ‡Ø§</h1>
        <p>ØªØ§Ø±ÛŒØ®: {new JDate().format('YYYY/MM/DD')}</p>
      </div>

      {blogs?.map(blog => (
        <div key={blog.id} className="blog-card">
          <h2>{blog.title}</h2>
          <div className="meta">
            <span>ÙˆØ¶Ø¹ÛŒØª: {blog.status}</span>
            <span>ØªØ§Ø±ÛŒØ®: {formatJalali(blog.created_at)}</span>
          </div>
          <p>{blog.short_description}</p>
        </div>
      ))}
    </>
  );
}
```

---

### 2ï¸âƒ£ **Excel Export â†’ Hybrid**

```tsx
// hooks/useExcelExport.ts
import * as XLSX from 'xlsx';
import { useMutation } from '@tanstack/react-query';

export function useExcelExport() {
  // Client-side export for small data
  const exportClientSide = (data: any[]) => {
    const worksheet = XLSX.utils.json_to_sheet(data);
    const workbook = XLSX.utils.book_new();
    XLSX.utils.book_append_sheet(workbook, worksheet, 'ÙˆØ¨Ù„Ø§Ú¯â€ŒÙ‡Ø§');
    XLSX.writeFile(workbook, `blogs_${Date.now()}.xlsx`);
  };

  // Server-side export for large data
  const exportServerSide = useMutation({
    mutationFn: async (filters: any) => {
      const response = await fetch('/api/blogs/export?format=excel', {
        method: 'POST',
        body: JSON.stringify(filters),
      });
      const blob = await response.blob();
      const url = window.URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `blogs_${Date.now()}.xlsx`;
      a.click();
    },
  });

  return {
    exportExcel: (data: any[], isLarge: boolean) => {
      if (isLarge || data.length > 5000) {
        return exportServerSide.mutate(data);
      }
      return exportClientSide(data);
    },
    isLoading: exportServerSide.isPending,
  };
}
```

```tsx
// components/blog/ExportButton.tsx
'use client';

import { useExcelExport } from '@/hooks/useExcelExport';

export function ExportButton({ blogs, totalCount }: Props) {
  const { exportExcel, isLoading } = useExcelExport();

  const handleExport = () => {
    const isLargeDataset = totalCount > 5000;
    exportExcel(blogs, isLargeDataset);
  };

  return (
    <button onClick={handleExport} disabled={isLoading}>
      {isLoading ? 'Ø¯Ø± Ø­Ø§Ù„ Export...' : 'Export Excel'}
    </button>
  );
}
```

---

### 3ï¸âƒ£ **PDF Export â†’ Hybrid**

```tsx
// hooks/usePdfExport.ts
import { pdf } from '@react-pdf/renderer';
import { BlogPdfDocument } from '@/components/pdf/BlogPdfDocument';

export function usePdfExport() {
  // Client-side for simple PDFs
  const exportClientSide = async (blog: Blog) => {
    const blob = await pdf(<BlogPdfDocument blog={blog} />).toBlob();
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `blog_${blog.id}.pdf`;
    a.click();
  };

  // Server-side for complex PDFs
  const exportServerSide = async (blogId: string) => {
    const response = await fetch(`/api/blogs/${blogId}/export-pdf`);
    const blob = await response.blob();
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `blog_${blogId}.pdf`;
    a.click();
  };

  return {
    exportPdf: (blog: Blog, complex: boolean) => {
      return complex ? exportServerSide(blog.id) : exportClientSide(blog);
    },
  };
}
```

```tsx
// components/pdf/BlogPdfDocument.tsx
import { Document, Page, Text, View, StyleSheet, Font } from '@react-pdf/renderer';

// Ø«Ø¨Øª ÙÙˆÙ†Øª ÙØ§Ø±Ø³ÛŒ
Font.register({
  family: 'Vazir',
  src: '/fonts/Vazir.ttf',
});

const styles = StyleSheet.create({
  page: {
    fontFamily: 'Vazir',
    padding: 30,
    direction: 'rtl',
  },
  title: {
    fontSize: 24,
    marginBottom: 20,
    textAlign: 'right',
  },
  section: {
    marginBottom: 10,
  },
});

export function BlogPdfDocument({ blog }: { blog: Blog }) {
  return (
    <Document>
      <Page size="A4" style={styles.page}>
        <Text style={styles.title}>{blog.title}</Text>
        <View style={styles.section}>
          <Text>ØªØ§Ø±ÛŒØ®: {formatJalali(blog.created_at)}</Text>
        </View>
        <View style={styles.section}>
          <Text>{blog.short_description}</Text>
        </View>
      </Page>
    </Document>
  );
}
```

---

## ğŸ“ Ø³Ø§Ø®ØªØ§Ø± Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯ÛŒ Ù¾Ø±ÙˆÚ˜Ù‡

```
panel-admin/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ app/
â”‚   â”‚   â””â”€â”€ (dashboard)/
â”‚   â”‚       â””â”€â”€ blogs/
â”‚   â”‚           â”œâ”€â”€ page.tsx                    # Ù„ÛŒØ³Øª Ø§ØµÙ„ÛŒ
â”‚   â”‚           â”œâ”€â”€ print/
â”‚   â”‚           â”‚   â””â”€â”€ page.tsx                # âœ… Print view (Client-side)
â”‚   â”‚           â””â”€â”€ [id]/
â”‚   â”‚               â””â”€â”€ export-pdf/
â”‚   â”‚                   â””â”€â”€ page.tsx            # âœ… PDF preview
â”‚   â”‚
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â””â”€â”€ blog/
â”‚   â”‚       â”œâ”€â”€ BlogPrintView.tsx               # âœ… Print component
â”‚   â”‚       â”œâ”€â”€ BlogTable.tsx                   # Ø¬Ø¯ÙˆÙ„ Ø§ØµÙ„ÛŒ
â”‚   â”‚       â””â”€â”€ ExportButton.tsx                # Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ export
â”‚   â”‚
â”‚   â”œâ”€â”€ hooks/
â”‚   â”‚   â”œâ”€â”€ useExcelExport.ts                   # âœ… Excel export logic
â”‚   â”‚   â”œâ”€â”€ usePdfExport.ts                     # âœ… PDF export logic
â”‚   â”‚   â””â”€â”€ usePrintView.ts                     # âœ… Print logic
â”‚   â”‚
â”‚   â””â”€â”€ lib/
â”‚       â”œâ”€â”€ export/
â”‚       â”‚   â”œâ”€â”€ excel.ts                        # Client-side Excel utils
â”‚       â”‚   â””â”€â”€ pdf.ts                          # Client-side PDF utils
â”‚       â””â”€â”€ date/
â”‚           â””â”€â”€ jalali.ts                       # Jalali date utils
â”‚
Backend/
â””â”€â”€ src/
    â””â”€â”€ blog/
        â”œâ”€â”€ views/admin/
        â”‚   â””â”€â”€ blog_export_view.py             # âš ï¸ ÙÙ‚Ø· Ø¨Ø±Ø§ÛŒ Large exports
        â””â”€â”€ services/admin/
            â”œâ”€â”€ excel_export_service.py         # âš ï¸ Large data only
            â””â”€â”€ pdf_export_service.py           # âš ï¸ Complex PDFs only
```

---

## ğŸš€ Ù…Ø²Ø§ÛŒØ§ÛŒ Ø§ÛŒÙ† Ø±ÙˆÛŒÚ©Ø±Ø¯

### âœ… Print View (Client-Side):
- Ø§Ø³ØªØ§ÛŒÙ„â€ŒØ¯Ù‡ÛŒ Ø±Ø§Ø­Øª Ø¨Ø§ Tailwind/CSS Modules
- Hot Reload Ùˆ Preview Ø³Ø±ÛŒØ¹
- Component-based Ùˆ Reusable
- TypeScript Support
- Testing Ø¢Ø³Ø§Ù†

### âœ… Excel Export (Hybrid):
- Ø¯ÛŒØªØ§ÛŒ Ú©ÙˆÚ†Ú© â†’ Ø³Ø±ÛŒØ¹ Ø¯Ø± Client
- Ø¯ÛŒØªØ§ÛŒ Ø¨Ø²Ø±Ú¯ â†’ Stable Ø¯Ø± Server
- Ø¨Ù‡ØªØ±ÛŒÙ† UX

### âœ… PDF Export (Hybrid):
- Simple PDFs â†’ Preview instant
- Complex PDFs â†’ Quality Ø¨Ø§Ù„Ø§

---

## ğŸ“Š Ù†ØªÛŒØ¬Ù‡â€ŒÚ¯ÛŒØ±ÛŒ Ù†Ù‡Ø§ÛŒÛŒ

| Feature | Backend (ÙØ¹Ù„ÛŒ) | Frontend (Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯ÛŒ) | Hybrid (Ø¨Ù‡ØªØ±ÛŒÙ†) |
|---------|---------------|---------------------|-----------------|
| Print View | âŒ | âœ… | âœ… Frontend |
| Excel (< 5k rows) | âŒ | âœ… | âœ… Frontend |
| Excel (> 5k rows) | âœ… | âŒ | âœ… Backend |
| PDF (Simple) | âŒ | âœ… | âœ… Frontend |
| PDF (Complex) | âœ… | âŒ | âœ… Backend |

---

## ğŸ¯ Ø§Ù‚Ø¯Ø§Ù…Ø§Øª Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯ÛŒ:

1. **Ø­Ø°Ù `print_list_export_service.py`** - Ø¬Ø§ÛŒÚ¯Ø²ÛŒÙ† Ø¨Ø§ Component Ø¯Ø± Next.js
2. **Ù†Ú¯Ù‡ Ø¯Ø§Ø´ØªÙ† `excel_export_service.py`** - ÙÙ‚Ø· Ø¨Ø±Ø§ÛŒ > 5000 rows
3. **Ù†Ú¯Ù‡ Ø¯Ø§Ø´ØªÙ† `pdf_export_service.py`** - ÙÙ‚Ø· Ø¨Ø±Ø§ÛŒ Complex PDFs
4. **Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Client-Side Export** Ø¯Ø± Next.js Admin Panel

Ø§ÛŒÙ† Best Practice Ø³Ø§Ù„ 2025 Ù‡Ø³Øª! ğŸš€