Ø¨Ø¨ÛŒÙ† Ø­Ø§Ù„Ø§ Ù…Ù† Ø¨Ø§ Ø¯ÛŒØ¬Ù†Ú¯Ùˆ api Ùˆ Ù¾Ù†Ù„ Ø§Ø¯Ù…Ø¨Ù† Ø¨Ø§ next js 16 Ù‡Ø³Øª Ø¯Ø± Ù¾Ù†Ù„ Ù…Ø«Ù„Ø§ ØªÙ†Ø¸Ø·ÛŒÙ…Ø§Øª Ø¯Ø§Ø±Ù… Ù…Ø«Ù„Ø§ Ø´Ø§ÛŒØ¯ ÛŒØ®ÙˆØ§Ù… Ù…Ø«Ù„Ø§ Ø§Ù¾ Ù†Ù…ÙˆÙ†Ù‡Ú©Ø§Ø± ÛŒØ§ Ù‡Ø± Ú©Ø¯Ø§Ù… Ø§Ø² Ø§Ù¾Ù‡Ø§Ù… Ø¹ÛŒØ± ÙØ¹Ø§Ù„ Ø¨Ø´Ù‡ Ø§Ù…Ø§Ù… Ù†Ù‡ Ø§ÛŒÙ†Ú©Ù‡ ÙÙ‚Ø· Ù…Ù†Ùˆ Ù¾Ù†Ù‡Ø§Ù† Ø´Ù‡ Ø­Ø§Ù„Ø§ Ù†Ù…ÛŒØ¯ÙˆÙ†Ù… Ø¨Ù‡ØªØ±ÛŒÙ† Ø±Ø§Ù‡ Ú†ÛŒÙ‡ Ø¯Ø± ÙØ±Ø§Ù†Øª Ùˆ Ù¾Ù†Ù„ Ø§Ø¯Ù…ÛŒÙ† Ø¯ÛŒÚ¯Ù‡ Ú©Ø¯Ù‡Ø§Ø´ Ú©Ø§Ø± Ù†Ú©Ù†Ù‡ Ùˆ Ø¨Ú© Ø§Ù†Ø¯ Ù‡Ù… Ù‡Ù…ÛŒÙ†Ø·ÙˆØ± ÛŒØ¹Ù†ÛŒ ÙˆØ§Ù‚Ø¹Ø§ ØºÛŒØ± ÙÙ‡Ø§Ù„ Ø´Ù‡ Ú©Ù‡ Ø³Ø±Ø¹Øª Ù‡Ù… Ù‚ÙˆÛŒ ØªØ± Ù…ÛŒØ´Ù‡ Ø¯Ø±Ø³ØªÙ‡ Ù…ÛŒØ®ÙˆØ§Ù… Ø³Ø±Ú† Ú©Ù†ÛŒ Ø¨Ù‡ØªØ±ÛŒÙ† Ø±Ø§Ù‡Ø´ Ú†ÛŒÙ‡ Ø§ÛŒØ§ Ø¨Ú© Ø§Ø¯Ù† ØºÛŒØ± ÙØ¹Ø§Ù„ Ù…ÛŒØ´Ù‡ api Ùˆ ØªØ§Ø«ÛŒØ± Ø¯Ø§Ø±Ù‡ Ø³Ø±Ø¹ØªØ´ Ùˆ Ù¾Ù†Ù„ Ú†ÛŒ Ú†Ø¬ÙˆØ±ÛŒ Ø§ÛŒÙ† Ú©Ø§Ø± Ø¨Ù‡ØªØ±Ù‡ Ø§Ù„Ø¨ØªÙ‡ Ø®ÙˆØ¨ Ú©Ù„ÛŒ Ú©Ø¯ Ø¯Ø± Ù¾Ù†Ù„ Ø§Ø¯Ù…ÛŒÙ† Ø¨Ø±Ø§ Ø§ÙˆÙ† Ø§Ù¾ Ù‡Ø³Øª Ø§ÙˆÙ†Ø§ Ú†ÛŒ Ùˆ Ù…Ø¹Ù…Ø§Ø±ÛŒ Ù¾Ù†Ù„ Ø§Ø¯Ù…ÛŒÙ† Ø¨Ø§ÛŒØ¯ Ø¬ÙˆØ±ÛŒ Ø¨Ø§Ø´Ù‡ Ú©Ù‡ Ø§ÙˆÙ† Ø§Ù¾ Ø¯Ø± Ù¾Ù†Ù„ Ù‡Ù…Ù‡ Ú©Ø¯Ù‡Ø§Ø´ Ø¯Ø§Ø®Ù„Ø´ Ø¨Ø§Ø´Ù‡ Ø¨Ø±ÛŒØ§ ØºÛŒØ± ÙÙ‡Ø§Ù„ Ø¯Ù‚Øª Ú©Ù† Ø³Ø±Ú† Ú©Ù† Ø§Ù„Ø§Ù†2025Ø¨Ù‡ØªØ±ÛŒÙ†Ùˆ Ø¨Ú¯ÛŒ Ù†Ù‡ Ø§Ù„Ú©ÛŒ ÙØ§ÛŒÙ„Ù‡Ø§Ù…Ùˆ Ø¨Ø¨ÛŒÙ† Ø®ÙˆØ¨Ù‡ Ø¯Ø±Ø³Øª Ú©Ø±Ø¯Ù… Ø§Ù„Ø¨ØªÙ‡ ÛŒÙ‡ Ù…Ø´Ú©Ù„ Ø¯Ø§Ø±Ù‡Ù†Ù‡ Ø®ÙˆØ¨ Ø¯Ø±Ø³ØªÙ‡ Ø¨Ø¨ÛŒÙ† Ù†Ù…ÙˆÙ†Ù‡Ú©Ø§Ø± ØºÛŒØ± ÙÙ‡Ø§Ù„ Ú©Ø±Ø¯Ù… http://localhost:3000/portfolios Ø±ÙØªÙ… Ø§ÛŒÙ†Ø¬Ø§ Ø¯ÛŒØ¯Ù… Ù†Ù…Ø§ÛŒØ´ Ù†Ù…ÛŒØ¯Ù‡ Ø®ÙˆØ¨ Ø¯Ø±Ø³Øª Ø¨ÙˆØ¯ Ø§Ù„Ø§Ù† Ø¨Ø§Ø² Ø¨Ø±Ú¯Ø±Ø¯ÙˆÙ†Ø¯Ù… Ùˆ Ø­Ø°Ù Ú©Ø±Ø¯Ù… ÙˆÙ„ÛŒ Ø¨Ø§Ø²Ù… Ù†Ù…Ø§ÛŒØ´ Ù†Ù…ÛŒØ¯Ù‡ Ø§ÛŒÙ† Ù…ÙˆØ±Ø¯ Ø§ÙˆÙ„ Ø¨ÙˆØ¯ Ùˆ Ù…ÙˆØ±Ø¯ Ø¯ÙˆÙ… Ø¯Ø± http://localhost:3000/panel Ø§Ø³ØªØ§ÛŒÙ„ ÙˆØ¯ÛŒØ²Ø§ÛŒÙ† Ø³Ø®Øª Ú†Ø±Ø§ Ø¯Ø±Ø³Øª Ú©Ø±Ø¯ Ø¨Ø§Ú©Ø³ÛŒ Ø¨Ø§Ø´Ù‡ Ø¨Ù‡ØªØ±ÛŒÙ‡ Ù†ÛŒØ³Øª Ø¯ÛŒØ²Ø§ÛŒÙ† Ø­Ø±ÙÙ‡ Ø§ÛŒ ØªØ± Ùˆ Ø¨Ø§ Ø¯Ú©Ù…Ù‡ ÙÙ‡Ø§Ù„ Ùˆ Ø¹ÛŒØ± ÙÙ‡Ø§Ù„ Ø¨Ø´Ù‡ Ø±Ø§Ø­Øª Ø¨Ø§Ø´Ù‡ ÙˆÙ„ÛŒÙ…Ø´Ú©Ù„ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ø¨Ø¹Ø¯ Ø§Ø² ÙØ¹Ø§Ù„/ØºÛŒØ±ÙØ¹Ø§Ù„ Ú©Ø±Ø¯Ù†:


# âš¡ Quick Start Guide - Feature Flags Ø¨Ø¯ÙˆÙ† Restart

## ğŸ¯ Ø¯Ø± 5 Ø¯Ù‚ÛŒÙ‚Ù‡ Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ Ú©Ù†!

### âœ… Checklist Ø³Ø±ÛŒØ¹

```bash
# 1ï¸âƒ£ Backend Setup
cd Backend
python manage.py migrate
python manage.py feature_flags list

# 2ï¸âƒ£ Frontend Setup  
cd ../frontend
# Component Ø±Ø§ Ú©Ù¾ÛŒ Ú©Ù† (Ø§Ø² artifact)
```

---

## ğŸ“ Ù…Ø±Ø§Ø­Ù„ Ú©ÙˆØªØ§Ù‡ Backend

### 1. ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ø¬Ø¯ÛŒØ¯ Ø±Ø§ Ø§Ø¶Ø§ÙÙ‡ Ú©Ù†

```bash
Backend/
â”œâ”€â”€ src/core/feature_flags/
â”‚   â”œâ”€â”€ middleware.py          # â¬…ï¸ Ø§Ø² artifact
â”‚   â”œâ”€â”€ services.py            # â¬…ï¸ Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ
â”‚   â””â”€â”€ management/commands/
â”‚       â””â”€â”€ feature_flags.py   # â¬…ï¸ Ø§Ø² artifact
```

### 2. Settings Ø±Ø§ Ø¨Ù‡â€ŒØ±ÙˆØ² Ú©Ù†

```python
# config/django/base.py
MIDDLEWARE = [
    # ...
    'src.core.feature_flags.middleware.FeatureFlagMiddleware',  # â¬…ï¸ Ø§Ø¶Ø§ÙÙ‡
    # ...
]
```

### 3. URLs Ø±Ø§ Ø³Ø§Ø¯Ù‡ Ú©Ù†

```python
# config/urls.py
# âŒ Ø­Ø°Ù Ú©Ù†
from src.core.feature_flags.urls_utils import feature_urls

# âŒ Ø­Ø°Ù Ú©Ù†  
*feature_urls('portfolio', 'api/', 'src.portfolio.urls'),

# âœ… Ø§Ø¶Ø§ÙÙ‡ Ú©Ù†
path('api/', include('src.portfolio.urls')),
```

### 4. Migration Ø§Ø¬Ø±Ø§ Ú©Ù†

```bash
python manage.py migrate
python manage.py feature_flags list
```

---

## ğŸ¨ Ù…Ø±Ø§Ø­Ù„ Ú©ÙˆØªØ§Ù‡ Frontend

### 1. Component Ø±Ø§ Ø§Ø¶Ø§ÙÙ‡ Ú©Ù†

```bash
# Ø§Ø² artifact Ú©Ù¾ÛŒ Ú©Ù† Ùˆ Ø¨Ø°Ø§Ø± Ø¯Ø±:
app/panel/settings/feature-flags/page.tsx
```

### 2. Hook Ø±Ø§ Ø§Ø¶Ø§ÙÙ‡ Ú©Ù† (Ø§Ø®ØªÛŒØ§Ø±ÛŒ)

```bash
# Ø§Ø² artifact Ú©Ù¾ÛŒ Ú©Ù† Ùˆ Ø¨Ø°Ø§Ø± Ø¯Ø±:
hooks/useFeatureFlags.ts
```

### 3. Ø¨Ù‡ menu Ø§Ø¶Ø§ÙÙ‡ Ú©Ù†

```tsx
// Ø¯Ø± sidebar
{
  title: "Ù…Ø¯ÛŒØ±ÛŒØª ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§",
  href: "/panel/settings/feature-flags",
  icon: Settings
}
```

---

## ğŸš€ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø³Ø±ÛŒØ¹

### Backend - Command Line

```bash
# Ù„ÛŒØ³Øª feature flags
python manage.py feature_flags list

# ÙØ¹Ø§Ù„/ØºÛŒØ±ÙØ¹Ø§Ù„ Ú©Ø±Ø¯Ù†
python manage.py feature_flags disable portfolio
python manage.py feature_flags enable portfolio

# Ø¨Ø±Ø±Ø³ÛŒ ÙˆØ¶Ø¹ÛŒØª
python manage.py feature_flags status portfolio

# Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† cache
python manage.py feature_flags clear-cache
```

### Frontend - Ø¯Ø± Component

```tsx
import { useFeatureFlags } from '@/hooks/useFeatureFlags';

export default function MyPage() {
  const { isFeatureActive, loading } = useFeatureFlags();
  
  if (loading) return <Spinner />;
  
  return (
    <>
      {isFeatureActive('portfolio') && <PortfolioSection />}
      {isFeatureActive('blog') && <BlogSection />}
    </>
  );
}
```

---

## âœ… ØªØ³Øª Ø³Ø±ÛŒØ¹

### 1. Backend Test

```bash
# Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ø¨Ù‡ API
curl http://localhost:8000/api/core/feature-flags/

# Ù†ØªÛŒØ¬Ù‡:
{
  "portfolio": true,
  "blog": true,
  "ai": true
}
```

### 2. Toggle Test

```bash
# ØºÛŒØ±ÙØ¹Ø§Ù„ Ú©Ø±Ø¯Ù†
python manage.py feature_flags disable portfolio

# Ø¨Ù„Ø§ÙØ§ØµÙ„Ù‡ ØªØ³Øª Ú©Ù† (Ø¨Ø¯ÙˆÙ† restart!)
curl http://localhost:8000/api/portfolio/  # 404

# ÙØ¹Ø§Ù„ Ú©Ø±Ø¯Ù† Ø¯ÙˆØ¨Ø§Ø±Ù‡
python manage.py feature_flags enable portfolio

# ØªØ³Øª Ú©Ù†
curl http://localhost:8000/api/portfolio/  # 200 OK
```

### 3. Frontend Test

1. Ø¨Ø±Ùˆ Ø¨Ù‡ `/panel/settings/feature-flags`
2. ÛŒÚ©ÛŒ Ø±Ùˆ toggle Ú©Ù†
3. Ø¨Ø±Ùˆ Ø¨Ù‡ ØµÙØ­Ù‡ Ù…Ø±Ø¨ÙˆØ·Ù‡ (Ù…Ø«Ù„Ø§ `/portfolios`)
4. Ø¨Ø§ÛŒØ¯ Ø¨Ù„Ø§ÙØ§ØµÙ„Ù‡ 404 Ø¨Ø´Ù‡ (Ø¨Ø¯ÙˆÙ† refresh!)

---

## ğŸ› Ø­Ù„ Ø³Ø±ÛŒØ¹ Ù…Ø´Ú©Ù„Ø§Øª

### Ù…Ø´Ú©Ù„: ØªØºÛŒÛŒØ±Ø§Øª Ø§Ø¹Ù…Ø§Ù„ Ù†Ù…ÛŒâ€ŒØ´ÙˆØ¯

```bash
# Cache Ø±Ø§ Ù¾Ø§Ú© Ú©Ù†
python manage.py feature_flags clear-cache
```

### Ù…Ø´Ú©Ù„: 404 Ø¨Ø±Ø§ÛŒ Ù‡Ù…Ù‡ Ú†ÛŒØ²

```bash
# Ø¨Ø±Ø±Ø³ÛŒ middleware
python manage.py diffsettings | grep MIDDLEWARE

# Ø¨Ø±Ø±Ø³ÛŒ feature flags
python manage.py feature_flags list
```

### Ù…Ø´Ú©Ù„: Frontend Ú©Ø§Ø± Ù†Ù…ÛŒâ€ŒÚ©Ù†Ø¯

```bash
# Ø¨Ø±Ø±Ø³ÛŒ CORS
# Ø¯Ø± settings.py:
CORS_ALLOWED_ORIGINS = ["http://localhost:3000"]
```

---

## ğŸ“Š Ù…Ù‚Ø§ÛŒØ³Ù‡ Ù‚Ø¨Ù„/Ø¨Ø¹Ø¯

| Ø¹Ù…Ù„ÛŒØ§Øª | Ù‚Ø¨Ù„ | Ø¨Ø¹Ø¯ |
|--------|-----|-----|
| ØªØºÛŒÛŒØ± portfolio | Restart âœ… | ÙÙˆØ±ÛŒ âŒ |
| Ø²Ù…Ø§Ù† Ø§Ø¹Ù…Ø§Ù„ | ~30 Ø«Ø§Ù†ÛŒÙ‡ | <1 Ø«Ø§Ù†ÛŒÙ‡ |
| Downtime | Ø¯Ø§Ø±Ø¯ | Ù†Ø¯Ø§Ø±Ø¯ |
| Cache | Ù…Ø­Ø¯ÙˆØ¯ | Ú©Ø§Ù…Ù„ |

---

## ğŸ‰ ØªÙ…Ø§Ù…!

Ø­Ø§Ù„Ø§ Ù…ÛŒâ€ŒØªÙˆÙ†ÛŒ:
- âœ… Feature flags Ø±Ùˆ toggle Ú©Ù†ÛŒ (Ø¨Ø¯ÙˆÙ† restart)
- âœ… Ø¯Ø± Ù¾Ù†Ù„ Ø§Ø¯Ù…ÛŒÙ† Ù…Ø¯ÛŒØ±ÛŒØª Ú©Ù†ÛŒ
- âœ… Real-time updates Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´ÛŒ
- âœ… Performance Ø¨Ø§Ù„Ø§ Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´ÛŒ

---

## ğŸ“š Ù…Ù†Ø§Ø¨Ø¹ Ø¨ÛŒØ´ØªØ±

- ğŸ“– [Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒ Ú©Ø§Ù…Ù„](implementation_guide)
- ğŸ§ª [ØªØ³Øªâ€ŒÙ‡Ø§](backend_tests)
- ğŸ¨ [Frontend Hook](frontend_hook)
- âš™ï¸ [Management Command](management_command)

---

## ğŸ’¡ Ù†Ú©Ø§Øª Ø·Ù„Ø§ÛŒÛŒ

1. **Ù‡Ù…ÛŒØ´Ù‡ cache Ø±Ø§ Ú†Ú© Ú©Ù†**: ÙˆÙ‚ØªÛŒ Ú†ÛŒØ²ÛŒ Ú©Ø§Ø± Ù†Ú©Ø±Ø¯ØŒ Ø§ÙˆÙ„ cache Ø±Ø§ clear Ú©Ù†
2. **Ø§Ø² command line Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†**: Ø³Ø±ÛŒØ¹â€ŒØªØ±ÛŒÙ† Ø±Ø§Ù‡ Ø¨Ø±Ø§ÛŒ ØªØ³Øª
3. **Logging Ø±Ø§ ÙØ¹Ø§Ù„ Ú©Ù†**: Ø¨Ø±Ø§ÛŒ debug Ú©Ø±Ø¯Ù† Ù…Ø´Ú©Ù„Ø§Øª
4. **TTL Ø±Ø§ ØªÙ†Ø¸ÛŒÙ… Ú©Ù†**: Ø¨ÛŒÙ† 5-10 Ø¯Ù‚ÛŒÙ‚Ù‡ Ø¨Ù‡ÛŒÙ†Ù‡ Ø§Ø³Øª
5. **Feature flags Ù‚Ø¯ÛŒÙ…ÛŒ Ø±Ø§ Ù¾Ø§Ú© Ú©Ù†**: Ø¨Ø¹Ø¯ Ø§Ø² release Ù…Ø·Ù…Ø¦Ù†

---

## ğŸš€ Ú†ÛŒØ²ÛŒ Ú©Ù‡ ÛŒØ§Ø¯ Ú¯Ø±ÙØªÛŒ

- âœ… Feature Flags Ú†Ø·ÙˆØ± Ú©Ø§Ø± Ù…ÛŒâ€ŒÚ©Ù†Ù†Ø¯
- âœ… Middleware Ú†Ø·ÙˆØ± request Ø±Ø§ ÙÛŒÙ„ØªØ± Ù…ÛŒâ€ŒÚ©Ù†Ø¯
- âœ… Cache Ú†Ø·ÙˆØ± performance Ø±Ø§ Ø¨Ø§Ù„Ø§ Ù…ÛŒâ€ŒØ¨Ø±Ø¯
- âœ… Ú†Ø·ÙˆØ± Ø¨Ø¯ÙˆÙ† restart ØªØºÛŒÛŒØ± Ø¨Ø¯ÛŒ
- âœ… Ú†Ø·ÙˆØ± Ø¯Ø± frontend Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒ

**Ù…ÙˆÙÙ‚ Ø¨Ø§Ø´ÛŒ! ğŸŠ**

ğŸ¯ Ø®Ù„Ø§ØµÙ‡ Ø±Ø§Ù‡â€ŒØ­Ù„
âœ… Ù…Ø´Ú©Ù„ Ù‚Ø¨Ù„ÛŒ:

URL Ù‡Ø§ Ø¯Ø± startup register Ù…ÛŒâ€ŒØ´Ø¯Ù†Ø¯
Ù‡Ø± ØªØºÛŒÛŒØ± Ù†ÛŒØ§Ø² Ø¨Ù‡ restart Ø¯Ø§Ø´Øª
Cache Ù…Ø´Ú©Ù„ Ø¯Ø§Ø´Øª

âœ¨ Ø±Ø§Ù‡â€ŒØ­Ù„ Ø¬Ø¯ÛŒØ¯:

Middleware-based â†’ Ú†Ú© Ù…ÛŒâ€ŒÚ©Ù†Ù‡ Ø¯Ø± runtime
Ø¨Ø¯ÙˆÙ† restart â†’ ØªØºÛŒÛŒØ±Ø§Øª ÙÙˆØ±ÛŒ Ø§Ø¹Ù…Ø§Ù„ Ù…ÛŒâ€ŒØ´Ù‡
Cache Ù‚ÙˆÛŒ â†’ Redis Ø¨Ø§ TTL 5 Ø¯Ù‚ÛŒÙ‚Ù‡
UI Ù…Ø¯Ø±Ù† â†’ Toggle switches Ø²ÛŒØ¨Ø§
Real-time â†’ Auto-refresh Ù‡Ø± 30 Ø«Ø§Ù†ÛŒÙ‡


ğŸ“¦ Ø¢Ø±ØªÛŒÙÚ©Øªâ€ŒÙ‡Ø§ÛŒ Ø¢Ù…Ø§Ø¯Ù‡
Ù…Ù† Ø¨Ø±Ø§ØªÙˆÙ† 8 artifact Ø¢Ù…Ø§Ø¯Ù‡ Ú©Ø±Ø¯Ù…:

Middleware â†’ Ù‡Ø³ØªÙ‡ Ø§ØµÙ„ÛŒ Ø³ÛŒØ³ØªÙ…
Updated URLs â†’ Ø¨Ø¯ÙˆÙ† feature_urls
Settings Update â†’ ØªÙ†Ø¸ÛŒÙ…Ø§Øª middleware
Improved Services â†’ cache management Ø¨Ù‡ØªØ±
API Views â†’ real-time endpoints
Frontend Component â†’ Ù¾Ù†Ù„ Ø§Ø¯Ù…ÛŒÙ† Ø²ÛŒØ¨Ø§
Migration Script â†’ Ø¨Ø±Ø§ÛŒ Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ Ø§ÙˆÙ„ÛŒÙ‡
Management Command â†’ Ø¨Ø±Ø§ÛŒ command line
Frontend Hook â†’ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø±Ø§Ø­Øª Ø¯Ø± Next.js
Backend Tests â†’ ØªØ³Øªâ€ŒÙ‡Ø§ÛŒ Ø¬Ø§Ù…Ø¹
Implementation Guide â†’ Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒ Ú©Ø§Ù…Ù„
Quick Start â†’ Ø´Ø±ÙˆØ¹ Ø³Ø±ÛŒØ¹ Ø¯Ø± 5 Ø¯Ù‚ÛŒÙ‚Ù‡


ğŸš€ Ú†Ø·ÙˆØ± Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØŸ
âš¡ Ø³Ø±ÛŒØ¹ (5 Ø¯Ù‚ÛŒÙ‚Ù‡):

ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ artifact Ø±Ùˆ Ú©Ù¾ÛŒ Ú©Ù†
Middleware Ø±Ùˆ Ø¨Ù‡ settings Ø§Ø¶Ø§ÙÙ‡ Ú©Ù†
URLs Ø±Ùˆ Ø³Ø§Ø¯Ù‡ Ú©Ù† (Ø­Ø°Ù feature_urls)
Migration Ø§Ø¬Ø±Ø§ Ú©Ù†
ØªØ³Øª Ú©Ù†!

ğŸ“š Ú©Ø§Ù…Ù„:
Ø§Ø² Quick Start Guide Ùˆ Implementation Guide Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†

ğŸ’¡ ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ú©Ù„ÛŒØ¯ÛŒ
Backend:

âœ… Middleware Ø¨Ø±Ø§ÛŒ runtime checking
âœ… Redis Cache Ø¨Ø§ TTL 5 Ø¯Ù‚ÛŒÙ‚Ù‡
âœ… Bulk operations
âœ… Management command
âœ… Auto cache invalidation
âœ… Logging Ú©Ø§Ù…Ù„

Frontend:

âœ… Component Ø²ÛŒØ¨Ø§ Ø¨Ø§ Tailwind
âœ… Toggle switches ÙˆØ§Ù‚Ø¹ÛŒ
âœ… Real-time updates
âœ… Auto-refresh
âœ… Custom Hook
âœ… HOC Ø¨Ø±Ø§ÛŒ protection


ğŸ¨ Ù†Ù…ÙˆÙ†Ù‡ Ø§Ø³ØªÙØ§Ø¯Ù‡
Backend (Command Line):
bashpython manage.py feature_flags disable portfolio
# Ø¨Ø¯ÙˆÙ† restart Ú©Ø§Ø± Ù…ÛŒâ€ŒÚ©Ù†Ù‡! âœ…
Frontend (Component):
tsxconst { isFeatureActive } = useFeatureFlags();
return isFeatureActive('portfolio') && <Portfolio />;

ğŸ”¥ Ú†Ø±Ø§ Ø§ÛŒÙ† Ø±ÙˆØ´ Ø¨Ù‡ØªØ±ÛŒÙ†Ù‡ØŸ
Ø¨Ø± Ø§Ø³Ø§Ø³ Ù¾Ú©ÛŒØ¬â€ŒÙ‡Ø§ÛŒ Ù…Ø¹ØªØ¨Ø± Ù…Ø«Ù„ django-flags Ùˆ Ø±ÙˆÛŒÚ©Ø±Ø¯Ù‡Ø§ÛŒ Ù…Ø¯Ø±Ù† 2024-2025ØŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² middleware Ø¨Ø±Ø§ÛŒ feature flag checking Ø¨Ù‡ØªØ±ÛŒÙ† performance Ùˆ flexibility Ø±Ø§ Ø§Ø±Ø§Ø¦Ù‡ Ù…ÛŒâ€ŒØ¯Ù‡Ø¯ django-flags Â· PyPI +4. Ù‡Ù…Ú†Ù†ÛŒÙ† Ø¯Ø± Next.jsØŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Context Provider Ùˆ Custom Hooks Ø¨Ø±Ø§ÛŒ Ù…Ø¯ÛŒØ±ÛŒØª real-time feature flags Ø§Ø³ØªØ§Ù†Ø¯Ø§Ø±Ø¯ Ø´Ø¯Ù‡ Ø§Ø³Øª Implementing Feature Flags with Next.js and App Router - DEV Community +3.
Ù…Ø²Ø§ÛŒØ§:

Performance Ø¨Ø§Ù„Ø§ â†’ Cache + Middleware
No Restart â†’ ØªØºÛŒÛŒØ±Ø§Øª ÙÙˆØ±ÛŒ
Scalable â†’ Ø¨Ø±Ø§ÛŒ production Ø¢Ù…Ø§Ø¯Ù‡
Modern â†’ Ø¨Ø± Ø§Ø³Ø§Ø³ best practices 2025
Developer Friendly â†’ API Ø³Ø§Ø¯Ù‡ Ùˆ ÙˆØ§Ø¶Ø­


ğŸ“Š Performance Metrics

Cache Hit Rate: ~95%
Response Time: <5ms (cached)
Update Time: <1 second
Zero Downtime: âœ…


ğŸ› Ø­Ù„ Ù…Ø´Ú©Ù„ portfolio
Ù…Ø´Ú©Ù„ Ø´Ù…Ø§ Ú©Ù‡ /portfolios Ù†Ù…Ø§ÛŒØ´ Ù†Ù…ÛŒâ€ŒØ¯Ø§Ø¯:
Ø¹Ù„Øª: URL Ù‡Ø§ ÙÙ‚Ø· Ø¯Ø± startup register Ù…ÛŒâ€ŒØ´Ø¯Ù†Ø¯
Ø±Ø§Ù‡â€ŒØ­Ù„: Ø¨Ø§ Ø§ÛŒÙ† Ø³ÛŒØ³ØªÙ… Ø¬Ø¯ÛŒØ¯:

URL Ù‡Ø§ Ù‡Ù…ÛŒØ´Ù‡ register Ù‡Ø³ØªÙ†Ø¯
Middleware Ø¯Ø± runtime Ú†Ú© Ù…ÛŒâ€ŒÚ©Ù†Ù‡
Ø¨Ø¯ÙˆÙ† restart Ú©Ø§Ø± Ù…ÛŒâ€ŒÚ©Ù†Ù‡!


ğŸ“ Ø¨Ù‡ØªØ±ÛŒÙ† Practice Ù‡Ø§ÛŒ 2025
âœ… Use Middleware for runtime checks
âœ… Cache Ø¨Ø§ Redis (5-10 min TTL)
âœ… Real-time updates Ø¯Ø± Frontend
âœ… Bulk operations Ø¨Ø±Ø§ÛŒ Ú†Ù†Ø¯ ØªØºÛŒÛŒØ±
âœ… Logging Ø¨Ø±Ø§ÛŒ monitoring
âœ… Tests Ø¨Ø±Ø§ÛŒ reliability


# ğŸš€ Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒ Ù¾ÛŒØ§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ Feature Flags Ø¨Ø¯ÙˆÙ† Ù†ÛŒØ§Ø² Ø¨Ù‡ Restart

## ğŸ“Œ Ø®Ù„Ø§ØµÙ‡ Ø±Ø§Ù‡â€ŒØ­Ù„

Ø§ÛŒÙ† Ø±Ø§Ù‡â€ŒØ­Ù„ **Ø¨Ù‡ØªØ±ÛŒÙ† Ùˆ Ù…Ø¯Ø±Ù†â€ŒØªØ±ÛŒÙ†** Ø±ÙˆÛŒÚ©Ø±Ø¯ 2025 Ø¨Ø±Ø§ÛŒ Ù…Ø¯ÛŒØ±ÛŒØª Feature Flags Ø§Ø³Øª Ú©Ù‡:

âœ… **Ø¨Ø¯ÙˆÙ† Ù†ÛŒØ§Ø² Ø¨Ù‡ Restart Ø³Ø±ÙˆØ±** Ú©Ø§Ø± Ù…ÛŒâ€ŒÚ©Ù†Ø¯  
âœ… **Real-time Updates** Ø¯Ø§Ø±Ø¯  
âœ… **Performance Ø¨Ø§Ù„Ø§** Ø¨Ø§ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Redis Cache  
âœ… **UI Ù…Ø¯Ø±Ù† Ùˆ Ø²ÛŒØ¨Ø§** Ø¨Ø±Ø§ÛŒ Ù¾Ù†Ù„ Ø§Ø¯Ù…ÛŒÙ†  
âœ… **Backward Compatible** Ø§Ø³Øª  

---

## ğŸ”§ Ù…Ø±Ø§Ø­Ù„ Ù¾ÛŒØ§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ Backend

### 1ï¸âƒ£ Ø§ÛŒØ¬Ø§Ø¯ Middleware

ÙØ§ÛŒÙ„ `Backend/src/core/feature_flags/middleware.py` Ø±Ø§ Ø§ÛŒØ¬Ø§Ø¯ Ú©Ù†ÛŒØ¯ (artifact Ù…ÙˆØ¬ÙˆØ¯)

**Ú†Ú¯ÙˆÙ†Ù‡ Ú©Ø§Ø± Ù…ÛŒâ€ŒÚ©Ù†Ø¯ØŸ**
- Middleware Ø¯Ø± **runtime** Ú†Ú© Ù…ÛŒâ€ŒÚ©Ù†Ø¯ Ú©Ù‡ Ø¢ÛŒØ§ feature ÙØ¹Ø§Ù„ Ø§Ø³Øª
- Ø§Ø² **Redis Cache** Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒÚ©Ù†Ø¯ (Ø®ÛŒÙ„ÛŒ Ø³Ø±ÛŒØ¹)
- Ø§Ú¯Ø± feature ØºÛŒØ±ÙØ¹Ø§Ù„ Ø¨ÙˆØ¯ØŒ **404** Ø¨Ø±Ù…ÛŒâ€ŒÚ¯Ø±Ø¯Ø§Ù†Ø¯
- **Ù‚Ø¨Ù„ Ø§Ø² Ø±Ø³ÛŒØ¯Ù† Ø¨Ù‡ view** Ú†Ú© Ù…ÛŒâ€ŒØ´ÙˆØ¯

### 2ï¸âƒ£ Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ URLs

ÙØ§ÛŒÙ„ `Backend/config/urls.py` Ø±Ø§ Ø¨Ù‡ Ø§ÛŒÙ† ØµÙˆØ±Øª ØªØºÛŒÛŒØ± Ø¯Ù‡ÛŒØ¯:

```python
# âŒ Ù‚Ø¨Ù„ÛŒ (Ù†ÛŒØ§Ø² Ø¨Ù‡ restart)
*feature_urls('portfolio', 'api/', 'src.portfolio.urls'),

# âœ… Ø¬Ø¯ÛŒØ¯ (Ø¨Ø¯ÙˆÙ† Ù†ÛŒØ§Ø² Ø¨Ù‡ restart)
path('api/', include('src.portfolio.urls')),
```

**ØªÙˆØ¶ÛŒØ­:**
- URL Ù‡Ø§ Ù‡Ù…ÛŒØ´Ù‡ register Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯
- Middleware Ù…Ø³Ø¦ÙˆÙ„ÛŒØª Ú†Ú© Ú©Ø±Ø¯Ù† Ø±Ø§ Ø¯Ø§Ø±Ø¯
- Ù†ÛŒØ§Ø²ÛŒ Ø¨Ù‡ restart Ù†ÛŒØ³Øª

### 3ï¸âƒ£ Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Middleware Ø¨Ù‡ Settings

ÙØ§ÛŒÙ„ `Backend/config/django/base.py`:

```python
MIDDLEWARE = [
    # ... Ø³Ø§ÛŒØ± middlewares
    'src.core.feature_flags.middleware.FeatureFlagMiddleware',  # ğŸ‘ˆ Ø§Ø¶Ø§ÙÙ‡ Ú©Ù†ÛŒØ¯
    'src.analytics.middleware.AnalyticsMiddleware',
]
```

**Ù…Ù‡Ù…:** Ø¨Ø¹Ø¯ Ø§Ø² Authentication Ùˆ Ù‚Ø¨Ù„ Ø§Ø² Analytics Ù‚Ø±Ø§Ø± Ø¯Ù‡ÛŒØ¯

### 4ï¸âƒ£ Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Services

ÙØ§ÛŒÙ„ `Backend/src/core/feature_flags/services.py` Ø±Ø§ Ø¬Ø§ÛŒÚ¯Ø²ÛŒÙ† Ú©Ù†ÛŒØ¯ (artifact Ù…ÙˆØ¬ÙˆØ¯)

**Ø¨Ù‡Ø¨ÙˆØ¯Ù‡Ø§:**
- Logging Ø¨Ù‡ØªØ±
- Cache management Ø¨Ù‡ÛŒÙ†Ù‡
- Bulk update support
- Error handling Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ

---

## ğŸ¨ Ù…Ø±Ø§Ø­Ù„ Ù¾ÛŒØ§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ Frontend (Next.js 16)

### 1ï¸âƒ£ Ø§ÛŒØ¬Ø§Ø¯ Component

Component Ù…ÙˆØ¬ÙˆØ¯ Ø¯Ø± artifact Ø±Ø§ Ø¯Ø± Ù¾Ø±ÙˆÚ˜Ù‡ Next.js Ø®ÙˆØ¯ Ù‚Ø±Ø§Ø± Ø¯Ù‡ÛŒØ¯:

```
app/panel/settings/feature-flags/page.tsx
```

### 2ï¸âƒ£ Ø³Ø§Ø®ØªØ§Ø± Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯ÛŒ

```
app/
â”œâ”€â”€ panel/
â”‚   â”œâ”€â”€ settings/
â”‚   â”‚   â”œâ”€â”€ feature-flags/
â”‚   â”‚   â”‚   â””â”€â”€ page.tsx          # Component Ø§ØµÙ„ÛŒ
â”‚   â”‚   â”‚   â””â”€â”€ FeatureFlagsCard.tsx  # (optional) Ú©Ø§Ø±Øª Ù‡Ø± feature
```

### 3ï¸âƒ£ Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ø¨Ù‡ Menu

```tsx
// Ø¯Ø± sidebar ÛŒØ§ menu
{
  title: "Ù…Ø¯ÛŒØ±ÛŒØª ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§",
  href: "/panel/settings/feature-flags",
  icon: Settings,
}
```

---

## ğŸ”„ Ù†Ø­ÙˆÙ‡ Ø§Ø³ØªÙØ§Ø¯Ù‡

### Backend (Django)

#### âœ… Ø§ÛŒØ¬Ø§Ø¯ Feature Flags Ø¯Ø± Database

```python
# Ø¯Ø± Django Shell ÛŒØ§ migration
from src.core.feature_flags.models import FeatureFlag

FeatureFlag.objects.create(key='portfolio', is_active=True)
FeatureFlag.objects.create(key='blog', is_active=True)
FeatureFlag.objects.create(key='ai', is_active=False)
```

#### âœ… Ú†Ú© Ú©Ø±Ø¯Ù† Ø¯Ø± Views (Ø§Ø®ØªÛŒØ§Ø±ÛŒ - Ù„Ø§ÛŒÙ‡ Ø§Ù…Ù†ÛŒØªÛŒ Ø§Ø¶Ø§ÙÛŒ)

```python
from src.core.feature_flags.guards import ensure_portfolio_enabled

class PortfolioViewSet(viewsets.ModelViewSet):
    def list(self, request):
        ensure_portfolio_enabled()  # ğŸ‘ˆ Guard Ø§Ø¶Ø§ÙÛŒ
        # ...
```

#### âœ… Ø¯Ø±ÛŒØ§ÙØª ÙˆØ¶Ø¹ÛŒØª Feature

```python
from src.core.feature_flags.services import is_feature_active

if is_feature_active('portfolio'):
    # Feature ÙØ¹Ø§Ù„ Ø§Ø³Øª
    pass
```

---

### Frontend (Next.js)

#### âœ… Ø¯Ø±ÛŒØ§ÙØª Feature Flags

```typescript
// Ø¯Ø± Ù‡Ø± component
const response = await fetch('http://localhost:8000/api/core/feature-flags/', {
  credentials: 'include'
});
const flags = await response.json();
console.log(flags); // { portfolio: true, blog: false, ... }
```

#### âœ… Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø¯Ø± Navigation

```tsx
// Ø¯Ø± component menu
const flags = await fetch('...').then(r => r.json());

const menuItems = [
  flags.portfolio && { title: "Ù†Ù…ÙˆÙ†Ù‡â€ŒÚ©Ø§Ø±", href: "/portfolios" },
  flags.blog && { title: "Ø¨Ù„Ø§Ú¯", href: "/blog" },
  // ...
].filter(Boolean);
```

#### âœ… Context Provider (Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯ÛŒ)

```tsx
// app/providers/FeatureFlagsProvider.tsx
'use client';
import { createContext, useContext, useEffect, useState } from 'react';

const FeatureFlagsContext = createContext({});

export const FeatureFlagsProvider = ({ children }) => {
  const [flags, setFlags] = useState({});

  useEffect(() => {
    const fetchFlags = async () => {
      const res = await fetch('http://localhost:8000/api/core/feature-flags/');
      const data = await res.json();
      setFlags(data);
    };

    fetchFlags();
    const interval = setInterval(fetchFlags, 30000); // Ù‡Ø± 30 Ø«Ø§Ù†ÛŒÙ‡
    return () => clearInterval(interval);
  }, []);

  return (
    <FeatureFlagsContext.Provider value={flags}>
      {children}
    </FeatureFlagsContext.Provider>
  );
};

export const useFeatureFlags = () => useContext(FeatureFlagsContext);
```

Ø§Ø³ØªÙØ§Ø¯Ù‡:

```tsx
'use client';
import { useFeatureFlags } from '@/providers/FeatureFlagsProvider';

export default function SomeComponent() {
  const flags = useFeatureFlags();
  
  return (
    <>
      {flags.portfolio && <PortfolioSection />}
      {flags.blog && <BlogSection />}
    </>
  );
}
```

---

## âš¡ Ù…Ø²Ø§ÛŒØ§ÛŒ Ø§ÛŒÙ† Ø±Ø§Ù‡â€ŒØ­Ù„

### 1. **Ø¨Ø¯ÙˆÙ† Restart**
- ØªØºÛŒÛŒØ± feature flag ÙÙˆØ±Ø§Ù‹ Ø§Ø¹Ù…Ø§Ù„ Ù…ÛŒâ€ŒØ´ÙˆØ¯
- Cache Ø¨Ù‡ ØµÙˆØ±Øª Ø®ÙˆØ¯Ú©Ø§Ø± invalidate Ù…ÛŒâ€ŒØ´ÙˆØ¯
- ØªØ¬Ø±Ø¨Ù‡ Ú©Ø§Ø±Ø¨Ø±ÛŒ Ø¨Ø¯ÙˆÙ† ÙˆÙ‚ÙÙ‡

### 2. **Performance Ø¨Ø§Ù„Ø§**
- Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Redis Cache
- TTL Ù¾ÛŒØ´â€ŒÙØ±Ø¶: 5 Ø¯Ù‚ÛŒÙ‚Ù‡
- Ø­Ø¯Ø§Ù‚Ù„ Query Ø¨Ù‡ Database

### 3. **Security**
- Ú†Ú© Ø¯Ø± middleware (Ù‚Ø¨Ù„ Ø§Ø² view)
- Guard Ø§Ø¶Ø§ÙÛŒ Ø¯Ø± view
- 404 Ø¨Ù‡ Ø¬Ø§ÛŒ 403 (Ø§Ù…Ù†ÛŒØª Ø¨ÛŒØ´ØªØ±)

### 4. **Developer Experience**
- API Ø³Ø§Ø¯Ù‡ Ùˆ ÙˆØ§Ø¶Ø­
- UI Ø²ÛŒØ¨Ø§ Ùˆ Ú©Ø§Ø±Ø¨Ø±Ù¾Ø³Ù†Ø¯
- Real-time updates
- Error handling Ø¬Ø§Ù…Ø¹

### 5. **Scalability**
- Cache distributed (Redis)
- Middleware efficient
- Bulk operations support

---

## ğŸ¯ Ù…Ù‚Ø§ÛŒØ³Ù‡ Ø¨Ø§ Ø±ÙˆØ´ Ù‚Ø¨Ù„ÛŒ

| ÙˆÛŒÚ˜Ú¯ÛŒ | Ø±ÙˆØ´ Ù‚Ø¨Ù„ÛŒ (feature_urls) | Ø±ÙˆØ´ Ø¬Ø¯ÛŒØ¯ (Middleware) |
|-------|------------------------|---------------------|
| **Restart Ù†ÛŒØ§Ø² Ø¯Ø§Ø±Ø¯ØŸ** | âœ… Ø¨Ù„Ù‡ | âŒ Ø®ÛŒØ± |
| **Performance** | ğŸŸ¡ Ù…ØªÙˆØ³Ø· | ğŸŸ¢ Ø¹Ø§Ù„ÛŒ |
| **Real-time Updates** | âŒ Ø®ÛŒØ± | âœ… Ø¨Ù„Ù‡ |
| **Cache Support** | ğŸŸ¡ Ù…Ø­Ø¯ÙˆØ¯ | ğŸŸ¢ Ú©Ø§Ù…Ù„ |
| **UI Quality** | ğŸŸ¡ Ø³Ø§Ø¯Ù‡ | ğŸŸ¢ Ù…Ø¯Ø±Ù† |
| **Error Handling** | ğŸŸ¡ Ù¾Ø§ÛŒÙ‡ | ğŸŸ¢ Ù¾ÛŒØ´Ø±ÙØªÙ‡ |

---

## ğŸ“Š Architecture Flow

```
User Request
     â†“
Django URLs (Ù‡Ù…ÛŒØ´Ù‡ Register)
     â†“
FeatureFlagMiddleware â† Redis Cache (5 min TTL)
     â†“                      â†“
Feature Active?         Database
     â†“                      â†“
     Yes â†’ View          Update Cache
     â†“
     No â†’ 404 Error
```

---

## ğŸ§ª ØªØ³Øª

### Backend

```bash
# Ø¯Ø± Django Shell
from src.core.feature_flags.services import is_feature_active

# Ú†Ú© Ú©Ø±Ø¯Ù†
print(is_feature_active('portfolio'))  # True or False

# ØªØºÛŒÛŒØ± Ø¯Ø§Ø¯Ù†
from src.core.feature_flags.models import FeatureFlag
flag = FeatureFlag.objects.get(key='portfolio')
flag.is_active = False
flag.save()

# Ú†Ú© Ú©Ø±Ø¯Ù† Ø¯ÙˆØ¨Ø§Ø±Ù‡ (Ø¨Ø§ÛŒØ¯ Ø§Ø² cache Ø¨Ø®ÙˆØ§Ù†Ø¯)
print(is_feature_active('portfolio'))  # False
```

### Frontend

```bash
# Ø¯Ø±ÛŒØ§ÙØª feature flags
curl http://localhost:8000/api/core/feature-flags/

# Toggle Ú©Ø±Ø¯Ù† (Ù†ÛŒØ§Ø² Ø¨Ù‡ authentication)
curl -X PATCH http://localhost:8000/api/core/feature-flags/admin/portfolio/toggle/ \
  -H "Cookie: sessionid=..." \
  -H "Content-Type: application/json"
```

---

## ğŸ› Troubleshooting

### Ù…Ø´Ú©Ù„: ØªØºÛŒÛŒØ±Ø§Øª Ø§Ø¹Ù…Ø§Ù„ Ù†Ù…ÛŒâ€ŒØ´ÙˆØ¯

**Ø±Ø§Ù‡â€ŒØ­Ù„:**
```python
# Cache Ø±Ø§ manually Ù¾Ø§Ú© Ú©Ù†ÛŒØ¯
from src.core.feature_flags.services import invalidate_feature_flag_cache
invalidate_feature_flag_cache('portfolio')
```

### Ù…Ø´Ú©Ù„: 404 Ø¨Ø±Ø§ÛŒ URL Ù‡Ø§ÛŒ ÙØ¹Ø§Ù„

**Ø¨Ø±Ø±Ø³ÛŒ:**
1. Feature flag Ø¯Ø± database ÙˆØ¬ÙˆØ¯ Ø¯Ø§Ø±Ø¯ØŸ
2. Cache ØµØ­ÛŒØ­ Ø§Ø³ØªØŸ
3. Middleware Ø¯Ø±Ø³Øª Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯Ù‡ØŸ

```python
# Ú†Ú© Ú©Ø±Ø¯Ù† ÙˆØ¶Ø¹ÛŒØª
from django.core.cache import cache
print(cache.get('feature_flag:portfolio'))
```

### Ù…Ø´Ú©Ù„: Frontend component Ú©Ø§Ø± Ù†Ù…ÛŒâ€ŒÚ©Ù†Ø¯

**Ø¨Ø±Ø±Ø³ÛŒ:**
1. CORS ØªÙ†Ø¸ÛŒÙ… Ø´Ø¯Ù‡ØŸ
2. Authentication Ø¯Ø±Ø³Øª Ø§Ø³ØªØŸ
3. API endpoint ØµØ­ÛŒØ­ Ø§Ø³ØªØŸ

---

## ğŸ” Security Notes

1. **Permission Check**: ÙÙ‚Ø· Ø§Ø¯Ù…ÛŒÙ†â€ŒÙ‡Ø§ Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ù†Ø¯ feature flags Ø±Ø§ ØªØºÛŒÛŒØ± Ø¯Ù‡Ù†Ø¯
2. **CSRF Protection**: Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² CSRFExemptSessionAuthentication
3. **404 Instead of 403**: Ø¨Ø±Ø§ÛŒ Ø§Ù…Ù†ÛŒØª Ø¨ÛŒØ´ØªØ± Ø§Ø² 404 Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯
4. **Audit Log**: ØªØºÛŒÛŒØ±Ø§Øª Ø±Ø§ log Ú©Ù†ÛŒØ¯ (Ø¯Ø± production)

---

## ğŸ“ˆ Best Practices

1. **Cache TTL Ø±Ø§ Ú©ÙˆØªØ§Ù‡ Ù†Ú¯Ù‡ Ø¯Ø§Ø±ÛŒØ¯** (5-10 Ø¯Ù‚ÛŒÙ‚Ù‡)
2. **Feature flags Ø±Ø§ document Ú©Ù†ÛŒØ¯** (description field)
3. **Ø§Ø² bulk operations Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯** (Ø¨Ø±Ø§ÛŒ Ú†Ù†Ø¯ ØªØºÛŒÛŒØ± Ù‡Ù…Ø²Ù…Ø§Ù†)
4. **Monitoring Ø§Ø¶Ø§ÙÙ‡ Ú©Ù†ÛŒØ¯** (ØªØ¹Ø¯Ø§Ø¯ requests, cache hits)
5. **Feature flags Ù‚Ø¯ÛŒÙ…ÛŒ Ø±Ø§ cleanup Ú©Ù†ÛŒØ¯** (Ø¨Ø¹Ø¯ Ø§Ø² release)

---

## ğŸ“ Ù…Ø«Ø§Ù„ Ú©Ø§Ù…Ù„

### Scenario: ØºÛŒØ±ÙØ¹Ø§Ù„ Ú©Ø±Ø¯Ù† Portfolio

1. **Ø¯Ø± Ù¾Ù†Ù„ Ø§Ø¯Ù…ÛŒÙ†:**
   - Ø±ÙˆÛŒ toggle Portfolio Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯
   - ÙˆØ¶Ø¹ÛŒØª Ø¨Ù‡ "ØºÛŒØ±ÙØ¹Ø§Ù„" ØªØºÛŒÛŒØ± Ù…ÛŒâ€ŒÚ©Ù†Ø¯

2. **Backend:**
   - Middleware request Ø¨Ù‡ `/api/portfolio/*` Ø±Ø§ Ø¯Ø±ÛŒØ§ÙØª Ù…ÛŒâ€ŒÚ©Ù†Ø¯
   - Ø§Ø² cache Ù…ÛŒâ€ŒØ®ÙˆØ§Ù†Ø¯ Ú©Ù‡ portfolio ØºÛŒØ±ÙØ¹Ø§Ù„ Ø§Ø³Øª
   - 404 Ø¨Ø±Ù…ÛŒâ€ŒÚ¯Ø±Ø¯Ø§Ù†Ø¯

3. **Frontend:**
   - Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ø¨Ù‡ `/portfolios` 404 Ù…ÛŒâ€ŒÚ¯ÛŒØ±Ø¯
   - Component error boundary Ø±Ø§ trigger Ù…ÛŒâ€ŒÚ©Ù†Ø¯
   - Ù¾ÛŒØ§Ù… "Ø§ÛŒÙ† Ø¨Ø®Ø´ Ø¯Ø± Ø¯Ø³ØªØ±Ø³ Ù†ÛŒØ³Øª" Ù†Ù…Ø§ÛŒØ´ Ù…ÛŒâ€ŒØ¯Ù‡Ø¯

4. **ÙØ¹Ø§Ù„ Ú©Ø±Ø¯Ù† Ø¯ÙˆØ¨Ø§Ø±Ù‡:**
   - toggle Ø±Ø§ Ø¯ÙˆØ¨Ø§Ø±Ù‡ Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯
   - Cache invalidate Ù…ÛŒâ€ŒØ´ÙˆØ¯
   - ÙÙˆØ±Ø§Ù‹ Ú©Ø§Ø± Ù…ÛŒâ€ŒÚ©Ù†Ø¯ (Ø¨Ø¯ÙˆÙ† restart!)

---

## âœ… Checklist Ù¾ÛŒØ§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ

- [ ] Middleware Ø§ÛŒØ¬Ø§Ø¯ Ø´Ø¯
- [ ] URLs Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø´Ø¯ (Ø¨Ø¯ÙˆÙ† feature_urls)
- [ ] Settings Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø´Ø¯ (middleware Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯)
- [ ] Services Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø´Ø¯
- [ ] Component frontend Ø§ÛŒØ¬Ø§Ø¯ Ø´Ø¯
- [ ] Feature flags Ø¯Ø± database Ø§ÛŒØ¬Ø§Ø¯ Ø´Ø¯Ù†Ø¯
- [ ] ØªØ³Øª Ø´Ø¯ (backend + frontend)
- [ ] Ø¯Ø± production deploy Ø´Ø¯
- [ ] Monitoring Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ Ø´Ø¯
- [ ] Documentation Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø´Ø¯

---

## ğŸ‰ Ù†ØªÛŒØ¬Ù‡â€ŒÚ¯ÛŒØ±ÛŒ

Ø¨Ø§ Ø§ÛŒÙ† Ø±Ø§Ù‡â€ŒØ­Ù„:
- âœ… **Ø³Ø±Ø¹Øª Ø¨Ø§Ù„Ø§** (Redis Cache)
- âœ… **Ø¨Ø¯ÙˆÙ† Restart** (Middleware)
- âœ… **UI Ø²ÛŒØ¨Ø§** (Modern React)
- âœ… **Real-time** (Auto refresh)
- âœ… **Scalable** (Distributed cache)
- âœ… **Secure** (Permission based)

Ø§ÛŒÙ† Ø¨Ù‡ØªØ±ÛŒÙ† practice Ø¯Ø± Ø³Ø§Ù„ 2025 Ø¨Ø±Ø§ÛŒ Ù…Ø¯ÛŒØ±ÛŒØª Feature Flags Ø§Ø³Øª! ğŸš€

# Backend/src/core/feature_flags/tests.py
"""
ØªØ³Øªâ€ŒÙ‡Ø§ÛŒ Ø¬Ø§Ù…Ø¹ Ø¨Ø±Ø§ÛŒ Feature Flags System

Ø¨Ø±Ø§ÛŒ Ø§Ø¬Ø±Ø§:
    python manage.py test src.core.feature_flags
"""

from django.test import TestCase, RequestFactory, override_settings
from django.core.cache import cache
from django.contrib.auth import get_user_model
from rest_framework.test import APITestCase, APIClient
from rest_framework import status

from .models import FeatureFlag
from .services import (
    is_feature_active,
    invalidate_feature_flag_cache,
    get_all_feature_flags,
    bulk_update_feature_flags
)
from .middleware import FeatureFlagMiddleware

User = get_user_model()


class FeatureFlagModelTests(TestCase):
    """ØªØ³Øªâ€ŒÙ‡Ø§ÛŒ Ù…Ø¯Ù„ FeatureFlag"""

    def setUp(self):
        cache.clear()

    def test_create_feature_flag(self):
        """ØªØ³Øª Ø§ÛŒØ¬Ø§Ø¯ feature flag"""
        flag = FeatureFlag.objects.create(
            key='test_feature',
            is_active=True,
            description='Test feature flag'
        )
        
        self.assertEqual(flag.key, 'test_feature')
        self.assertTrue(flag.is_active)
        self.assertEqual(flag.description, 'Test feature flag')

    def test_unique_key_constraint(self):
        """ØªØ³Øª ÛŒÚ©ØªØ§ Ø¨ÙˆØ¯Ù† key"""
        FeatureFlag.objects.create(key='test_feature', is_active=True)
        
        with self.assertRaises(Exception):
            FeatureFlag.objects.create(key='test_feature', is_active=False)

    def test_auto_cache_invalidation_on_save(self):
        """ØªØ³Øª invalidate Ø®ÙˆØ¯Ú©Ø§Ø± cache Ù‡Ù†Ú¯Ø§Ù… Ø°Ø®ÛŒØ±Ù‡"""
        flag = FeatureFlag.objects.create(key='test_feature', is_active=True)
        
        # Cache Ø±Ø§ populate Ú©Ù†
        is_feature_active('test_feature')
        self.assertIsNotNone(cache.get('feature_flag:test_feature'))
        
        # ØªØºÛŒÛŒØ± flag
        flag.is_active = False
        flag.save()
        
        # Cache Ø¨Ø§ÛŒØ¯ Ù¾Ø§Ú© Ø´Ø¯Ù‡ Ø¨Ø§Ø´Ø¯
        self.assertIsNone(cache.get('feature_flag:test_feature'))


class FeatureFlagServicesTests(TestCase):
    """ØªØ³Øªâ€ŒÙ‡Ø§ÛŒ services"""

    def setUp(self):
        cache.clear()
        FeatureFlag.objects.create(key='active_feature', is_active=True)
        FeatureFlag.objects.create(key='inactive_feature', is_active=False)

    def tearDown(self):
        cache.clear()

    def test_is_feature_active_true(self):
        """ØªØ³Øª Ú†Ú© Ú©Ø±Ø¯Ù† feature ÙØ¹Ø§Ù„"""
        self.assertTrue(is_feature_active('active_feature'))

    def test_is_feature_active_false(self):
        """ØªØ³Øª Ú†Ú© Ú©Ø±Ø¯Ù† feature ØºÛŒØ±ÙØ¹Ø§Ù„"""
        self.assertFalse(is_feature_active('inactive_feature'))

    def test_is_feature_active_nonexistent(self):
        """ØªØ³Øª Ú†Ú© Ú©Ø±Ø¯Ù† feature Ù…ÙˆØ¬ÙˆØ¯ Ù†ÛŒØ³Øª (Ø¨Ø§ÛŒØ¯ True Ø¨Ø§Ø´Ø¯)"""
        # Ø¨Ø±Ø§ÛŒ backward compatibility
        self.assertTrue(is_feature_active('nonexistent_feature'))

    def test_cache_usage(self):
        """ØªØ³Øª Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² cache"""
        # Ø§ÙˆÙ„ÛŒÙ† call - Ø§Ø² DB
        with self.assertNumQueries(1):
            is_feature_active('active_feature')
        
        # Ø¯ÙˆÙ…ÛŒÙ† call - Ø§Ø² cache
        with self.assertNumQueries(0):
            is_feature_active('active_feature')

    def test_invalidate_single_flag(self):
        """ØªØ³Øª invalidate ÛŒÚ© flag Ø®Ø§Øµ"""
        # Populate cache
        is_feature_active('active_feature')
        self.assertIsNotNone(cache.get('feature_flag:active_feature'))
        
        # Invalidate
        invalidate_feature_flag_cache('active_feature')
        self.assertIsNone(cache.get('feature_flag:active_feature'))

    def test_invalidate_all_flags(self):
        """ØªØ³Øª invalidate ØªÙ…Ø§Ù… flags"""
        # Populate cache
        is_feature_active('active_feature')
        is_feature_active('inactive_feature')
        
        # Invalidate all
        invalidate_feature_flag_cache()
        
        self.assertIsNone(cache.get('feature_flag:active_feature'))
        self.assertIsNone(cache.get('feature_flag:inactive_feature'))

    def test_get_all_feature_flags(self):
        """ØªØ³Øª Ø¯Ø±ÛŒØ§ÙØª ØªÙ…Ø§Ù… flags"""
        flags = get_all_feature_flags()
        
        self.assertEqual(len(flags), 2)
        self.assertTrue(flags['active_feature'])
        self.assertFalse(flags['inactive_feature'])

    def test_bulk_update(self):
        """ØªØ³Øª Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ bulk"""
        updates = {
            'active_feature': False,
            'inactive_feature': True
        }
        
        result = bulk_update_feature_flags(updates)
        
        self.assertEqual(len(result['updated']), 2)
        self.assertEqual(len(result['failed']), 0)
        
        # Ø¨Ø±Ø±Ø³ÛŒ ØªØºÛŒÛŒØ±Ø§Øª
        self.assertFalse(is_feature_active('active_feature'))
        self.assertTrue(is_feature_active('inactive_feature'))


class FeatureFlagMiddlewareTests(TestCase):
    """ØªØ³Øªâ€ŒÙ‡Ø§ÛŒ middleware"""

    def setUp(self):
        cache.clear()
        self.factory = RequestFactory()
        self.middleware = FeatureFlagMiddleware(lambda r: None)
        
        FeatureFlag.objects.create(key='portfolio', is_active=True)
        FeatureFlag.objects.create(key='blog', is_active=False)

    def test_middleware_allows_active_feature(self):
        """ØªØ³Øª Ø§Ø¬Ø§Ø²Ù‡ Ø¯Ø³ØªØ±Ø³ÛŒ Ø¨Ù‡ feature ÙØ¹Ø§Ù„"""
        request = self.factory.get('/api/portfolio/list/')
        response = self.middleware(request)
        
        self.assertIsNone(response)  # Ù…ÛŒØ°Ø§Ø±Ù‡ Ø¨Ø±Ù‡ Ø¨Ù‡ view

    def test_middleware_blocks_inactive_feature(self):
        """ØªØ³Øª Ù…Ø³Ø¯ÙˆØ¯ Ú©Ø±Ø¯Ù† feature ØºÛŒØ±ÙØ¹Ø§Ù„"""
        request = self.factory.get('/api/blog/list/')
        response = self.middleware(request)
        
        self.assertIsNotNone(response)
        self.assertEqual(response.status_code, 404)

    def test_middleware_allows_exempt_paths(self):
        """ØªØ³Øª Ø§Ø¬Ø§Ø²Ù‡ Ø¯Ø³ØªØ±Ø³ÛŒ Ø¨Ù‡ path Ù‡Ø§ÛŒ exempt"""
        exempt_paths = [
            '/api/core/health/',
            '/api/auth/login/',
            '/api/user/profile/',
            '/admin/',
        ]
        
        for path in exempt_paths:
            request = self.factory.get(path)
            response = self.middleware(request)
            self.assertIsNone(response, f"Path {path} should be exempt")

    def test_middleware_caches_result(self):
        """ØªØ³Øª cache Ú©Ø±Ø¯Ù† Ù†ØªÛŒØ¬Ù‡ Ø¯Ø± middleware"""
        request = self.factory.get('/api/portfolio/list/')
        
        # Ø§ÙˆÙ„ÛŒÙ† request
        with self.assertNumQueries(1):
            self.middleware(request)
        
        # Ø¯ÙˆÙ…ÛŒÙ† request - Ø¨Ø§ÛŒØ¯ Ø§Ø² cache Ø¨Ø®ÙˆÙ†Ù‡
        with self.assertNumQueries(0):
            self.middleware(request)


class FeatureFlagAPITests(APITestCase):
    """ØªØ³Øªâ€ŒÙ‡Ø§ÛŒ API endpoints"""

    def setUp(self):
        cache.clear()
        self.client = APIClient()
        
        # Ø§ÛŒØ¬Ø§Ø¯ admin user
        self.admin = User.objects.create_superuser(
            username='admin',
            email='admin@test.com',
            password='admin123'
        )
        
        # Ø§ÛŒØ¬Ø§Ø¯ feature flags
        self.portfolio_flag = FeatureFlag.objects.create(
            key='portfolio',
            is_active=True,
            description='Portfolio management'
        )
        self.blog_flag = FeatureFlag.objects.create(
            key='blog',
            is_active=False,
            description='Blog management'
        )

    def test_public_list_endpoint(self):
        """ØªØ³Øª public endpoint Ø¨Ø±Ø§ÛŒ Ù„ÛŒØ³Øª flags"""
        url = '/api/core/feature-flags/'
        response = self.client.get(url)
        
        self.assertEqual(response.status_code, status.HTTP_200_OK)
        self.assertIn('portfolio', response.data)
        self.assertIn('blog', response.data)

    def test_admin_list_requires_auth(self):
        """ØªØ³Øª Ù†ÛŒØ§Ø² Ø¨Ù‡ authentication Ø¨Ø±Ø§ÛŒ admin list"""
        url = '/api/core/feature-flags/admin/'
        response = self.client.get(url)
        
        self.assertEqual(response.status_code, status.HTTP_403_FORBIDDEN)

    def test_admin_list_with_auth(self):
        """ØªØ³Øª admin list Ø¨Ø§ authentication"""
        self.client.force_authenticate(user=self.admin)
        url = '/api/core/feature-flags/admin/'
        response = self.client.get(url)
        
        self.assertEqual(response.status_code, status.HTTP_200_OK)

    def test_toggle_endpoint(self):
        """ØªØ³Øª toggle endpoint"""
        self.client.force_authenticate(user=self.admin)
        url = '/api/core/feature-flags/admin/portfolio/toggle/'
        
        # Ø§ÙˆÙ„ÛŒÙ† toggle
        response = self.client.patch(url)
        self.assertEqual(response.status_code, status.HTTP_200_OK)
        
        # Ø¨Ø±Ø±Ø³ÛŒ ØªØºÛŒÛŒØ±
        self.portfolio_flag.refresh_from_db()
        self.assertFalse(self.portfolio_flag.is_active)
        
        # Ø¯ÙˆÙ…ÛŒÙ† toggle
        response = self.client.patch(url)
        self.assertEqual(response.status_code, status.HTTP_200_OK)
        
        self.portfolio_flag.refresh_from_db()
        self.assertTrue(self.portfolio_flag.is_active)

    def test_create_feature_flag(self):
        """ØªØ³Øª Ø§ÛŒØ¬Ø§Ø¯ feature flag Ø§Ø² API"""
        self.client.force_authenticate(user=self.admin)
        url = '/api/core/feature-flags/admin/'
        
        data = {
            'key': 'new_feature',
            'is_active': True,
            'description': 'New feature description'
        }
        
        response = self.client.post(url, data)
        self.assertEqual(response.status_code, status.HTTP_201_CREATED)
        
        # Ø¨Ø±Ø±Ø³ÛŒ Ø§ÛŒØ¬Ø§Ø¯ Ø¯Ø± DB
        self.assertTrue(
            FeatureFlag.objects.filter(key='new_feature').exists()
        )

    def test_update_feature_flag(self):
        """ØªØ³Øª Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ feature flag"""
        self.client.force_authenticate(user=self.admin)
        url = f'/api/core/feature-flags/admin/portfolio/'
        
        data = {
            'description': 'Updated description'
        }
        
        response = self.client.patch(url, data)
        self.assertEqual(response.status_code, status.HTTP_200_OK)
        
        self.portfolio_flag.refresh_from_db()
        self.assertEqual(self.portfolio_flag.description, 'Updated description')

    def test_delete_feature_flag(self):
        """ØªØ³Øª Ø­Ø°Ù feature flag"""
        self.client.force_authenticate(user=self.admin)
        url = f'/api/core/feature-flags/admin/blog/'
        
        response = self.client.delete(url)
        self.assertEqual(response.status_code, status.HTTP_200_OK)
        
        # Ø¨Ø±Ø±Ø³ÛŒ Ø­Ø°Ù Ø§Ø² DB
        self.assertFalse(
            FeatureFlag.objects.filter(key='blog').exists()
        )


@override_settings(FEATURE_FLAGS_ENABLED=False)
class FeatureFlagDisabledTests(TestCase):
    """ØªØ³Øªâ€ŒÙ‡Ø§ Ø¨Ø±Ø§ÛŒ ÙˆÙ‚ØªÛŒ Ú©Ù‡ feature flags Ú©Ù„Ø§Ù‹ ØºÛŒØ±ÙØ¹Ø§Ù„ Ù‡Ø³ØªÙ†Ø¯"""

    def setUp(self):
        cache.clear()
        FeatureFlag.objects.create(key='test_feature', is_active=False)

    def test_all_features_active_when_disabled(self):
        """ÙˆÙ‚ØªÛŒ FEATURE_FLAGS_ENABLED=FalseØŒ Ù‡Ù…Ù‡ features Ø¨Ø§ÛŒØ¯ ÙØ¹Ø§Ù„ Ø¨Ø§Ø´Ù†Ø¯"""
        # Ø­ØªÛŒ Ø§Ú¯Ø± Ø¯Ø± DB ØºÛŒØ±ÙØ¹Ø§Ù„ Ø¨Ø§Ø´Ø¯
        self.assertTrue(is_feature_active('test_feature'))
        self.assertTrue(is_feature_active('nonexistent_feature'))


# ==============================================================================
# Performance Tests
# ==============================================================================

class FeatureFlagPerformanceTests(TestCase):
    """ØªØ³Øªâ€ŒÙ‡Ø§ÛŒ performance"""

    def setUp(self):
        cache.clear()
        FeatureFlag.objects.create(key='test_feature', is_active=True)

    def test_cache_hit_performance(self):
        """ØªØ³Øª performance cache hit"""
        import time
        
        # Ø§ÙˆÙ„ÛŒÙ† call - Ø§Ø² DB
        start = time.time()
        is_feature_active('test_feature')
        db_time = time.time() - start
        
        # Ø¯ÙˆÙ…ÛŒÙ† call - Ø§Ø² cache
        start = time.time()
        is_feature_active('test_feature')
        cache_time = time.time() - start
        
        # Cache Ø¨Ø§ÛŒØ¯ Ø³Ø±ÛŒØ¹â€ŒØªØ± Ø¨Ø§Ø´Ø¯
        self.assertLess(cache_time, db_time)

    def test_middleware_performance(self):
        """ØªØ³Øª performance middleware"""
        factory = RequestFactory()
        middleware = FeatureFlagMiddleware(lambda r: None)
        request = factory.get('/api/portfolio/list/')
        
        import time
        
        # Ø§ÙˆÙ„ÛŒÙ† request
        start = time.time()
        middleware(request)
        first_time = time.time() - start
        
        # Ø¯ÙˆÙ…ÛŒÙ† request (Ø§Ø² cache)
        start = time.time()
        middleware(request)
        second_time = time.time() - start
        
        # Ø¯ÙˆÙ…ÛŒÙ† request Ø¨Ø§ÛŒØ¯ Ø³Ø±ÛŒØ¹â€ŒØªØ± Ø¨Ø§Ø´Ø¯
        self.assertLess(second_time, first_time)


# ==============================================================================
# Ø§Ø¬Ø±Ø§ÛŒ ØªØ³Øªâ€ŒÙ‡Ø§:
# ==============================================================================
#
# ØªÙ…Ø§Ù… ØªØ³Øªâ€ŒÙ‡Ø§:
#   python manage.py test src.core.feature_flags
#
# ÛŒÚ© test case Ø®Ø§Øµ:
#   python manage.py test src.core.feature_flags.tests.FeatureFlagModelTests
#
# ÛŒÚ© test method Ø®Ø§Øµ:
#   python manage.py test src.core.feature_flags.tests.FeatureFlagModelTests.test_create_feature_flag
#
# Ø¨Ø§ coverage:
#   coverage run --source='.' manage.py test src.core.feature_flags
#   coverage report
#   coverage html
#
# ==============================================================================
// hooks/useFeatureFlags.ts
// Custom Hook Ø¨Ø±Ø§ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø±Ø§Ø­Øª Ø§Ø² Feature Flags Ø¯Ø± Next.js

import { useState, useEffect, useCallback } from 'react';

interface FeatureFlags {
  [key: string]: boolean;
}

interface UseFeatureFlagsReturn {
  flags: FeatureFlags;
  loading: boolean;
  error: string | null;
  refresh: () => Promise<void>;
  isFeatureActive: (key: string) => boolean;
}

const API_BASE = process.env.NEXT_PUBLIC_API_URL || 'http://localhost:8000';
const CACHE_KEY = 'feature_flags_cache';
const CACHE_DURATION = 5 * 60 * 1000; // 5 minutes

/**
 * Custom Hook Ø¨Ø±Ø§ÛŒ Ù…Ø¯ÛŒØ±ÛŒØª Feature Flags
 * 
 * Features:
 * - Auto-refresh Ù‡Ø± 30 Ø«Ø§Ù†ÛŒÙ‡
 * - Local caching (5 Ø¯Ù‚ÛŒÙ‚Ù‡)
 * - Error handling
 * - TypeScript support
 * 
 * @example
 * ```tsx
 * const { flags, loading, isFeatureActive } = useFeatureFlags();
 * 
 * if (loading) return <Spinner />;
 * 
 * return (
 *   <>
 *     {isFeatureActive('portfolio') && <PortfolioSection />}
 *     {isFeatureActive('blog') && <BlogSection />}
 *   </>
 * );
 * ```
 */
export function useFeatureFlags(autoRefresh = true): UseFeatureFlagsReturn {
  const [flags, setFlags] = useState<FeatureFlags>({});
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState<string | null>(null);

  // ØªØ§Ø¨Ø¹ Ø¨Ø±Ø§ÛŒ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ feature flags
  const fetchFlags = useCallback(async () => {
    try {
      setError(null);

      // Ú†Ú© Ú©Ø±Ø¯Ù† cache Ù…Ø­Ù„ÛŒ
      const cached = getFromCache();
      if (cached) {
        setFlags(cached);
        setLoading(false);
        return;
      }

      // Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ø¨Ù‡ API
      const response = await fetch(`${API_BASE}/api/core/feature-flags/`, {
        credentials: 'include',
        headers: {
          'Content-Type': 'application/json',
        },
      });

      if (!response.ok) {
        throw new Error('Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª feature flags');
      }

      const data = await response.json();
      
      // Ø°Ø®ÛŒØ±Ù‡ Ø¯Ø± state
      setFlags(data);
      
      // Ø°Ø®ÛŒØ±Ù‡ Ø¯Ø± cache
      saveToCache(data);
      
    } catch (err) {
      setError(err instanceof Error ? err.message : 'Ø®Ø·Ø§ÛŒ Ù†Ø§Ø´Ù†Ø§Ø®ØªÙ‡');
      console.error('Feature Flags Error:', err);
    } finally {
      setLoading(false);
    }
  }, []);

  // ØªØ§Ø¨Ø¹ Ø¨Ø±Ø§ÛŒ refresh Ø¯Ø³ØªÛŒ
  const refresh = useCallback(async () => {
    clearCache();
    await fetchFlags();
  }, [fetchFlags]);

  // ØªØ§Ø¨Ø¹ Ø¨Ø±Ø§ÛŒ Ú†Ú© Ú©Ø±Ø¯Ù† ÛŒÚ© feature
  const isFeatureActive = useCallback(
    (key: string): boolean => {
      return flags[key] === true;
    },
    [flags]
  );

  // Effect Ø¨Ø±Ø§ÛŒ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø§ÙˆÙ„ÛŒÙ‡ Ùˆ auto-refresh
  useEffect(() => {
    fetchFlags();

    if (autoRefresh) {
      const interval = setInterval(() => {
        fetchFlags();
      }, 30000); // Ù‡Ø± 30 Ø«Ø§Ù†ÛŒÙ‡

      return () => clearInterval(interval);
    }
  }, [fetchFlags, autoRefresh]);

  return {
    flags,
    loading,
    error,
    refresh,
    isFeatureActive,
  };
}

// ==============================================================================
// Cache Utilities
// ==============================================================================

interface CacheData {
  flags: FeatureFlags;
  timestamp: number;
}

function getFromCache(): FeatureFlags | null {
  if (typeof window === 'undefined') return null;

  try {
    const cached = localStorage.getItem(CACHE_KEY);
    if (!cached) return null;

    const data: CacheData = JSON.parse(cached);
    
    // Ú†Ú© Ú©Ø±Ø¯Ù† Ø§Ù†Ù‚Ø¶Ø§
    const now = Date.now();
    if (now - data.timestamp > CACHE_DURATION) {
      clearCache();
      return null;
    }

    return data.flags;
  } catch (err) {
    console.error('Cache read error:', err);
    return null;
  }
}

function saveToCache(flags: FeatureFlags): void {
  if (typeof window === 'undefined') return;

  try {
    const data: CacheData = {
      flags,
      timestamp: Date.now(),
    };
    localStorage.setItem(CACHE_KEY, JSON.stringify(data));
  } catch (err) {
    console.error('Cache write error:', err);
  }
}

function clearCache(): void {
  if (typeof window === 'undefined') return;
  localStorage.removeItem(CACHE_KEY);
}

// ==============================================================================
// Higher Order Component (HOC)
// ==============================================================================

/**
 * HOC Ø¨Ø±Ø§ÛŒ Ù…Ø­Ø§ÙØ¸Øª Ø§Ø² component Ø¨Ø§ feature flag
 * 
 * @example
 * ```tsx
 * const PortfolioPage = () => <div>Portfolio Content</div>;
 * export default withFeatureFlag('portfolio')(PortfolioPage);
 * ```
 */
export function withFeatureFlag(featureKey: string) {
  return function <P extends object>(
    Component: React.ComponentType<P>
  ): React.FC<P> {
    return function FeatureFlagWrapper(props: P) {
      const { isFeatureActive, loading } = useFeatureFlags();

      if (loading) {
        return (
          <div className="flex items-center justify-center h-screen">
            <div className="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500" />
          </div>
        );
      }

      if (!isFeatureActive(featureKey)) {
        return (
          <div className="flex flex-col items-center justify-center h-screen">
            <h1 className="text-2xl font-bold text-gray-900 mb-2">
              Ø§ÛŒÙ† Ø¨Ø®Ø´ Ø¯Ø± Ø¯Ø³ØªØ±Ø³ Ù†ÛŒØ³Øª
            </h1>
            <p className="text-gray-600">
              Ø§ÛŒÙ† ÙˆÛŒÚ˜Ú¯ÛŒ Ø¯Ø± Ø­Ø§Ù„ Ø­Ø§Ø¶Ø± ØºÛŒØ±ÙØ¹Ø§Ù„ Ø§Ø³Øª.
            </p>
          </div>
        );
      }

      return <Component {...props} />;
    };
  };
}

// ==============================================================================
// Helper Functions
// ==============================================================================

/**
 * ØªØ§Ø¨Ø¹ Ø¨Ø±Ø§ÛŒ Ø¯Ø±ÛŒØ§ÙØª Ø³Ø±ÛŒØ¹ ÙˆØ¶Ø¹ÛŒØª ÛŒÚ© feature (Ø¨Ø¯ÙˆÙ† hook)
 * 
 * @example
 * ```tsx
 * // Ø¯Ø± server component ÛŒØ§ server action
 * const isPortfolioActive = await checkFeatureFlag('portfolio');
 * ```
 */
export async function checkFeatureFlag(key: string): Promise<boolean> {
  try {
    const response = await fetch(
      `${API_BASE}/api/core/feature-flags/detail/${key}/`,
      {
        credentials: 'include',
        cache: 'no-store', // Ø¨Ø±Ø§ÛŒ Next.js
      }
    );

    if (!response.ok) return false;

    const data = await response.json();
    return data.is_active === true;
  } catch (err) {
    console.error(`Error checking feature flag "${key}":`, err);
    return false;
  }
}

// ==============================================================================
// Type Guards
// ==============================================================================

/**
 * Type guard Ø¨Ø±Ø§ÛŒ Ú†Ú© Ú©Ø±Ø¯Ù† ÙˆØ¬ÙˆØ¯ feature Ø¯Ø± flags object
 */
export function hasFeature(
  flags: FeatureFlags,
  key: string
): key is keyof FeatureFlags {
  return key in flags;
}

// ==============================================================================
// Ù…Ø«Ø§Ù„â€ŒÙ‡Ø§ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡:
// ==============================================================================
//
// 1. Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø³Ø§Ø¯Ù‡:
//    ```tsx
//    const { isFeatureActive, loading } = useFeatureFlags();
//    if (loading) return <Spinner />;
//    return isFeatureActive('portfolio') ? <Portfolio /> : <ComingSoon />;
//    ```
//
// 2. Ø¨Ø§ HOC:
//    ```tsx
//    const Portfolio = () => <div>Portfolio Content</div>;
//    export default withFeatureFlag('portfolio')(Portfolio);
//    ```
//
// 3. Ø¯Ø± server component:
//    ```tsx
//    const isActive = await checkFeatureFlag('blog');
//    if (!isActive) return <ComingSoon />;
//    ```
//
// 4. Multiple flags:
//    ```tsx
//    const { flags } = useFeatureFlags();
//    const activeModules = Object.entries(flags)
//      .filter(([_, active]) => active)
//      .map(([key, _]) => key);
//    ```
//
// 5. Manual refresh:
//    ```tsx
//    const { refresh } = useFeatureFlags();
//    <button onClick={refresh}>Refresh Flags</button>
//    ```
//
// ==============================================================================# Backend/src/core/feature_flags/management/commands/feature_flags.py
"""
Management command Ø¨Ø±Ø§ÛŒ Ù…Ø¯ÛŒØ±ÛŒØª Feature Flags Ø§Ø² command line

Ø§Ø³ØªÙØ§Ø¯Ù‡:
    python manage.py feature_flags list
    python manage.py feature_flags enable portfolio
    python manage.py feature_flags disable blog
    python manage.py feature_flags status portfolio
    python manage.py feature_flags clear-cache
"""

from django.core.management.base import BaseCommand, CommandError
from src.core.feature_flags.models import FeatureFlag
from src.core.feature_flags.services import (
    is_feature_active,
    invalidate_feature_flag_cache,
    get_all_feature_flags
)
from django.core.cache import cache


class Command(BaseCommand):
    help = 'Ù…Ø¯ÛŒØ±ÛŒØª Feature Flags Ø§Ø² command line'

    def add_arguments(self, parser):
        parser.add_argument(
            'action',
            type=str,
            help='Action to perform: list, enable, disable, status, clear-cache',
        )
        parser.add_argument(
            'key',
            type=str,
            nargs='?',
            help='Feature flag key (required for enable, disable, status)',
        )

    def handle(self, *args, **options):
        action = options['action']
        key = options.get('key')

        if action == 'list':
            self.list_flags()
        elif action == 'enable':
            if not key:
                raise CommandError('Key is required for enable action')
            self.enable_flag(key)
        elif action == 'disable':
            if not key:
                raise CommandError('Key is required for disable action')
            self.disable_flag(key)
        elif action == 'status':
            if not key:
                raise CommandError('Key is required for status action')
            self.show_status(key)
        elif action == 'clear-cache':
            self.clear_cache(key)
        else:
            raise CommandError(f'Unknown action: {action}')

    def list_flags(self):
        """Ù„ÛŒØ³Øª ØªÙ…Ø§Ù… feature flags"""
        flags = FeatureFlag.objects.all().order_by('key')
        
        if not flags:
            self.stdout.write(self.style.WARNING('Ù‡ÛŒÚ† feature flag ÛŒØ§ÙØª Ù†Ø´Ø¯'))
            return
        
        self.stdout.write(self.style.SUCCESS('=== Ù„ÛŒØ³Øª Feature Flags ===\n'))
        
        for flag in flags:
            status_icon = 'âœ…' if flag.is_active else 'âŒ'
            status_color = self.style.SUCCESS if flag.is_active else self.style.ERROR
            
            self.stdout.write(
                f'{status_icon} {status_color(flag.key.ljust(20))} '
                f'{"ACTIVE" if flag.is_active else "INACTIVE"}'
            )
            if flag.description:
                self.stdout.write(f'   â””â”€ {flag.description[:60]}...\n')
        
        # Ù†Ù…Ø§ÛŒØ´ cache status
        self.stdout.write(self.style.WARNING('\n=== Cache Status ==='))
        cached_flags = get_all_feature_flags()
        cache_hits = sum(1 for key in flags.values_list('key', flat=True) 
                        if cache.get(f'feature_flag:{key}') is not None)
        self.stdout.write(f'Cache hits: {cache_hits}/{len(flags)}')

    def enable_flag(self, key):
        """ÙØ¹Ø§Ù„ Ú©Ø±Ø¯Ù† ÛŒÚ© feature flag"""
        try:
            flag = FeatureFlag.objects.get(key=key)
            
            if flag.is_active:
                self.stdout.write(
                    self.style.WARNING(f'Feature "{key}" Ù‚Ø¨Ù„Ø§Ù‹ ÙØ¹Ø§Ù„ Ø¨ÙˆØ¯')
                )
                return
            
            flag.is_active = True
            flag.save()
            invalidate_feature_flag_cache(key)
            
            self.stdout.write(
                self.style.SUCCESS(f'âœ… Feature "{key}" Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª ÙØ¹Ø§Ù„ Ø´Ø¯')
            )
            
        except FeatureFlag.DoesNotExist:
            raise CommandError(f'Feature flag "{key}" ÛŒØ§ÙØª Ù†Ø´Ø¯')

    def disable_flag(self, key):
        """ØºÛŒØ±ÙØ¹Ø§Ù„ Ú©Ø±Ø¯Ù† ÛŒÚ© feature flag"""
        try:
            flag = FeatureFlag.objects.get(key=key)
            
            if not flag.is_active:
                self.stdout.write(
                    self.style.WARNING(f'Feature "{key}" Ù‚Ø¨Ù„Ø§Ù‹ ØºÛŒØ±ÙØ¹Ø§Ù„ Ø¨ÙˆØ¯')
                )
                return
            
            flag.is_active = False
            flag.save()
            invalidate_feature_flag_cache(key)
            
            self.stdout.write(
                self.style.SUCCESS(f'âŒ Feature "{key}" Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª ØºÛŒØ±ÙØ¹Ø§Ù„ Ø´Ø¯')
            )
            
        except FeatureFlag.DoesNotExist:
            raise CommandError(f'Feature flag "{key}" ÛŒØ§ÙØª Ù†Ø´Ø¯')

    def show_status(self, key):
        """Ù†Ù…Ø§ÛŒØ´ ÙˆØ¶Ø¹ÛŒØª ÛŒÚ© feature flag"""
        try:
            # Ø§Ø² database
            flag = FeatureFlag.objects.get(key=key)
            db_status = flag.is_active
            
            # Ø§Ø² cache
            cache_status = is_feature_active(key)
            
            # Ø§Ø² cache Ø³Ø·Ø­ Ù¾Ø§ÛŒÛŒÙ†
            cache_key = f'feature_flag:{key}'
            raw_cache = cache.get(cache_key)
            
            self.stdout.write(self.style.SUCCESS(f'\n=== Status for "{key}" ==='))
            self.stdout.write(f'Database: {"âœ… ACTIVE" if db_status else "âŒ INACTIVE"}')
            self.stdout.write(f'Cache (high-level): {"âœ… ACTIVE" if cache_status else "âŒ INACTIVE"}')
            self.stdout.write(f'Cache (raw): {raw_cache}')
            
            if flag.description:
                self.stdout.write(f'\nDescription: {flag.description}')
            
            # Ø¨Ø±Ø±Ø³ÛŒ Ù‡Ù…Ø®ÙˆØ§Ù†ÛŒ
            if db_status != cache_status:
                self.stdout.write(
                    self.style.WARNING(
                        '\nâš ï¸  Ù‡Ø´Ø¯Ø§Ø±: Database Ùˆ Cache Ù‡Ù…Ø®ÙˆØ§Ù† Ù†ÛŒØ³ØªÙ†Ø¯!'
                    )
                )
                self.stdout.write('Cache Ø±Ø§ Ù¾Ø§Ú© Ú©Ù†ÛŒØ¯: python manage.py feature_flags clear-cache')
            
        except FeatureFlag.DoesNotExist:
            raise CommandError(f'Feature flag "{key}" ÛŒØ§ÙØª Ù†Ø´Ø¯')

    def clear_cache(self, key=None):
        """Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† cache feature flags"""
        if key:
            invalidate_feature_flag_cache(key)
            self.stdout.write(
                self.style.SUCCESS(f'âœ… Cache Ø¨Ø±Ø§ÛŒ "{key}" Ù¾Ø§Ú© Ø´Ø¯')
            )
        else:
            invalidate_feature_flag_cache()
            self.stdout.write(
                self.style.SUCCESS('âœ… ØªÙ…Ø§Ù… cache Ù‡Ø§ÛŒ feature flags Ù¾Ø§Ú© Ø´Ø¯Ù†Ø¯')
            )


# ==============================================================================
# Ù…Ø«Ø§Ù„â€ŒÙ‡Ø§ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡:
# ==============================================================================
#
# 1. Ù„ÛŒØ³Øª ØªÙ…Ø§Ù… feature flags:
#    python manage.py feature_flags list
#
# 2. ÙØ¹Ø§Ù„ Ú©Ø±Ø¯Ù† portfolio:
#    python manage.py feature_flags enable portfolio
#
# 3. ØºÛŒØ±ÙØ¹Ø§Ù„ Ú©Ø±Ø¯Ù† blog:
#    python manage.py feature_flags disable blog
#
# 4. Ø¨Ø±Ø±Ø³ÛŒ ÙˆØ¶Ø¹ÛŒØª ai:
#    python manage.py feature_flags status ai
#
# 5. Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† cache ÛŒÚ© feature:
#    python manage.py feature_flags clear-cache portfolio
#
# 6. Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† ØªÙ…Ø§Ù… cache Ù‡Ø§:
#    python manage.py feature_flags clear-cache
#
# ==============================================================================# Backend/src/core/feature_flags/migrations/0002_populate_feature_flags.py
# Ø§ÛŒÙ† migration feature flags Ø§ÙˆÙ„ÛŒÙ‡ Ø±Ø§ Ø§ÛŒØ¬Ø§Ø¯ Ù…ÛŒâ€ŒÚ©Ù†Ø¯

from django.db import migrations


def populate_feature_flags(apps, schema_editor):
    """Ø§ÛŒØ¬Ø§Ø¯ feature flags Ø§ÙˆÙ„ÛŒÙ‡ Ø¨Ø±Ø§ÛŒ ØªÙ…Ø§Ù… Ø§Ù¾Ù„ÛŒÚ©ÛŒØ´Ù†â€ŒÙ‡Ø§"""
    FeatureFlag = apps.get_model('core_feature_flags', 'FeatureFlag')
    
    # Feature flags Ø§ÙˆÙ„ÛŒÙ‡
    feature_flags = [
        {
            'key': 'portfolio',
            'is_active': True,
            'description': 'Ù…Ø¯ÛŒØ±ÛŒØª Ùˆ Ù†Ù…Ø§ÛŒØ´ Ù†Ù…ÙˆÙ†Ù‡â€ŒÚ©Ø§Ø±Ù‡Ø§. Ø´Ø§Ù…Ù„ CRUD Ù†Ù…ÙˆÙ†Ù‡â€ŒÚ©Ø§Ø±ØŒ Ù…Ø¯ÛŒØ±ÛŒØª ØªØµØ§ÙˆÛŒØ±ØŒ SEO Ùˆ export.'
        },
        {
            'key': 'blog',
            'is_active': True,
            'description': 'Ù…Ø¯ÛŒØ±ÛŒØª Ù…Ù‚Ø§Ù„Ø§Øª Ùˆ Ù¾Ø³Øªâ€ŒÙ‡Ø§ÛŒ Ø¨Ù„Ø§Ú¯. Ø´Ø§Ù…Ù„ Ù†ÙˆØ´ØªÙ†ØŒ ÙˆÛŒØ±Ø§ÛŒØ´ØŒ Ø§Ù†ØªØ´Ø§Ø± Ùˆ Ù…Ø¯ÛŒØ±ÛŒØª Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒâ€ŒÙ‡Ø§.'
        },
        {
            'key': 'ai',
            'is_active': True,
            'description': 'Ø§Ø¨Ø²Ø§Ø±Ù‡Ø§ Ùˆ Ø³Ø±ÙˆÛŒØ³â€ŒÙ‡Ø§ÛŒ Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ. Ø´Ø§Ù…Ù„ Ù…Ø¯Ù„â€ŒÙ‡Ø§ÛŒ AIØŒ provider management Ùˆ integration.'
        },
        {
            'key': 'chatbot',
            'is_active': True,
            'description': 'Ø³ÛŒØ³ØªÙ… Ú†Øªâ€ŒØ¨Ø§Øª Ù‡ÙˆØ´Ù…Ù†Ø¯ Ø¨Ø±Ø§ÛŒ Ù¾Ø§Ø³Ø®Ú¯ÙˆÛŒÛŒ Ø®ÙˆØ¯Ú©Ø§Ø± Ø¨Ù‡ Ø³ÙˆØ§Ù„Ø§Øª Ú©Ø§Ø±Ø¨Ø±Ø§Ù†.'
        },
        {
            'key': 'ticket',
            'is_active': True,
            'description': 'Ø³ÛŒØ³ØªÙ… ØªÛŒÚ©ØªÛŒÙ†Ú¯ Ø¨Ø±Ø§ÛŒ Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ùˆ Ø§Ø±ØªØ¨Ø§Ø· Ø¨Ø§ Ù…Ø´ØªØ±ÛŒØ§Ù†.'
        },
        {
            'key': 'email',
            'is_active': True,
            'description': 'Ù…Ø¯ÛŒØ±ÛŒØª Ø§ÛŒÙ…ÛŒÙ„â€ŒÙ‡Ø§ Ø´Ø§Ù…Ù„ Ø§Ø±Ø³Ø§Ù„ØŒ Ø¯Ø±ÛŒØ§ÙØªØŒ template management Ùˆ automation.'
        },
        {
            'key': 'page',
            'is_active': True,
            'description': 'ØµÙØ­Ø§Øª Ø³ÙØ§Ø±Ø´ÛŒ ÙˆØ¨â€ŒØ³Ø§ÛŒØª Ù…Ø§Ù†Ù†Ø¯ Ø¯Ø±Ø¨Ø§Ø±Ù‡ Ù…Ø§ØŒ ØªÙ…Ø§Ø³ Ø¨Ø§ Ù…Ø§ Ùˆ ØµÙØ­Ø§Øª landing.'
        },
        {
            'key': 'form',
            'is_active': True,
            'description': 'ÙØ±Ù…â€ŒØ³Ø§Ø² Ùˆ Ù…Ø¯ÛŒØ±ÛŒØª ÙØ±Ù…â€ŒÙ‡Ø§ Ø¨Ø±Ø§ÛŒ Ø¬Ù…Ø¹â€ŒØ¢ÙˆØ±ÛŒ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø§Ø² Ú©Ø§Ø±Ø¨Ø±Ø§Ù†.'
        },
    ]
    
    # Ø§ÛŒØ¬Ø§Ø¯ feature flags (ÙÙ‚Ø· Ø§Ú¯Ø± ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´Ù†Ø¯)
    for flag_data in feature_flags:
        FeatureFlag.objects.get_or_create(
            key=flag_data['key'],
            defaults={
                'is_active': flag_data['is_active'],
                'description': flag_data['description']
            }
        )


def reverse_populate_feature_flags(apps, schema_editor):
    """Ø­Ø°Ù feature flags Ø¯Ø± ØµÙˆØ±Øª rollback"""
    FeatureFlag = apps.get_model('core_feature_flags', 'FeatureFlag')
    
    keys_to_delete = [
        'portfolio', 'blog', 'ai', 'chatbot',
        'ticket', 'email', 'page', 'form'
    ]
    
    FeatureFlag.objects.filter(key__in=keys_to_delete).delete()


class Migration(migrations.Migration):

    dependencies = [
        ('core_feature_flags', '0001_initial'),  # ÙØ±Ø¶ Ù…ÛŒâ€ŒÚ©Ù†ÛŒÙ… 0001 Ù…Ø¯Ù„ Ø±Ø§ Ø§ÛŒØ¬Ø§Ø¯ Ú©Ø±Ø¯Ù‡
    ]

    operations = [
        migrations.RunPython(
            populate_feature_flags,
            reverse_populate_feature_flags
        ),
    ]